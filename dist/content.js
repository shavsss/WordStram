(()=>{"use strict";var e,t,n={5387:(e,t,n)=>{n.d(t,{o:()=>_n,y:()=>it});var r=n(8461),i=n(6743),o=n(3424),s=n(1635),a=n(5125);function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const c=l,u=new i.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),d=new o.Vy("@firebase/auth");function h(e,...t){d.logLevel<=o.$b.ERROR&&d.error(`Auth (${r.MF}): ${e}`,...t)}function f(e,...t){throw v(e,...t)}function p(e,...t){return v(e,...t)}function m(e,t,n){const r=Object.assign(Object.assign({},c()),{[t]:n});return new i.FA("auth","Firebase",r).create(t,{appName:e.name})}function g(e){return m(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function v(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return u.create(e,...t)}function y(e,t,...n){if(!e)throw v(t,...n)}function b(e){const t="INTERNAL ASSERTION FAILED: "+e;throw h(t),new Error(t)}function w(e,t){e||b(t)}function S(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function E(){return"http:"===k()||"https:"===k()}function k(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class _{constructor(e,t){this.shortDelay=e,this.longDelay=t,w(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,i.jZ)()||(0,i.lV)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(E()||(0,i.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function x(e,t){w(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class T{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void b("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void b("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void b("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const I={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},C=new _(3e4,6e4);function N(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function A(e,t,n,r,o={}){return D(e,o,(async()=>{let o={},s={};r&&("GET"===t?s=r:o={body:JSON.stringify(r)});const a=(0,i.Am)(Object.assign({key:e.config.apiKey},s)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},o);return(0,i.c1)()||(c.referrerPolicy="no-referrer"),T.fetch()(O(e,e.config.apiHost,n,a),c)}))}async function D(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},I),t);try{const t=new P(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw M(e,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const t=i.ok?o.errorMessage:o.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw M(e,"credential-already-in-use",o);if("EMAIL_EXISTS"===n)throw M(e,"email-already-in-use",o);if("USER_DISABLED"===n)throw M(e,"user-disabled",o);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw m(e,a,s);f(e,a)}}catch(t){if(t instanceof i.g)throw t;f(e,"network-request-failed",{message:String(t)})}}async function R(e,t,n,r,i={}){const o=await A(e,t,n,r,i);return"mfaPendingCredential"in o&&f(e,"multi-factor-auth-required",{_serverResponse:o}),o}function O(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?x(e.config,i):`${e.config.apiScheme}://${i}`}function L(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class P{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(p(this.auth,"network-request-failed"))),C.get())}))}}function M(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=p(e,t,r);return i.customData._tokenResponse=n,i}function F(e){return void 0!==e&&void 0!==e.enterprise}class U{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return L(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function z(e,t){return A(e,"GET","/v2/recaptchaConfig",N(e,t))}async function V(e,t){return A(e,"POST","/v1/accounts:lookup",t)}function j(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function W(e){return 1e3*Number(e)}function $(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return h("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,i.u)(n);return e?JSON.parse(e):(h("Failed to decode base64 JWT payload"),null)}catch(e){return h("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function B(e){const t=$(e);return y(t,"internal-error"),y(void 0!==t.exp,"internal-error"),y(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function q(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof i.g&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class H{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class K{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=j(this.lastLoginAt),this.creationTime=j(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function G(e){var t;const n=e.auth,r=await e.getIdToken(),i=await q(e,V(n,{idToken:r}));y(null==i?void 0:i.users.length,n,"internal-error");const o=i.users[0];e._notifyReloadListener(o);const s=(null===(t=o.providerUserInfo)||void 0===t?void 0:t.length)?Q(o.providerUserInfo):[],a=(l=e.providerData,c=s,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&o.passwordHash||(null==a?void 0:a.length)),h=!!u&&d,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new K(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function Q(e){return e.map((e=>{var{providerId:t}=e,n=(0,s.Tt)(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Y{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){y(e.idToken,"internal-error"),y(void 0!==e.idToken,"internal-error"),y(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):B(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){y(0!==e.length,"internal-error");const t=B(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(y(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:o}=await async function(e,t){const n=await D(e,{},(async()=>{const n=(0,i.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:o}=e.config,s=O(e,r,"/v1/token",`key=${o}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",T.fetch()(s,{method:"POST",headers:a,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(o))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,o=new Y;return n&&(y("string"==typeof n,"internal-error",{appName:e}),o.refreshToken=n),r&&(y("string"==typeof r,"internal-error",{appName:e}),o.accessToken=r),i&&(y("number"==typeof i,"internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Y,this.toJSON())}_performRefresh(){return b("not implemented")}}function J(e,t){y("string"==typeof e||void 0===e,"internal-error",{appName:t})}class X{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=(0,s.Tt)(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new H(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new K(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await q(this,this.stsTokenManager.getToken(this.auth,e));return y(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=(0,i.Ku)(e),r=await n.getIdToken(t),o=$(r);y(o&&o.exp&&o.auth_time&&o.iat,n.auth,"internal-error");const s="object"==typeof o.firebase?o.firebase:void 0,a=null==s?void 0:s.sign_in_provider;return{claims:o,token:r,authTime:j(W(o.auth_time)),issuedAtTime:j(W(o.iat)),expirationTime:j(W(o.exp)),signInProvider:a||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,i.Ku)(e);await G(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(y(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new X(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){y(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await G(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,r.xZ)(this.auth.app))return Promise.reject(g(this.auth));const e=await this.getIdToken();return await q(this,async function(e,t){return A(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,o,s,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(o=t.photoURL)&&void 0!==o?o:void 0,p=null!==(s=t.tenantId)&&void 0!==s?s:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:b,emailVerified:w,isAnonymous:S,providerData:E,stsTokenManager:k}=t;y(b&&k,e,"internal-error");const _=Y.fromJSON(this.name,k);y("string"==typeof b,e,"internal-error"),J(u,e.name),J(d,e.name),y("boolean"==typeof w,e,"internal-error"),y("boolean"==typeof S,e,"internal-error"),J(h,e.name),J(f,e.name),J(p,e.name),J(m,e.name),J(g,e.name),J(v,e.name);const x=new X({uid:b,auth:e,email:d,emailVerified:w,displayName:u,isAnonymous:S,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:_,createdAt:g,lastLoginAt:v});return E&&Array.isArray(E)&&(x.providerData=E.map((e=>Object.assign({},e)))),m&&(x._redirectEventId=m),x}static async _fromIdTokenResponse(e,t,n=!1){const r=new Y;r.updateFromServerResponse(t);const i=new X({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await G(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];y(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Q(r.providerUserInfo):[],o=!(r.email&&r.passwordHash||(null==i?void 0:i.length)),s=new Y;s.updateFromIdToken(n);const a=new X({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:o}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new K(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||(null==i?void 0:i.length))};return Object.assign(a,l),a}}const Z=new Map;function ee(e){w(e instanceof Function,"Expected a class definition");let t=Z.get(e);return t?(w(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Z.set(e,t),t)}class te{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}te.type="NONE";const ne=te;function re(e,t,n){return`firebase:${e}:${t}:${n}`}class ie{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=re(this.userKey,r.apiKey,i),this.fullPersistenceKey=re("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?X._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ie(ee(ne),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||ee(ne);const o=re(n,e.config.apiKey,e.name);let s=null;for(const n of t)try{const t=await n._get(o);if(t){const r=X._fromJSON(e,t);n!==i&&(s=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],s&&await i._set(o,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(o)}catch(e){}}))),new ie(i,e,n)):new ie(i,e,n)}}function oe(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ce(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(se(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(de(t))return"Blackberry";if(he(t))return"Webos";if(ae(t))return"Safari";if((t.includes("chrome/")||le(t))&&!t.includes("edge/"))return"Chrome";if(ue(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function se(e=(0,i.ZQ)()){return/firefox\//i.test(e)}function ae(e=(0,i.ZQ)()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function le(e=(0,i.ZQ)()){return/crios\//i.test(e)}function ce(e=(0,i.ZQ)()){return/iemobile/i.test(e)}function ue(e=(0,i.ZQ)()){return/android/i.test(e)}function de(e=(0,i.ZQ)()){return/blackberry/i.test(e)}function he(e=(0,i.ZQ)()){return/webos/i.test(e)}function fe(e=(0,i.ZQ)()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function pe(e=(0,i.ZQ)()){return fe(e)||ue(e)||he(e)||de(e)||/windows phone/i.test(e)||ce(e)}function me(e,t=[]){let n;switch(e){case"Browser":n=oe((0,i.ZQ)());break;case"Worker":n=`${oe((0,i.ZQ)())}-${e}`;break;default:n=e}const o=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${r.MF}/${o}`}class ge{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class ve{constructor(e){var t,n,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=o.minPasswordLength)&&void 0!==t?t:6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),void 0!==o.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),void 0!==o.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),void 0!==o.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),void 0!==o.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,o,s;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(o=a.containsNumericCharacter)||void 0===o||o),a.isValid&&(a.isValid=null===(s=a.containsNonAlphanumericCharacter)||void 0===s||s),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class ye{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new we(this),this.idTokenSubscription=new we(this),this.beforeStateQueue=new ge(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=u,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ee(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await ie.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await V(this,{idToken:e}),n=await X._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if((0,r.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null==i?void 0:i._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==r||!(null==s?void 0:s.user)||(i=s.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return y(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await G(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,r.xZ)(this.app))return Promise.reject(g(this));const t=e?(0,i.Ku)(e):null;return t&&y(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&y(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(0,r.xZ)(this.app)?Promise.reject(g(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,r.xZ)(this.app)?Promise.reject(g(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(ee(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return A(e,"GET","/v2/passwordPolicy",N(e,t))}(this),t=new ve(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new i.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return A(e,"POST","/v2/accounts:revokeToken",N(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ee(e)||this._popupRedirectResolver;y(t,this,"argument-error"),this.redirectPersistenceManager=await ie.create(this,[ee(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let o=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(y(s,this,"internal-error"),s.then((()=>{o||i(this.currentUser)})),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{o=!0,i()}}{const n=e.addObserver(t);return()=>{o=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return y(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=me(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if((0,r.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){d.logLevel<=o.$b.WARN&&d.warn(`Auth (${r.MF}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function be(e){return(0,i.Ku)(e)}class we{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,i.tD)((e=>this.observer=e))}get next(){return y(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Se={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ee(e){return Se.loadJS(e)}function ke(e){return`__${e}${Math.floor(1e6*Math.random())}`}class _e{constructor(){this.enterprise=new xe}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class xe{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Te="NO_RECAPTCHA";class Ie{constructor(e){this.type="recaptcha-enterprise",this.auth=be(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;F(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n(Te)}))})):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new _e).execute("siteKey",{action:"verify"})}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{z(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new U(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&F(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Se.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Ee(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Ce(e,t,n,r=!1,i=!1){const o=new Ie(e);let s;if(i)s=Te;else try{s=await o.verify(n)}catch(e){s=await o.verify(n,!0)}const a=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Ne(e,t,n,r,i){var o,s;if("EMAIL_PASSWORD_PROVIDER"===i){if(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Ce(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await Ce(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}if("PHONE_PROVIDER"===i){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("PHONE_PROVIDER")){const i=await Ce(e,t,n);return r(e,i).catch((async i=>{var o;if("AUDIT"===(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const i=await Ce(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)}))}{const i=await Ce(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function Ae(e){const t=be(e),n=await z(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new U(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Ie(t).verify()}}function De(e,t,n){const r=be(e);y(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const o=!!(null==n?void 0:n.disableWarnings),s=Re(t),{host:a,port:l}=function(e){const t=Re(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Oe(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Oe(t)}}}(t),c={url:`${s}//${a}${null===l?"":`:${l}`}/`},u=Object.freeze({host:a,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!r._canInitEmulator)return y(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void y((0,i.bD)(c,r.config.emulator)&&(0,i.bD)(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,o||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Re(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Oe(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Le{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return b("not implemented")}_getIdTokenResponse(e){return b("not implemented")}_linkToIdToken(e,t){return b("not implemented")}_getReauthenticationResolver(e){return b("not implemented")}}async function Pe(e,t){return A(e,"POST","/v1/accounts:signUp",t)}async function Me(e,t){return R(e,"POST","/v1/accounts:signInWithPassword",N(e,t))}class Fe extends Le{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Fe(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Fe(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Ne(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Me,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return R(e,"POST","/v1/accounts:signInWithEmailLink",N(e,t))}(e,{email:this._email,oobCode:this._password});default:f(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ne(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Pe,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return R(e,"POST","/v1/accounts:signInWithEmailLink",N(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:f(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ue(e,t){return R(e,"POST","/v1/accounts:signInWithIdp",N(e,t))}class ze extends Le{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ze(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):f("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=(0,s.Tt)(t,["providerId","signInMethod"]);if(!n||!r)return null;const o=new ze(n,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){return Ue(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ue(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ue(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,i.Am)(t)}return e}}async function Ve(e,t){return A(e,"POST","/v1/accounts:sendVerificationCode",N(e,t))}const je={USER_NOT_FOUND:"user-not-found"};class We extends Le{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new We({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new We({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return R(e,"POST","/v1/accounts:signInWithPhoneNumber",N(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await R(e,"POST","/v1/accounts:signInWithPhoneNumber",N(e,t));if(n.temporaryProof)throw M(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return R(e,"POST","/v1/accounts:signInWithPhoneNumber",N(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),je)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new We({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class $e{constructor(e){var t,n,r,o,s,a;const l=(0,i.I9)((0,i.hp)(e)),c=null!==(t=l.apiKey)&&void 0!==t?t:null,u=null!==(n=l.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=l.mode)&&void 0!==r?r:null);y(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=null!==(o=l.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(s=l.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=l.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=(0,i.I9)((0,i.hp)(e)).link,n=t?(0,i.I9)((0,i.hp)(t)).deep_link_id:null,r=(0,i.I9)((0,i.hp)(e)).deep_link_id;return(r?(0,i.I9)((0,i.hp)(r)).link:null)||r||n||t||e}(e);try{return new $e(t)}catch(e){return null}}}class Be{constructor(){this.providerId=Be.PROVIDER_ID}static credential(e,t){return Fe._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=$e.parseLink(t);return y(n,"argument-error"),Fe._fromEmailAndCode(e,n.code,n.tenantId)}}Be.PROVIDER_ID="password",Be.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Be.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class qe{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class He extends qe{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ke extends He{constructor(){super("facebook.com")}static credential(e){return ze._fromParams({providerId:Ke.PROVIDER_ID,signInMethod:Ke.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ke.credentialFromTaggedObject(e)}static credentialFromError(e){return Ke.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Ke.credential(e.oauthAccessToken)}catch(e){return null}}}Ke.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ke.PROVIDER_ID="facebook.com";class Ge extends He{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ze._fromParams({providerId:Ge.PROVIDER_ID,signInMethod:Ge.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ge.credentialFromTaggedObject(e)}static credentialFromError(e){return Ge.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Ge.credential(t,n)}catch(e){return null}}}Ge.GOOGLE_SIGN_IN_METHOD="google.com",Ge.PROVIDER_ID="google.com";class Qe extends He{constructor(){super("github.com")}static credential(e){return ze._fromParams({providerId:Qe.PROVIDER_ID,signInMethod:Qe.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qe.credentialFromTaggedObject(e)}static credentialFromError(e){return Qe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Qe.credential(e.oauthAccessToken)}catch(e){return null}}}Qe.GITHUB_SIGN_IN_METHOD="github.com",Qe.PROVIDER_ID="github.com";class Ye extends He{constructor(){super("twitter.com")}static credential(e,t){return ze._fromParams({providerId:Ye.PROVIDER_ID,signInMethod:Ye.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ye.credentialFromTaggedObject(e)}static credentialFromError(e){return Ye.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ye.credential(t,n)}catch(e){return null}}}Ye.TWITTER_SIGN_IN_METHOD="twitter.com",Ye.PROVIDER_ID="twitter.com";class Je{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await X._fromIdTokenResponse(e,n,r),o=Xe(n);return new Je({user:i,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Xe(n);return new Je({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Xe(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Ze extends i.g{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Ze.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Ze(e,t,n,r)}}function et(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Ze._fromErrorAndOperation(e,n,t,r);throw n}))}async function tt(e,t,n=!1){const r=await q(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Je._forOperation(e,"link",r)}async function nt(e,t,n=!1){const{auth:i}=e;if((0,r.xZ)(i.app))return Promise.reject(g(i));const o="reauthenticate";try{const r=await q(e,et(i,o,t,e),n);y(r.idToken,i,"internal-error");const s=$(r.idToken);y(s,i,"internal-error");const{sub:a}=s;return y(e.uid===a,i,"user-mismatch"),Je._forOperation(e,o,r)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&f(i,"user-mismatch"),e}}async function rt(e,t,n=!1){if((0,r.xZ)(e.app))return Promise.reject(g(e));const i="signIn",o=await et(e,i,t),s=await Je._fromIdTokenResponse(e,i,o);return n||await e._updateCurrentUser(s.user),s}function it(e,t,n,r){return(0,i.Ku)(e).onAuthStateChanged(t,n,r)}function ot(e,t){return A(e,"POST","/v2/accounts/mfaEnrollment:start",N(e,t))}new WeakMap;const st="__sak";class at{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(st,"1"),this.storage.removeItem(st),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class lt extends at{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pe(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},o=this.storage.getItem(n);(0,i.lT)()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}lt.type="LOCAL";const ct=lt;class ut extends at{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ut.type="SESSION";const dt=ut;class ht{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new ht(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(!(null==o?void 0:o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(o).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ft(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}ht.receivers=[];class pt{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise(((s,a)=>{const l=ft("",20);r.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);o={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),s(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{o&&this.removeMessageHandler(o)}))}}function mt(){return window}function gt(){return void 0!==mt().WorkerGlobalScope&&"function"==typeof mt().importScripts}const vt="firebaseLocalStorageDb",yt="firebaseLocalStorage",bt="fbase_key";class wt{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function St(e,t){return e.transaction([yt],t?"readwrite":"readonly").objectStore(yt)}function Et(){const e=indexedDB.open(vt,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(yt,{keyPath:bt})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(yt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(vt);return new wt(e).toPromise()}(),t(await Et()))}))}))}async function kt(e,t,n){const r=St(e,!0).put({[bt]:t,value:n});return new wt(r).toPromise()}function _t(e,t){const n=St(e,!0).delete(t);return new wt(n).toPromise()}class xt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Et()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return gt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ht._getInstance(gt()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new pt(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Et();return await kt(e,st,"1"),await _t(e,st),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>kt(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=St(e,!1).get(t),r=await new wt(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>_t(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=St(e,!1).getAll();return new wt(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}xt.type="LOCAL";const Tt=xt;function It(e,t){return A(e,"POST","/v2/accounts/mfaSignIn:start",N(e,t))}ke("rcb"),new _(3e4,6e4);const Ct="recaptcha";async function Nt(e,t,n){var r;if(!e._getRecaptchaConfig())try{await Ae(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"==typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){y("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},o=Ne(e,r,"mfaSmsEnrollment",(async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Te){y((null==n?void 0:n.type)===Ct,e,"argument-error");return ot(e,await At(e,t,n))}return ot(e,t)}),"PHONE_PROVIDER");return(await o.catch((e=>Promise.reject(e)))).phoneSessionInfo.sessionInfo}{y("signin"===t.type,e,"internal-error");const o=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;y(o,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=Ne(e,s,"mfaSmsSignIn",(async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Te){y((null==n?void 0:n.type)===Ct,e,"argument-error");return It(e,await At(e,t,n))}return It(e,t)}),"PHONE_PROVIDER");return(await a.catch((e=>Promise.reject(e)))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=Ne(e,t,"sendVerificationCode",(async(e,t)=>{if(t.captchaResponse===Te){y((null==n?void 0:n.type)===Ct,e,"argument-error");return Ve(e,await At(e,t,n))}return Ve(e,t)}),"PHONE_PROVIDER");return(await r.catch((e=>Promise.reject(e)))).sessionInfo}}finally{null==n||n._reset()}}async function At(e,t,n){y(n.type===Ct,e,"argument-error");const r=await n.verify();y("string"==typeof r,e,"argument-error");const i=Object.assign({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,o=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:o}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Dt{constructor(e){this.providerId=Dt.PROVIDER_ID,this.auth=be(e)}verifyPhoneNumber(e,t){return Nt(this.auth,e,(0,i.Ku)(t))}static credential(e,t){return We._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Dt.credentialFromTaggedObject(t)}static credentialFromError(e){return Dt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?We._fromTokenResponse(t,n):null}}function Rt(e,t){return t?ee(t):(y(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Dt.PROVIDER_ID="phone",Dt.PHONE_SIGN_IN_METHOD="phone";class Ot extends Le{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ue(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ue(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ue(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Lt(e){return rt(e.auth,new Ot(e),e.bypassAuthState)}function Pt(e){const{auth:t,user:n}=e;return y(n,t,"internal-error"),nt(n,new Ot(e),e.bypassAuthState)}async function Mt(e){const{auth:t,user:n}=e;return y(n,t,"internal-error"),tt(n,new Ot(e),e.bypassAuthState)}class Ft{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:o,type:s}=e;if(o)return void this.reject(o);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Lt;case"linkViaPopup":case"linkViaRedirect":return Mt;case"reauthViaPopup":case"reauthViaRedirect":return Pt;default:f(this.auth,"internal-error")}}resolve(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Ut=new _(2e3,1e4);class zt extends Ft{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,zt.currentPopupAction&&zt.currentPopupAction.cancel(),zt.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return y(e,this.auth,"internal-error"),e}async onExecution(){w(1===this.filter.length,"Popup operations only handle one event");const e=ft();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(p(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(p(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zt.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(p(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Ut.get())};e()}}zt.currentPopupAction=null;const Vt=new Map;class jt extends Ft{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Vt.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Bt(t),r=$t(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Vt.set(this.auth._key(),e)}return this.bypassAuthState||Vt.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Wt(e,t){Vt.set(e._key(),t)}function $t(e){return ee(e._redirectPersistence)}function Bt(e){return re("pendingRedirect",e.config.apiKey,e.name)}async function qt(e,t,n=!1){if((0,r.xZ)(e.app))return Promise.reject(g(e));const i=be(e),o=Rt(i,t),s=new jt(i,o,n),a=await s.execute();return a&&!n&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,t)),a}class Ht{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gt(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Gt(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(p(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Kt(e))}saveEventToCache(e){this.cachedEventUids.add(Kt(e)),this.lastProcessedEventTime=Date.now()}}function Kt(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Gt({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Qt=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Yt=/^https?/;async function Jt(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return A(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Xt(e))return}catch(e){}f(e,"unauthorized-domain")}function Xt(e){const t=S(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Yt.test(n))return!1;if(Qt.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Zt=new _(3e4,6e4);function en(){const e=mt().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function tn(e){return new Promise(((t,n)=>{var r,i,o;function s(){en(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{en(),n(p(e,"network-request-failed"))},timeout:Zt.get()})}if(null===(i=null===(r=mt().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(o=mt().gapi)||void 0===o?void 0:o.load)){const t=ke("iframefcb");return mt()[t]=()=>{gapi.load?s():n(p(e,"network-request-failed"))},Ee(`${Se.gapiScript}?onload=${t}`).catch((e=>n(e)))}s()}})).catch((e=>{throw nn=null,e}))}let nn=null;const rn=new _(5e3,15e3),on={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function an(e){const t=e.config;y(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?x(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,o={apiKey:t.apiKey,appName:e.name,v:r.MF},s=sn.get(e.config.apiHost);s&&(o.eid=s);const a=e._getFrameworks();return a.length&&(o.fw=a.join(",")),`${n}?${(0,i.Am)(o).slice(1)}`}async function ln(e){const t=await function(e){return nn=nn||tn(e),nn}(e),n=mt().gapi;return y(n,e,"internal-error"),t.open({where:document.body,url:an(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:on,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=p(e,"network-request-failed"),o=mt().setTimeout((()=>{r(i)}),rn.get());function s(){mt().clearTimeout(o),n(t)}t.ping(s).then(s,(()=>{r(i)}))}))))}const cn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class un{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function dn(e,t,n,r=500,o=600){const s=Math.max((window.screen.availHeight-o)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},cn),{width:r.toString(),height:o.toString(),top:s,left:a}),u=(0,i.ZQ)().toLowerCase();n&&(l=le(u)?"_blank":n),se(u)&&(t=t||"http://localhost",c.scrollbars="yes");const d=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=(0,i.ZQ)()){var t;return fe(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==l)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",l),new un(null);const h=window.open(t||"",l,d);y(h,e,"popup-blocked");try{h.focus()}catch(e){}return new un(h)}const hn="__/auth/handler",fn="emulator/auth/handler",pn=encodeURIComponent("fac");async function mn(e,t,n,o,s,a){y(e.config.authDomain,e,"auth-domain-config-required"),y(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:o,v:r.MF,eventId:s};if(t instanceof qe){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,i.Im)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))l[e]=t}if(t instanceof He){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);const c=l;for(const e of Object.keys(c))void 0===c[e]&&delete c[e];const u=await e._getAppCheckToken(),d=u?`#${pn}=${encodeURIComponent(u)}`:"";return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${hn}`;return x(e,fn)}(e)}?${(0,i.Am)(c).slice(1)}${d}`}const gn="webStorageSupport";const vn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dt,this._completeRedirectFn=qt,this._overrideRedirectResult=Wt}async _openPopup(e,t,n,r){var i;w(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return dn(e,await mn(e,t,n,S(),r),ft())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){mt().location.href=e}(await mn(e,t,n,S(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(w(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await ln(e),n=new Ht(e);return t.register("authEvent",(t=>{y(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(gn,{type:gn},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[gn];void 0!==i&&t(!!i),f(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Jt(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return pe()||ae()||fe()}};var yn="@firebase/auth",bn="1.9.1";class wn{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){y(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Sn=(0,i.XA)("authIdTokenMaxAge")||300;let En=null;const kn=e=>async t=>{const n=t&&await t.getIdTokenResult(),r=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Sn)return;const i=null==n?void 0:n.token;En!==i&&(En=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function _n(e=(0,r.Sx)()){const t=(0,r.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,r.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if((0,i.bD)(r,null!=t?t:{}))return e;f(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:vn,persistence:[Tt,ct,dt]}),o=(0,i.XA)("authTokenSyncURL");if(o&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(o,location.origin);if(location.origin===e.origin){const t=kn(e.toString());!function(e,t,n){(0,i.Ku)(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){(0,i.Ku)(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}const s=(0,i.Tj)("auth");return s&&De(n,`http://${s}`),n}var xn,Tn;xn={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=p("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Se=xn,Tn="Browser",(0,r.om)(new a.uA("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:s}=n.options;y(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:o,authDomain:s,clientPlatform:Tn,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:me(Tn)},l=new ye(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ee);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(l,t),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),(0,r.om)(new a.uA("auth-internal",(e=>(e=>new wn(e))(be(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,r.KO)(yn,bn,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Tn)),(0,r.KO)(yn,bn,"esm2017")},2440:(e,t,n)=>{n.d(t,{hg:()=>r.y,xI:()=>r.o});var r=n(5387);n(8461),n(6743),n(3424),n(5125)},5790:(e,t,n)=>{n.d(t,{BN:()=>Ql,C3:()=>ac,CL:()=>ic,Dc:()=>$,Fs:()=>Ga,GG:()=>Gl,GV:()=>lc,H9:()=>Ua,My:()=>Pl,O5:()=>oc,P:()=>Al,_M:()=>Rl,aQ:()=>Zl,aU:()=>$a,gS:()=>Xl,hq:()=>sc,kd:()=>Jl,mZ:()=>Yl,rJ:()=>Fa,wP:()=>cc,x7:()=>Hl});var r=n(8461),i=n(5125),o=n(3424),s=n(6743),a=n(2429),l=n(1853);const c="@firebase/firestore",u="4.7.10";class d{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}d.UNAUTHENTICATED=new d(null),d.GOOGLE_CREDENTIALS=new d("google-credentials-uid"),d.FIRST_PARTY=new d("first-party-uid"),d.MOCK_USER=new d("mock-user");let h="11.5.0";const f=new o.Vy("@firebase/firestore");function p(){return f.logLevel}function m(e,...t){if(f.logLevel<=o.$b.DEBUG){const n=t.map(y);f.debug(`Firestore (${h}): ${e}`,...n)}}function g(e,...t){if(f.logLevel<=o.$b.ERROR){const n=t.map(y);f.error(`Firestore (${h}): ${e}`,...n)}}function v(e,...t){if(f.logLevel<=o.$b.WARN){const n=t.map(y);f.warn(`Firestore (${h}): ${e}`,...n)}}function y(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function b(e="Unexpected state"){const t=`FIRESTORE (${h}) INTERNAL ASSERTION FAILED: `+e;throw g(t),new Error(t)}function w(e,t){e||b()}function S(e,t){return e}const E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends s.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class x{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class T{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(d.UNAUTHENTICATED)))}shutdown(){}}class I{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class C{constructor(e){this.t=e,this.currentUser=d.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){w(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new _;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new _,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},s=e=>{m("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(m("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new _)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(m("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(w("string"==typeof t.accessToken),new x(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return w(null===e||"string"==typeof e),new d(e)}}class N{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=d.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class A{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new N(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(d.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class D{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class R{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,(0,r.xZ)(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){w(void 0===this.o);const n=e=>{null!=e.error&&m("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,m("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{m("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):m("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.V)return Promise.resolve(new D(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(w("string"==typeof e.token),this.R=e.token,new D(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function O(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}function L(){return new TextEncoder}class P{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=O(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function M(e,t){return e<t?-1:e>t?1:0}function F(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return M(r,i);{const o=L(),s=z(o.encode(U(e,n)),o.encode(U(t,n)));return 0!==s?s:M(r,i)}}n+=r>65535?2:1}return M(e.length,t.length)}function U(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function z(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return M(e[n],t[n]);return M(e.length,t.length)}function V(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}const j=-62135596800,W=1e6;class ${static now(){return $.fromMillis(Date.now())}static fromDate(e){return $.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*W);return new $(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<j)throw new k(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/W}_compareTo(e){return this.seconds===e.seconds?M(this.nanoseconds,e.nanoseconds):M(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-j;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class B{static fromTimestamp(e){return new B(e)}static min(){return new B(new $(0,0))}static max(){return new B(new $(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const q="__name__";class H{constructor(e,t,n){void 0===t?t=0:t>e.length&&b(),void 0===n?n=e.length-t:n>e.length-t&&b(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===H.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof H?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=H.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return M(e.length,t.length)}static compareSegments(e,t){const n=H.isNumericId(e),r=H.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?H.extractNumericId(e).compare(H.extractNumericId(t)):F(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return a.jz.fromString(e.substring(4,e.length-2))}}class K extends H{construct(e,t,n){return new K(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new k(E.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new K(t)}static emptyPath(){return new K([])}}const G=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Q extends H{construct(e,t,n){return new Q(e,t,n)}static isValidIdentifier(e){return G.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Q.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===q}static keyField(){return new Q([q])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new k(E.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new k(E.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new k(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(o=!o,r++):"."!==t||o?(n+=t,r++):(i(),r++)}if(i(),o)throw new k(E.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Q(t)}static emptyPath(){return new Q([])}}class Y{constructor(e){this.path=e}static fromPath(e){return new Y(K.fromString(e))}static fromName(e){return new Y(K.fromString(e).popFirst(5))}static empty(){return new Y(K.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===K.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return K.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new K(e.slice()))}}const J=-1;class X{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}X.UNKNOWN_ID=-1;function Z(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=B.fromTimestamp(1e9===r?new $(n+1,0):new $(n,r));return new te(i,Y.empty(),t)}function ee(e){return new te(e.readTime,e.key,J)}class te{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new te(B.min(),Y.empty(),J)}static max(){return new te(B.max(),Y.empty(),J)}}function ne(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Y.comparator(e.documentKey,t.documentKey),0!==n?n:M(e.largestBatchId,t.largestBatchId))}const re="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ie{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function oe(e){if(e.code!==E.FAILED_PRECONDITION||e.message!==re)throw e;m("LocalStore","Unexpectedly lost primary lease")}class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&b(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new se(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof se?t:se.resolve(t)}catch(e){return se.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):se.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):se.reject(t)}static resolve(e){return new se(((t,n)=>{t(e)}))}static reject(e){return new se(((t,n)=>{n(e)}))}static waitFor(e){return new se(((t,n)=>{let r=0,i=0,o=!1;e.forEach((e=>{++r,e.next((()=>{++i,o&&i===r&&t()}),(e=>n(e)))})),o=!0,i===r&&t()}))}static or(e){let t=se.resolve(!1);for(const n of e)t=t.next((e=>e?se.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new se(((n,r)=>{const i=e.length,o=new Array(i);let s=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next((e=>{o[l]=e,++s,s===i&&n(o)}),(e=>r(e)))}}))}static doWhile(e,t){return new se(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}function ae(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function le(e){return"IndexedDbTransactionError"===e.name}class ce{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}ce.ae=-1;const ue=-1;function de(e){return null==e}function he(e){return 0===e&&1/e==-1/0}function fe(e){return"number"==typeof e&&Number.isInteger(e)&&!he(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const pe="";function me(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=ve(t)),t=ge(e.get(n),t);return ve(t)}function ge(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case pe:n+="";break;default:n+=r}}return n}function ve(e){return e+pe+""}const ye="remoteDocuments",be="owner",we="mutationQueues",Se="mutations";const Ee="documentMutations",ke="remoteDocumentsV14",_e="remoteDocumentGlobal",xe="targets",Te="targetDocuments",Ie="targetGlobal",Ce="collectionParents",Ne="clientMetadata",Ae="bundles",De="namedQueries",Re="indexConfiguration",Oe="indexState",Le="indexEntries",Pe="documentOverlays",Me="globals",Fe=[we,Se,Ee,ye,xe,be,Ie,Te,Ne,_e,Ce,Ae,De],Ue=[we,Se,Ee,ke,xe,be,Ie,Te,Ne,_e,Ce,Ae,De,Pe],ze=Ue,Ve=[...ze,Re,Oe,Le];function je(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function We(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function $e(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Be{constructor(e,t){this.comparator=e,this.root=t||He.EMPTY}insert(e,t){return new Be(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,He.BLACK,null,null))}remove(e){return new Be(this.comparator,this.root.remove(e,this.comparator).copy(null,null,He.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qe(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qe(this.root,e,this.comparator,!1)}getReverseIterator(){return new qe(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qe(this.root,e,this.comparator,!0)}}class qe{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class He{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:He.RED,this.left=null!=r?r:He.EMPTY,this.right=null!=i?i:He.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new He(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return He.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return He.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,He.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,He.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw b();if(this.right.isRed())throw b();const e=this.left.check();if(e!==this.right.check())throw b();return e+(this.isRed()?0:1)}}He.EMPTY=null,He.RED=!0,He.BLACK=!1,He.EMPTY=new class{constructor(){this.size=0}get key(){throw b()}get value(){throw b()}get color(){throw b()}get left(){throw b()}get right(){throw b()}copy(e,t,n,r,i){return this}insert(e,t,n){return new He(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ke{constructor(e){this.comparator=e,this.data=new Be(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ge(this.data.getIterator())}getIteratorFrom(e){return new Ge(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Ke))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ke(this.comparator);return t.data=e,t}}class Ge{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Qe{constructor(e){this.fields=e,e.sort(Q.comparator)}static empty(){return new Qe([])}unionWith(e){let t=new Ke(Q.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new Qe(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return V(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Ye extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Je{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ye("Invalid base64 string: "+e):e}}(e);return new Je(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Je(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return M(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Je.EMPTY_BYTE_STRING=new Je("");const Xe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ze(e){if(w(!!e),"string"==typeof e){let t=0;const n=Xe.exec(e);if(w(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:et(e.seconds),nanos:et(e.nanos)}}function et(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function tt(e){return"string"==typeof e?Je.fromBase64String(e):Je.fromUint8Array(e)}const nt="server_timestamp",rt="__type__",it="__previous_value__",ot="__local_write_time__";function st(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[rt])||void 0===n?void 0:n.stringValue)===nt}function at(e){const t=e.mapValue.fields[it];return st(t)?at(t):t}function lt(e){const t=Ze(e.mapValue.fields[ot].timestampValue);return new $(t.seconds,t.nanos)}class ct{constructor(e,t,n,r,i,o,s,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=a,this.useFetchStreams=l}}const ut="(default)";class dt{constructor(e,t){this.projectId=e,this.database=t||ut}static empty(){return new dt("","")}get isDefaultDatabase(){return this.database===ut}isEqual(e){return e instanceof dt&&e.projectId===this.projectId&&e.database===this.database}}const ht="__type__",ft="__max__",pt={mapValue:{fields:{__type__:{stringValue:ft}}}},mt="__vector__",gt="value";function vt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?st(e)?4:Lt(e)?9007199254740991:Rt(e)?10:11:b()}function yt(e,t){if(e===t)return!0;const n=vt(e);if(n!==vt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return lt(e).isEqual(lt(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Ze(e.timestampValue),r=Ze(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return tt(e.bytesValue).isEqual(tt(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return et(e.geoPointValue.latitude)===et(t.geoPointValue.latitude)&&et(e.geoPointValue.longitude)===et(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return et(e.integerValue)===et(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=et(e.doubleValue),r=et(t.doubleValue);return n===r?he(n)===he(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return V(e.arrayValue.values||[],t.arrayValue.values||[],yt);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(je(n)!==je(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!yt(n[e],r[e])))return!1;return!0}(e,t);default:return b()}}function bt(e,t){return void 0!==(e.values||[]).find((e=>yt(e,t)))}function wt(e,t){if(e===t)return 0;const n=vt(e),r=vt(t);if(n!==r)return M(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return M(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=et(e.integerValue||e.doubleValue),r=et(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return St(e.timestampValue,t.timestampValue);case 4:return St(lt(e),lt(t));case 5:return F(e.stringValue,t.stringValue);case 6:return function(e,t){const n=tt(e),r=tt(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=M(n[e],r[e]);if(0!==t)return t}return M(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=M(et(e.latitude),et(t.latitude));return 0!==n?n:M(et(e.longitude),et(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Et(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,o;const s=e.fields||{},a=t.fields||{},l=null===(n=s[gt])||void 0===n?void 0:n.arrayValue,c=null===(r=a[gt])||void 0===r?void 0:r.arrayValue,u=M((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(o=null==c?void 0:c.values)||void 0===o?void 0:o.length)||0);return 0!==u?u:Et(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===pt.mapValue&&t===pt.mapValue)return 0;if(e===pt.mapValue)return 1;if(t===pt.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(let e=0;e<r.length&&e<o.length;++e){const t=F(r[e],o[e]);if(0!==t)return t;const s=wt(n[r[e]],i[o[e]]);if(0!==s)return s}return M(r.length,o.length)}(e.mapValue,t.mapValue);default:throw b()}}function St(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return M(e,t);const n=Ze(e),r=Ze(t),i=M(n.seconds,r.seconds);return 0!==i?i:M(n.nanos,r.nanos)}function Et(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=wt(n[e],r[e]);if(t)return t}return M(n.length,r.length)}function kt(e){return _t(e)}function _t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Ze(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return tt(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Y.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=_t(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${_t(e.fields[i])}`;return n+"}"}(e.mapValue):b()}function xt(e){switch(vt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=at(e);return t?16+xt(t):16;case 5:return 2*e.stringValue.length;case 6:return tt(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+xt(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return We(e.fields,((e,n)=>{t+=e.length+xt(n)})),t}(e.mapValue);default:throw b()}}function Tt(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function It(e){return!!e&&"integerValue"in e}function Ct(e){return!!e&&"arrayValue"in e}function Nt(e){return!!e&&"nullValue"in e}function At(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Dt(e){return!!e&&"mapValue"in e}function Rt(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[ht])||void 0===n?void 0:n.stringValue)===mt}function Ot(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return We(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Ot(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ot(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Lt(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===ft}class Pt{constructor(e){this.value=e}static empty(){return new Pt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Dt(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ot(t)}setAll(e){let t=Q.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Ot(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Dt(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return yt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Dt(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){We(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Pt(Ot(this.value))}}function Mt(e){const t=[];return We(e.fields,((e,n)=>{const r=new Q([e]);if(Dt(n)){const e=Mt(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Qe(t)}class Ft{constructor(e,t,n,r,i,o,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=s}static newInvalidDocument(e){return new Ft(e,0,B.min(),B.min(),B.min(),Pt.empty(),0)}static newFoundDocument(e,t,n,r){return new Ft(e,1,t,B.min(),n,r,0)}static newNoDocument(e,t){return new Ft(e,2,t,B.min(),B.min(),Pt.empty(),0)}static newUnknownDocument(e,t){return new Ft(e,3,t,B.min(),B.min(),Pt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(B.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ft&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ft(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ut{constructor(e,t){this.position=e,this.inclusive=t}}function zt(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const o=t[i],s=e.position[i];if(r=o.field.isKeyField()?Y.comparator(Y.fromName(s.referenceValue),n.key):wt(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return r}function Vt(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!yt(e.position[n],t.position[n]))return!1;return!0}class jt{constructor(e,t="asc"){this.field=e,this.dir=t}}function Wt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class $t{}class Bt extends $t{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Xt(e,t,n):"array-contains"===t?new nn(e,n):"in"===t?new rn(e,n):"not-in"===t?new on(e,n):"array-contains-any"===t?new sn(e,n):new Bt(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Zt(e,n):new en(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(wt(t,this.value)):null!==t&&vt(this.value)===vt(t)&&this.matchesComparison(wt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return b()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qt extends $t{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new qt(e,t)}matches(e){return Ht(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function Ht(e){return"and"===e.op}function Kt(e){return Gt(e)&&Ht(e)}function Gt(e){for(const t of e.filters)if(t instanceof qt)return!1;return!0}function Qt(e){if(e instanceof Bt)return e.field.canonicalString()+e.op.toString()+kt(e.value);if(Kt(e))return e.filters.map((e=>Qt(e))).join(",");{const t=e.filters.map((e=>Qt(e))).join(",");return`${e.op}(${t})`}}function Yt(e,t){return e instanceof Bt?function(e,t){return t instanceof Bt&&e.op===t.op&&e.field.isEqual(t.field)&&yt(e.value,t.value)}(e,t):e instanceof qt?function(e,t){return t instanceof qt&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&Yt(n,t.filters[r])),!0)}(e,t):void b()}function Jt(e){return e instanceof Bt?function(e){return`${e.field.canonicalString()} ${e.op} ${kt(e.value)}`}(e):e instanceof qt?function(e){return e.op.toString()+" {"+e.getFilters().map(Jt).join(" ,")+"}"}(e):"Filter"}class Xt extends Bt{constructor(e,t,n){super(e,t,n),this.key=Y.fromName(n.referenceValue)}matches(e){const t=Y.comparator(e.key,this.key);return this.matchesComparison(t)}}class Zt extends Bt{constructor(e,t){super(e,"in",t),this.keys=tn("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class en extends Bt{constructor(e,t){super(e,"not-in",t),this.keys=tn("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function tn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Y.fromName(e.referenceValue)))}class nn extends Bt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ct(t)&&bt(t.arrayValue,this.value)}}class rn extends Bt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&bt(this.value.arrayValue,t)}}class on extends Bt{constructor(e,t){super(e,"not-in",t)}matches(e){if(bt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!bt(this.value.arrayValue,t)}}class sn extends Bt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ct(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>bt(this.value.arrayValue,e)))}}class an{constructor(e,t=null,n=[],r=[],i=null,o=null,s=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.le=null}}function ln(e,t=null,n=[],r=[],i=null,o=null,s=null){return new an(e,t,n,r,i,o,s)}function cn(e){const t=S(e);if(null===t.le){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Qt(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),de(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>kt(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>kt(e))).join(",")),t.le=e}return t.le}function un(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Wt(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Yt(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Vt(e.startAt,t.startAt)&&Vt(e.endAt,t.endAt)}function dn(e){return Y.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class hn{constructor(e,t=null,n=[],r=[],i=null,o="F",s=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function fn(e,t,n,r,i,o,s,a){return new hn(e,t,n,r,i,o,s,a)}function pn(e){return new hn(e)}function mn(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function gn(e){return null!==e.collectionGroup}function vn(e){const t=S(e);if(null===t.he){t.he=[];const e=new Set;for(const n of t.explicitOrderBy)t.he.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Ke(Q.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.he.push(new jt(r,n))})),e.has(Q.keyField().canonicalString())||t.he.push(new jt(Q.keyField(),n))}return t.he}function yn(e){const t=S(e);return t.Pe||(t.Pe=bn(t,vn(e))),t.Pe}function bn(e,t){if("F"===e.limitType)return ln(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new jt(e.field,t)}));const n=e.endAt?new Ut(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Ut(e.startAt.position,e.startAt.inclusive):null;return ln(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function wn(e,t){const n=e.filters.concat([t]);return new hn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Sn(e,t,n){return new hn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function En(e,t){return un(yn(e),yn(t))&&e.limitType===t.limitType}function kn(e){return`${cn(yn(e))}|lt:${e.limitType}`}function _n(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Jt(e))).join(", ")}]`),de(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>kt(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>kt(e))).join(",")),`Target(${t})`}(yn(e))}; limitType=${e.limitType})`}function xn(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Y.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of vn(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=zt(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,vn(e),t))&&!(e.endAt&&!function(e,t,n){const r=zt(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,vn(e),t))}(e,t)}function Tn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function In(e){return(t,n)=>{let r=!1;for(const i of vn(e)){const e=Cn(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Cn(e,t,n){const r=e.field.isKeyField()?Y.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?wt(r,i):b()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return b()}}class Nn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){We(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return $e(this.inner)}size(){return this.innerSize}}const An=new Be(Y.comparator);function Dn(){return An}const Rn=new Be(Y.comparator);function On(...e){let t=Rn;for(const n of e)t=t.insert(n.key,n);return t}function Ln(e){let t=Rn;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Pn(){return Fn()}function Mn(){return Fn()}function Fn(){return new Nn((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Un=new Be(Y.comparator),zn=new Ke(Y.comparator);function Vn(...e){let t=zn;for(const n of e)t=t.add(n);return t}const jn=new Ke(M);function Wn(){return jn}function $n(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:he(t)?"-0":t}}function Bn(e){return{integerValue:""+e}}function qn(e,t){return fe(t)?Bn(t):$n(e,t)}class Hn{constructor(){this._=void 0}}function Kn(e,t,n){return e instanceof Yn?function(e,t){const n={fields:{[rt]:{stringValue:nt},[ot]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&st(t)&&(t=at(t)),t&&(n.fields[it]=t),{mapValue:n}}(n,t):e instanceof Jn?Xn(e,t):e instanceof Zn?er(e,t):function(e,t){const n=Qn(e,t),r=nr(n)+nr(e.Ie);return It(n)&&It(e.Ie)?Bn(r):$n(e.serializer,r)}(e,t)}function Gn(e,t,n){return e instanceof Jn?Xn(e,t):e instanceof Zn?er(e,t):n}function Qn(e,t){return e instanceof tr?function(e){return It(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Yn extends Hn{}class Jn extends Hn{constructor(e){super(),this.elements=e}}function Xn(e,t){const n=rr(t);for(const t of e.elements)n.some((e=>yt(e,t)))||n.push(t);return{arrayValue:{values:n}}}class Zn extends Hn{constructor(e){super(),this.elements=e}}function er(e,t){let n=rr(t);for(const t of e.elements)n=n.filter((e=>!yt(e,t)));return{arrayValue:{values:n}}}class tr extends Hn{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function nr(e){return et(e.integerValue||e.doubleValue)}function rr(e){return Ct(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class ir{constructor(e,t){this.field=e,this.transform=t}}class or{constructor(e,t){this.version=e,this.transformResults=t}}class sr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new sr}static exists(e){return new sr(void 0,e)}static updateTime(e){return new sr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ar(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class lr{}function cr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new br(e.key,sr.none()):new pr(e.key,e.data,sr.none());{const n=e.data,r=Pt.empty();let i=new Ke(Q.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new mr(e.key,r,new Qe(i.toArray()),sr.none())}}function ur(e,t,n){e instanceof pr?function(e,t,n){const r=e.value.clone(),i=vr(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof mr?function(e,t,n){if(!ar(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=vr(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(gr(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function dr(e,t,n,r){return e instanceof pr?function(e,t,n,r){if(!ar(e.precondition,t))return n;const i=e.value.clone(),o=yr(e.fieldTransforms,r,t);return i.setAll(o),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof mr?function(e,t,n,r){if(!ar(e.precondition,t))return n;const i=yr(e.fieldTransforms,r,t),o=t.data;return o.setAll(gr(e)),o.setAll(i),t.convertToFoundDocument(t.version,o).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return ar(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function hr(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Qn(r.transform,e||null);null!=i&&(null===n&&(n=Pt.empty()),n.set(r.field,i))}return n||null}function fr(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&V(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Jn&&t instanceof Jn||e instanceof Zn&&t instanceof Zn?V(e.elements,t.elements,yt):e instanceof tr&&t instanceof tr?yt(e.Ie,t.Ie):e instanceof Yn&&t instanceof Yn}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class pr extends lr{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class mr extends lr{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function gr(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function vr(e,t,n){const r=new Map;w(e.length===n.length);for(let i=0;i<n.length;i++){const o=e[i],s=o.transform,a=t.data.field(o.field);r.set(o.field,Gn(s,a,n[i]))}return r}function yr(e,t,n){const r=new Map;for(const i of e){const e=i.transform,o=n.data.field(i.field);r.set(i.field,Kn(e,o,t))}return r}class br extends lr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wr extends lr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Sr{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&ur(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=dr(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=dr(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Mn();return this.mutations.forEach((r=>{const i=e.get(r.key),o=i.overlayedDocument;let s=this.applyToLocalView(o,i.mutatedFields);s=t.has(r.key)?null:s;const a=cr(o,s);null!==a&&n.set(r.key,a),o.isValidDocument()||o.convertToNoDocument(B.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Vn())}isEqual(e){return this.batchId===e.batchId&&V(this.mutations,e.mutations,((e,t)=>fr(e,t)))&&V(this.baseMutations,e.baseMutations,((e,t)=>fr(e,t)))}}class Er{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){w(e.mutations.length===n.length);let r=Un;const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new Er(e,t,n,r)}}class kr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class _r{constructor(e,t){this.count=e,this.unchangedNames=t}}var xr,Tr;function Ir(e){switch(e){case E.OK:return b();case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0;default:return b()}}function Cr(e){if(void 0===e)return g("GRPC error has no .code"),E.UNKNOWN;switch(e){case xr.OK:return E.OK;case xr.CANCELLED:return E.CANCELLED;case xr.UNKNOWN:return E.UNKNOWN;case xr.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case xr.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case xr.INTERNAL:return E.INTERNAL;case xr.UNAVAILABLE:return E.UNAVAILABLE;case xr.UNAUTHENTICATED:return E.UNAUTHENTICATED;case xr.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case xr.NOT_FOUND:return E.NOT_FOUND;case xr.ALREADY_EXISTS:return E.ALREADY_EXISTS;case xr.PERMISSION_DENIED:return E.PERMISSION_DENIED;case xr.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case xr.ABORTED:return E.ABORTED;case xr.OUT_OF_RANGE:return E.OUT_OF_RANGE;case xr.UNIMPLEMENTED:return E.UNIMPLEMENTED;case xr.DATA_LOSS:return E.DATA_LOSS;default:return b()}}(Tr=xr||(xr={}))[Tr.OK=0]="OK",Tr[Tr.CANCELLED=1]="CANCELLED",Tr[Tr.UNKNOWN=2]="UNKNOWN",Tr[Tr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tr[Tr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tr[Tr.NOT_FOUND=5]="NOT_FOUND",Tr[Tr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tr[Tr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tr[Tr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tr[Tr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tr[Tr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tr[Tr.ABORTED=10]="ABORTED",Tr[Tr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tr[Tr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tr[Tr.INTERNAL=13]="INTERNAL",Tr[Tr.UNAVAILABLE=14]="UNAVAILABLE",Tr[Tr.DATA_LOSS=15]="DATA_LOSS";let Nr=null;const Ar=new a.jz([4294967295,4294967295],0);function Dr(e){const t=L().encode(e),n=new a.VV;return n.update(t),new Uint8Array(n.digest())}function Rr(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new a.jz([n,r],0),new a.jz([i,o],0)]}class Or{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Lr(`Invalid padding: ${t}`);if(n<0)throw new Lr(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Lr(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Lr(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=a.jz.fromNumber(this.Ee)}Ae(e,t,n){let r=e.add(t.multiply(a.jz.fromNumber(n)));return 1===r.compare(Ar)&&(r=new a.jz([r.getBits(0),r.getBits(1)],0)),r.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ee)return!1;const t=Dr(e),[n,r]=Rr(t);for(let e=0;e<this.hashCount;e++){const t=this.Ae(n,r,e);if(!this.Re(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Or(i,r,t);return n.forEach((e=>o.insert(e))),o}insert(e){if(0===this.Ee)return;const t=Dr(e),[n,r]=Rr(t);for(let e=0;e<this.hashCount;e++){const t=this.Ae(n,r,e);this.Ve(t)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Lr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Pr{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Mr.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Pr(B.min(),r,new Be(M),Dn(),Vn())}}class Mr{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Mr(n,t,Vn(),Vn(),Vn())}}class Fr{constructor(e,t,n,r){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=r}}class Ur{constructor(e,t){this.targetId=e,this.ge=t}}class zr{constructor(e,t,n=Je.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Vr{constructor(){this.pe=0,this.ye=$r(),this.we=Je.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return 0!==this.pe}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=Vn(),t=Vn(),n=Vn();return this.ye.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:b()}})),new Mr(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=$r()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,w(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class jr{constructor(e){this.ke=e,this.qe=new Map,this.Qe=Dn(),this.$e=Wr(),this.Ue=Wr(),this.Ke=new Be(M)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,(t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:b()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach(((e,n)=>{this.Je(n)&&t(n)}))}Ze(e){const t=e.targetId,n=e.ge.count,r=this.Xe(t);if(r){const i=r.target;if(dn(i))if(0===n){const e=new Y(i.path);this.ze(t,e,Ft.newNoDocument(e,B.min()))}else w(1===n);else{const r=this.et(t);if(r!==n){const n=this.tt(e),i=n?this.nt(n,e,r):1;if(0!==i){this.Ye(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==Nr||Nr.rt(function(e,t,n,r,i){var o,s,a,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(o=null==h?void 0:h.hashCount)&&void 0!==o?o:0,bitmapLength:null!==(l=null===(a=null===(s=null==h?void 0:h.bits)||void 0===s?void 0:s.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.ge,this.ke.it(),n,i))}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,s;try{o=tt(n).toUint8Array()}catch(e){if(e instanceof Ye)return v("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new Or(o,r,i)}catch(e){return v(e instanceof Lr?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ee?null:s}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.ke.it(),o=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(o)||(this.ze(t,n,null),r++)})),r}ot(e){const t=new Map;this.qe.forEach(((n,r)=>{const i=this.Xe(r);if(i){if(n.current&&dn(i.target)){const t=new Y(i.target.path);this._t(t).has(r)||this.ut(r,t)||this.ze(r,t,Ft.newNoDocument(t,e))}n.ve&&(t.set(r,n.Fe()),n.Me())}}));let n=Vn();this.Ue.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Xe(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.Qe.forEach(((t,n)=>n.setReadTime(e)));const r=new Pr(e,t,this.Ke,this.Qe,n);return this.Qe=Dn(),this.$e=Wr(),this.Ue=Wr(),this.Ke=new Be(M),r}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const r=this.He(e);this.ut(e,t)?r.xe(t,1):r.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new Vr,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new Ke(M),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new Ke(M),this.$e=this.$e.insert(e,t)),t}Je(e){const t=null!==this.Xe(e);return t||m("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Vr),this.ke.getRemoteKeysForTarget(e).forEach((t=>{this.ze(e,t,null)}))}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function Wr(){return new Be(Y.comparator)}function $r(){return new Be(Y.comparator)}const Br={asc:"ASCENDING",desc:"DESCENDING"},qr={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Hr={and:"AND",or:"OR"};class Kr{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gr(e,t){return e.useProto3Json||de(t)?t:{value:t}}function Qr(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Yr(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Jr(e,t){return Qr(e,t.toTimestamp())}function Xr(e){return w(!!e),B.fromTimestamp(function(e){const t=Ze(e);return new $(t.seconds,t.nanos)}(e))}function Zr(e,t){return ei(e,t).canonicalString()}function ei(e,t){const n=function(e){return new K(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function ti(e){const t=K.fromString(e);return w(Si(t)),t}function ni(e,t){return Zr(e.databaseId,t.path)}function ri(e,t){const n=ti(t);if(n.get(1)!==e.databaseId.projectId)throw new k(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new k(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Y(ai(n))}function ii(e,t){return Zr(e.databaseId,t)}function oi(e){const t=ti(e);return 4===t.length?K.emptyPath():ai(t)}function si(e){return new K(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ai(e){return w(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function li(e,t,n){return{name:ni(e,t),fields:n.value.mapValue.fields}}function ci(e,t){let n;if(t instanceof pr)n={update:li(e,t.key,t.value)};else if(t instanceof br)n={delete:ni(e,t.key)};else if(t instanceof mr)n={update:li(e,t.key,t.data),updateMask:wi(t.fieldMask)};else{if(!(t instanceof wr))return b();n={verify:ni(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Yn)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Jn)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Zn)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof tr)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw b()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Jr(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:b()}(e,t.precondition)),n}function ui(e,t){return{documents:[ii(e,t.path)]}}function di(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ii(e,i);const o=function(e){if(0!==e.length)return bi(qt.create(e,"and"))}(t.filters);o&&(n.structuredQuery.where=o);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:vi(e.field),direction:pi(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const a=Gr(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ht:n,parent:i}}function hi(e){let t=oi(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){w(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let o=[];n.where&&(o=function(e){const t=fi(e);return t instanceof qt&&Kt(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new jt(yi(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,de(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Ut(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Ut(n,t)}(n.endAt)),fn(t,i,s,o,a,"F",l,c)}function fi(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=yi(e.unaryFilter.field);return Bt.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=yi(e.unaryFilter.field);return Bt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=yi(e.unaryFilter.field);return Bt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=yi(e.unaryFilter.field);return Bt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return b()}}(e):void 0!==e.fieldFilter?function(e){return Bt.create(yi(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return b()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return qt.create(e.compositeFilter.filters.map((e=>fi(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return b()}}(e.compositeFilter.op))}(e):b()}function pi(e){return Br[e]}function mi(e){return qr[e]}function gi(e){return Hr[e]}function vi(e){return{fieldPath:e.canonicalString()}}function yi(e){return Q.fromServerFormat(e.fieldPath)}function bi(e){return e instanceof Bt?function(e){if("=="===e.op){if(At(e.value))return{unaryFilter:{field:vi(e.field),op:"IS_NAN"}};if(Nt(e.value))return{unaryFilter:{field:vi(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(At(e.value))return{unaryFilter:{field:vi(e.field),op:"IS_NOT_NAN"}};if(Nt(e.value))return{unaryFilter:{field:vi(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vi(e.field),op:mi(e.op),value:e.value}}}(e):e instanceof qt?function(e){const t=e.getFilters().map((e=>bi(e)));return 1===t.length?t[0]:{compositeFilter:{op:gi(e.op),filters:t}}}(e):b()}function wi(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Si(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Ei{constructor(e,t,n,r,i=B.min(),o=B.min(),s=Je.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s,this.expectedCount=a}withSequenceNumber(e){return new Ei(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ei(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ei(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ei(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ki{constructor(e){this.Tt=e}}function _i(e){const t=hi({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Sn(t,t.limit,"L"):t}class xi{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(et(e.integerValue));else if("doubleValue"in e){const n=et(e.doubleValue);isNaN(n)?this.ft(t,13):(this.ft(t,15),he(n)?t.gt(0):t.gt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ft(t,20),"string"==typeof n&&(n=Ze(n)),t.yt(`${n.seconds||""}`),t.gt(n.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(tt(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ft(t,45),t.gt(n.latitude||0),t.gt(n.longitude||0)}else"mapValue"in e?Lt(e)?this.ft(t,Number.MAX_SAFE_INTEGER):Rt(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):b()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){const n=e.fields||{};this.ft(t,55);for(const e of Object.keys(n))this.wt(e,t),this.Rt(n[e],t)}vt(e,t){var n,r;const i=e.fields||{};this.ft(t,53);const o=gt,s=(null===(r=null===(n=i[o].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.ft(t,15),t.gt(et(s)),this.wt(o,t),this.Rt(i[o],t)}Ft(e,t){const n=e.values||[];this.ft(t,50);for(const e of n)this.Rt(e,t)}Dt(e,t){this.ft(t,37),Y.fromName(e).path.forEach((e=>{this.ft(t,60),this.Mt(e,t)}))}ft(e,t){e.gt(t)}St(e){e.gt(2)}}xi.xt=new xi;class Ti{constructor(){this.Tn=new Ii}addToCollectionParentIndex(e,t){return this.Tn.add(t),se.resolve()}getCollectionParents(e,t){return se.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return se.resolve()}deleteFieldIndex(e,t){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,t){return se.resolve()}getDocumentsMatchingTarget(e,t){return se.resolve(null)}getIndexType(e,t){return se.resolve(0)}getFieldIndexes(e,t){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,t){return se.resolve(te.min())}getMinOffsetFromCollectionGroup(e,t){return se.resolve(te.min())}updateCollectionGroup(e,t,n){return se.resolve()}updateIndexEntries(e,t){return se.resolve()}}class Ii{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ke(K.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ke(K.comparator)).toArray()}}new Uint8Array(0);const Ci={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ni=41943040;class Ai{static withCacheSize(e){return new Ai(e,Ai.DEFAULT_COLLECTION_PERCENTILE,Ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}Ai.DEFAULT_COLLECTION_PERCENTILE=10,Ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ai.DEFAULT=new Ai(Ni,Ai.DEFAULT_COLLECTION_PERCENTILE,Ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ai.DISABLED=new Ai(-1,0,0);class Di{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new Di(0)}static Kn(){return new Di(-1)}}const Ri="LruGarbageCollector",Oi=1048576;function Li([e,t],[n,r]){const i=M(e,n);return 0===i?M(t,r):i}class Pi{constructor(e){this.Hn=e,this.buffer=new Ke(Li),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Li(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Mi{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return null!==this.Xn}er(e){m(Ri,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){le(e)?m(Ri,"Ignoring IndexedDB error during garbage collection: ",e):await oe(e)}await this.er(3e5)}))}}class Fi{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return se.resolve(ce.ae);const n=new Pi(t);return this.tr.forEachTarget(e,(e=>n.Zn(e.sequenceNumber))).next((()=>this.tr.rr(e,(e=>n.Zn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(m("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(Ci)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(m("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ci):this.ir(e,t)))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,r,i,s,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(m("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,a=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,l=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),p()<=o.$b.DEBUG&&m("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-u}ms\n\tDetermined least recently used ${r} in `+(a-s)+"ms\n"+`\tRemoved ${i} targets in `+(l-a)+"ms\n"+`\tRemoved ${e} documents in `+(c-l)+"ms\n"+`Total Duration: ${c-u}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function Ui(e,t){return new Fi(e,t)}class zi{constructor(){this.changes=new Nn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ft.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?se.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Vi{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ji{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&dr(n.mutation,e,Qe.empty(),$.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Vn()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Vn()){const r=Pn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=On();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Pn();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Vn())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Dn();const o=Fn(),s=Fn();return t.forEach(((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof mr)?i=i.insert(t.key,t):void 0!==s?(o.set(t.key,s.mutation.getFieldMask()),dr(s.mutation,t,s.mutation.getFieldMask(),$.now())):o.set(t.key,Qe.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>o.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new Vi(t,null!==(n=o.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=Fn();let r=new Be(((e,t)=>e-t)),i=Vn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const o=t.get(e);if(null===o)return;let s=n.get(e)||Qe.empty();s=i.applyToLocalView(o,s),n.set(e,s);const a=(r.get(i.batchId)||Vn()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const o=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),a=r.key,l=r.value,c=Mn();l.forEach((e=>{if(!i.has(e)){const r=cr(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}})),o.push(this.documentOverlayCache.saveOverlays(e,a,c))}return se.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Y.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):gn(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):se.resolve(Pn());let s=J,a=i;return o.next((t=>se.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?se.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Vn()))).next((e=>({batchId:s,changes:Ln(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Y(t)).next((e=>{let t=On();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=On();return this.indexManager.getCollectionParents(e,i).next((s=>se.forEach(s,(s=>{const a=function(e,t){return new hn(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{o=o.insert(e,t)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Ft.newInvalidDocument(r)))}));let n=On();return e.forEach(((e,r)=>{const o=i.get(e);void 0!==o&&dr(o.mutation,r,Qe.empty(),$.now()),xn(t,r)&&(n=n.insert(e,r))})),n}))}}class Wi{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return se.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Xr(e.createTime)}}(t)),se.resolve()}getNamedQuery(e,t){return se.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(e){return{name:e.name,query:_i(e.bundledQuery),readTime:Xr(e.readTime)}}(t)),se.resolve()}}class $i{constructor(){this.overlays=new Be(Y.comparator),this.Rr=new Map}getOverlay(e,t){return se.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Pn();return se.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.Et(e,t,r)})),se.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Rr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Rr.delete(n)),se.resolve()}getOverlaysForCollection(e,t,n){const r=Pn(),i=t.length+1,o=new Y(t.child("")),s=this.overlays.getIteratorFrom(o);for(;s.hasNext();){const e=s.getNext().value,o=e.getKey();if(!t.isPrefixOf(o.path))break;o.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return se.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Be(((e,t)=>e-t));const o=this.overlays.getIterator();for(;o.hasNext();){const e=o.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Pn(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=Pn(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=r)););return se.resolve(s)}Et(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Rr.get(r.largestBatchId).delete(n.key);this.Rr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new kr(t,n));let i=this.Rr.get(t);void 0===i&&(i=Vn(),this.Rr.set(t,i)),this.Rr.set(t,i.add(n.key))}}class Bi{constructor(){this.sessionToken=Je.EMPTY_BYTE_STRING}getSessionToken(e){return se.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,se.resolve()}}class qi{constructor(){this.Vr=new Ke(Hi.mr),this.gr=new Ke(Hi.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new Hi(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.wr(new Hi(e,t))}Sr(e,t){e.forEach((e=>this.removeReference(e,t)))}br(e){const t=new Y(new K([])),n=new Hi(t,e),r=new Hi(t,e+1),i=[];return this.gr.forEachInRange([n,r],(e=>{this.wr(e),i.push(e.key)})),i}Dr(){this.Vr.forEach((e=>this.wr(e)))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new Y(new K([])),n=new Hi(t,e),r=new Hi(t,e+1);let i=Vn();return this.gr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new Hi(e,0),n=this.Vr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Hi{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return Y.comparator(e.key,t.key)||M(e.Cr,t.Cr)}static pr(e,t){return M(e.Cr,t.Cr)||Y.comparator(e.key,t.key)}}class Ki{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new Ke(Hi.mr)}checkEmpty(e){return se.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Sr(i,t,n,r);this.mutationQueue.push(o);for(const t of r)this.Mr=this.Mr.add(new Hi(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return se.resolve(o)}lookupMutationBatch(e,t){return se.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Nr(n),i=r<0?0:r;return se.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(0===this.mutationQueue.length?ue:this.Fr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Hi(t,0),r=new Hi(t,Number.POSITIVE_INFINITY),i=[];return this.Mr.forEachInRange([n,r],(e=>{const t=this.Or(e.Cr);i.push(t)})),se.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ke(M);return t.forEach((e=>{const t=new Hi(e,0),r=new Hi(e,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([t,r],(e=>{n=n.add(e.Cr)}))})),se.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Y.isDocumentKey(i)||(i=i.child(""));const o=new Hi(new Y(i),0);let s=new Ke(M);return this.Mr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.Cr)),!0)}),o),se.resolve(this.Br(s))}Br(e){const t=[];return e.forEach((e=>{const n=this.Or(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){w(0===this.Lr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Mr;return se.forEach(t.mutations,(r=>{const i=new Hi(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Mr=n}))}qn(e){}containsKey(e,t){const n=new Hi(t,0),r=this.Mr.firstAfterOrEqual(n);return se.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Gi{constructor(e){this.kr=e,this.docs=new Be(Y.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return se.resolve(n?n.document.mutableCopy():Ft.newInvalidDocument(t))}getEntries(e,t){let n=Dn();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ft.newInvalidDocument(e))})),se.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Dn();const o=t.path,s=new Y(o.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(s);for(;a.hasNext();){const{key:e,value:{document:s}}=a.getNext();if(!o.isPrefixOf(e.path))break;e.path.length>o.length+1||ne(ee(s),n)<=0||(r.has(s.key)||xn(t,s))&&(i=i.insert(s.key,s.mutableCopy()))}return se.resolve(i)}getAllFromCollectionGroup(e,t,n,r){b()}qr(e,t){return se.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Qi(this)}getSize(e){return se.resolve(this.size)}}class Qi extends zi{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Ir.addEntry(e,r)):this.Ir.removeEntry(n)})),se.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}class Yi{constructor(e){this.persistence=e,this.Qr=new Nn((e=>cn(e)),un),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.$r=0,this.Ur=new qi,this.targetCount=0,this.Kr=Di.Un()}forEachTarget(e,t){return this.Qr.forEach(((e,n)=>t(n))),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),se.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new Di(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,se.resolve()}updateTargetData(e,t){return this.zn(t),se.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Qr.forEach(((o,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Qr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)})),se.waitFor(i).next((()=>r))}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return se.resolve(n)}addMatchingKeys(e,t,n){return this.Ur.yr(t,n),se.resolve()}removeMatchingKeys(e,t,n){this.Ur.Sr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),se.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),se.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ur.vr(t);return se.resolve(n)}containsKey(e,t){return se.resolve(this.Ur.containsKey(t))}}class Ji{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new ce(0),this.zr=!1,this.zr=!0,this.jr=new Bi,this.referenceDelegate=e(this),this.Hr=new Yi(this),this.indexManager=new Ti,this.remoteDocumentCache=function(e){return new Gi(e)}((e=>this.referenceDelegate.Jr(e))),this.serializer=new ki(t),this.Yr=new Wi(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new $i,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new Ki(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){m("MemoryPersistence","Starting transaction:",e);const r=new Xi(this.Gr.next());return this.referenceDelegate.Zr(),n(r).next((e=>this.referenceDelegate.Xr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}ei(e,t){return se.or(Object.values(this.Wr).map((n=>()=>n.containsKey(e,t))))}}class Xi extends ie{constructor(e){super(),this.currentSequenceNumber=e}}class Zi{constructor(e){this.persistence=e,this.ti=new qi,this.ni=null}static ri(e){return new Zi(e)}get ii(){if(this.ni)return this.ni;throw b()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),se.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),se.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),se.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach((e=>this.ii.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.ii.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.ii,(n=>{const r=Y.fromPath(n);return this.si(e,r).next((e=>{e||t.removeEntry(r,B.min())}))})).next((()=>(this.ni=null,t.apply(e))))}updateLimboDocument(e,t){return this.si(e,t).next((e=>{e?this.ii.delete(t.toString()):this.ii.add(t.toString())}))}Jr(e){return 0}si(e,t){return se.or([()=>se.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class eo{constructor(e,t){this.persistence=e,this.oi=new Nn((e=>me(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=Ui(this,t)}static ri(e,t){return new eo(e,t)}Zr(){}Xr(e){return se.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}sr(e){let t=0;return this.rr(e,(e=>{t++})).next((()=>t))}rr(e,t){return se.forEach(this.oi,((n,r)=>this.ar(e,n,r).next((e=>e?se.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.qr(e,(r=>this.ar(e,r,t).next((e=>{e||(n++,i.removeEntry(r,B.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),se.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),se.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),se.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),se.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=xt(e.data.value)),t}ar(e,t,n){return se.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.oi.get(t);return se.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class to{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=r}static Yi(e,t){let n=Vn(),r=Vn();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new to(e,t.fromCache,n,r)}}class no{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class ro{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=(0,s.nr)()?8:ae((0,s.ZQ)())>0?6:4}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.rs(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ss(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new no;return this._s(e,t,n).next((r=>{if(i.result=r,this.Xi)return this.us(e,t,n,r.size)}))})).next((()=>i.result))}us(e,t,n,r){return n.documentReadCount<this.es?(p()<=o.$b.DEBUG&&m("QueryEngine","SDK will not create cache indexes for query:",_n(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),se.resolve()):(p()<=o.$b.DEBUG&&m("QueryEngine","Query:",_n(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ts*r?(p()<=o.$b.DEBUG&&m("QueryEngine","The SDK decides to create cache indexes for query:",_n(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yn(t))):se.resolve())}rs(e,t){if(mn(t))return se.resolve(null);let n=yn(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Sn(t,null,"F"),n=yn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=Vn(...r);return this.ns.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const o=this.cs(t,r);return this.ls(t,o,i,n.readTime)?this.rs(e,Sn(t,null,"F")):this.hs(e,o,t,n)}))))})))))}ss(e,t,n,r){return mn(t)||r.isEqual(B.min())?se.resolve(null):this.ns.getDocuments(e,n).next((i=>{const s=this.cs(t,i);return this.ls(t,s,n,r)?se.resolve(null):(p()<=o.$b.DEBUG&&m("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),_n(t)),this.hs(e,s,t,Z(r,J)).next((e=>e)))}))}cs(e,t){let n=new Ke(In(e));return t.forEach(((t,r)=>{xn(e,r)&&(n=n.add(r))})),n}ls(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}_s(e,t,n){return p()<=o.$b.DEBUG&&m("QueryEngine","Using full collection scan to execute query:",_n(t)),this.ns.getDocumentsMatchingQuery(e,t,te.min(),n)}hs(e,t,n,r){return this.ns.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}const io="LocalStore",oo=3e8;class so{constructor(e,t,n,r){this.persistence=e,this.Ps=t,this.serializer=r,this.Ts=new Be(M),this.Is=new Nn((e=>cn(e)),un),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ji(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ts)))}}function ao(e,t,n,r){return new so(e,t,n,r)}async function lo(e,t){const n=S(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.As(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],o=[];let s=Vn();for(const e of r){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){o.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({Rs:e,removedBatchIds:i,addedBatchIds:o})))}))}))}function co(e){const t=S(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Hr.getLastRemoteSnapshotVersion(e)))}function uo(e,t,n){let r=Vn(),i=Vn();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Dn();return n.forEach(((n,o)=>{const s=e.get(n);o.isFoundDocument()!==s.isFoundDocument()&&(i=i.add(n)),o.isNoDocument()&&o.version.isEqual(B.min())?(t.removeEntry(n,o.readTime),r=r.insert(n,o)):!s.isValidDocument()||o.version.compareTo(s.version)>0||0===o.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(o),r=r.insert(n,o)):m(io,"Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)})),{Vs:r,fs:i}}))}function ho(e,t){const n=S(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=ue),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function fo(e,t){const n=S(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Hr.getTargetData(e,t).next((i=>i?(r=i,se.resolve(r)):n.Hr.allocateTargetId(e).next((i=>(r=new Ei(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Hr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ts.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(e.targetId,e),n.Is.set(t,e.targetId)),e}))}async function po(e,t,n){const r=S(e),i=r.Ts.get(t),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!le(e))throw e;m(io,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ts=r.Ts.remove(t),r.Is.delete(i.target)}function mo(e,t,n){const r=S(e);let i=B.min(),o=Vn();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=S(e),i=r.Is.get(n);return void 0!==i?se.resolve(r.Ts.get(i)):r.Hr.getTargetData(t,n)}(r,e,yn(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Hr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{o=e}))})).next((()=>r.Ps.getDocumentsMatchingQuery(e,t,n?i:B.min(),n?o:Vn()))).next((e=>(go(r,Tn(t),e),{documents:e,gs:o})))))}function go(e,t,n){let r=e.Es.get(t)||B.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Es.set(t,r)}class vo{constructor(){this.activeTargetIds=Wn()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yo{constructor(){this.ho=new vo,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new vo,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class bo{To(e){}shutdown(){}}const wo="ConnectivityMonitor";class So{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){m(wo,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){m(wo,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Eo=null;function ko(){return null===Eo?Eo=268435456+Math.round(2147483648*Math.random()):Eo++,"0x"+Eo.toString(16)}const _o="RestConnection",xo={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class To{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${r}`,this.wo=this.databaseId.database===ut?`project_id=${n}`:`project_id=${n}&database_id=${r}`}So(e,t,n,r,i){const o=ko(),s=this.bo(e,t.toUriEncodedString());m(_o,`Sending RPC '${e}' ${o}:`,s,n);const a={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(a,r,i),this.vo(e,s,a,n).then((t=>(m(_o,`Received RPC '${e}' ${o}: `,t),t)),(t=>{throw v(_o,`RPC '${e}' ${o} failed with error: `,t,"url: ",s,"request:",n),t}))}Co(e,t,n,r,i,o){return this.So(e,t,n,r,i)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+h,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=xo[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}class Io{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}const Co="WebChannelConnection";class No extends To{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,r){const i=ko();return new Promise(((o,s)=>{const a=new l.ZS;a.setWithCredentials(!0),a.listenOnce(l.Bx.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case l.O4.NO_ERROR:const t=a.getResponseJson();m(Co,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),o(t);break;case l.O4.TIMEOUT:m(Co,`RPC '${e}' ${i} timed out`),s(new k(E.DEADLINE_EXCEEDED,"Request time out"));break;case l.O4.HTTP_ERROR:const n=a.getStatus();if(m(Co,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(E).indexOf(t)>=0?t:E.UNKNOWN}(t.status);s(new k(e,t.message))}else s(new k(E.UNKNOWN,"Server responded with status "+a.getStatus()))}else s(new k(E.UNAVAILABLE,"Connection failed."));break;default:b()}}finally{m(Co,`RPC '${e}' ${i} completed.`)}}));const c=JSON.stringify(r);m(Co,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",c,n,15)}))}Wo(e,t,n){const r=ko(),i=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=(0,l.fF)(),s=(0,l.Ao)(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=i.join("");m(Co,`Creating RPC '${e}' stream ${r}: ${u}`,a);const d=o.createWebChannel(u,a);let h=!1,f=!1;const p=new Io({Fo:t=>{f?m(Co,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(m(Co,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),m(Co,`RPC '${e}' stream ${r} sending:`,t),d.send(t))},Mo:()=>d.close()}),g=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return g(d,l.iO.EventType.OPEN,(()=>{f||(m(Co,`RPC '${e}' stream ${r} transport opened.`),p.Qo())})),g(d,l.iO.EventType.CLOSE,(()=>{f||(f=!0,m(Co,`RPC '${e}' stream ${r} transport closed`),p.Uo())})),g(d,l.iO.EventType.ERROR,(t=>{f||(f=!0,v(Co,`RPC '${e}' stream ${r} transport errored:`,t),p.Uo(new k(E.UNAVAILABLE,"The operation could not be completed")))})),g(d,l.iO.EventType.MESSAGE,(t=>{var n;if(!f){const i=t.data[0];w(!!i);const o=i,s=(null==o?void 0:o.error)||(null===(n=o[0])||void 0===n?void 0:n.error);if(s){m(Co,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=xr[e];if(void 0!==t)return Cr(t)}(t),i=s.message;void 0===n&&(n=E.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),f=!0,p.Uo(new k(n,i)),d.close()}else m(Co,`RPC '${e}' stream ${r} received:`,i),p.Ko(i)}})),g(s,l.Jh.STAT_EVENT,(t=>{t.stat===l.ro.PROXY?m(Co,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===l.ro.NOPROXY&&m(Co,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.$o()}),0),p}}function Ao(){return"undefined"!=typeof document?document:null}function Do(e){return new Kr(e,!0)}class Ro{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=r,this.jo=i,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),r=Math.max(0,t-n);r>0&&m("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,r,(()=>(this.Yo=Date.now(),e()))),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){null!==this.Jo&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){null!==this.Jo&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}const Oo="PersistentStream";class Lo{constructor(e,t,n,r,i,o,s,a){this.Ti=e,this.n_=n,this.r_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=a,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new Ro(e,t)}u_(){return 1===this.state||5===this.state||this.c_()}c_(){return 2===this.state||3===this.state}start(){this.__=0,4!==this.state?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&null===this.s_&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,(()=>this.T_())))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,4!==e?this.a_.reset():t&&t.code===E.RESOURCE_EXHAUSTED?(g(t.toString()),g("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===E.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.i_===t&&this.V_(e,n)}),(t=>{e((()=>{const e=new k(E.UNKNOWN,"Fetching auth token failed: "+t.message);return this.m_(e)}))}))}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo((()=>{n((()=>this.listener.xo()))})),this.stream.No((()=>{n((()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,(()=>(this.c_()&&(this.state=3),Promise.resolve()))),this.listener.No())))})),this.stream.Lo((e=>{n((()=>this.m_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.__?this.g_(e):this.onNext(e)))}))}l_(){this.state=5,this.a_.Xo((async()=>{this.state=0,this.start()}))}m_(e){return m(Oo,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget((()=>this.i_===e?t():(m(Oo,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Po extends Lo{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:b()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(w(void 0===t||"string"==typeof t),Je.fromBase64String(t||"")):(w(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Je.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&function(e){const t=void 0===e.code?E.UNKNOWN:Cr(e.code);return new k(t,e.message||"")}(s);n=new zr(r,i,o,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=ri(e,r.document.name),o=Xr(r.document.updateTime),s=r.document.createTime?Xr(r.document.createTime):B.min(),a=new Pt({mapValue:{fields:r.document.fields}}),l=Ft.newFoundDocument(i,o,s,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Fr(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=ri(e,r.document),o=r.readTime?Xr(r.readTime):B.min(),s=Ft.newNoDocument(i,o),a=r.removedTargetIds||[];n=new Fr([],a,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=ri(e,r.document),o=r.removedTargetIds||[];n=new Fr([],o,i,null)}else{if(!("filter"in t))return b();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,o=new _r(r,i),s=e.targetId;n=new Ur(s,o)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return B.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?B.min():t.readTime?Xr(t.readTime):B.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=si(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=dn(r)?{documents:ui(e,r)}:{query:di(e,r).ht},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Yr(e,t.resumeToken);const r=Gr(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(B.min())>0){n.readTime=Qr(e,t.snapshotVersion.toTimestamp());const r=Gr(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return b()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=si(this.serializer),t.removeTarget=e,this.I_(t)}}class Mo extends Lo{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return w(!!e.streamToken),this.lastStreamToken=e.streamToken,w(!e.writeResults||0===e.writeResults.length),this.listener.D_()}onNext(e){w(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=function(e,t){return e&&e.length>0?(w(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Xr(e.updateTime):Xr(t);return n.isEqual(B.min())&&(n=Xr(t)),new or(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Xr(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=si(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>ci(this.serializer,e)))};this.I_(t)}}class Fo{}class Uo extends Fo{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.F_=!1}M_(){if(this.F_)throw new k(E.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.So(e,ei(t,n),r,i,o))).catch((e=>{throw"FirebaseError"===e.name?(e.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new k(E.UNKNOWN,e.toString())}))}Co(e,t,n,r,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,s])=>this.connection.Co(e,ei(t,n),r,o,s,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new k(E.UNKNOWN,e.toString())}))}terminate(){this.F_=!0,this.connection.terminate()}}class zo{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){0===this.x_&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve()))))}q_(e){"Online"===this.state?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,"Online"===e&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(g(t),this.N_=!1):m("OnlineStateTracker",t)}Q_(){null!==this.O_&&(this.O_.cancel(),this.O_=null)}}const Vo="RemoteStore";class jo{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=i,this.z_.To((e=>{n.enqueueAndForget((async()=>{Yo(this)&&(m(Vo,"Restarting streams for network reachability change."),await async function(e){const t=S(e);t.W_.add(4),await $o(t),t.j_.set("Unknown"),t.W_.delete(4),await Wo(t)}(this))}))})),this.j_=new zo(n,r)}}async function Wo(e){if(Yo(e))for(const t of e.G_)await t(!0)}async function $o(e){for(const t of e.G_)await t(!1)}function Bo(e,t){const n=S(e);n.K_.has(t.targetId)||(n.K_.set(t.targetId,t),Qo(n)?Go(n):ms(n).c_()&&Ho(n,t))}function qo(e,t){const n=S(e),r=ms(n);n.K_.delete(t),r.c_()&&Ko(n,t),0===n.K_.size&&(r.c_()?r.P_():Yo(n)&&n.j_.set("Unknown"))}function Ho(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(B.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}ms(e).y_(t)}function Ko(e,t){e.H_.Ne(t),ms(e).w_(t)}function Go(e){e.H_=new jr({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.K_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),ms(e).start(),e.j_.B_()}function Qo(e){return Yo(e)&&!ms(e).u_()&&e.K_.size>0}function Yo(e){return 0===S(e).W_.size}function Jo(e){e.H_=void 0}async function Xo(e){e.j_.set("Online")}async function Zo(e){e.K_.forEach(((t,n)=>{Ho(e,t)}))}async function es(e,t){Jo(e),Qo(e)?(e.j_.q_(t),Go(e)):e.j_.set("Unknown")}async function ts(e,t,n){if(e.j_.set("Online"),t instanceof zr&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.K_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.K_.delete(r),e.H_.removeTarget(r))}(e,t)}catch(n){m(Vo,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await ns(e,n)}else if(t instanceof Fr?e.H_.We(t):t instanceof Ur?e.H_.Ze(t):e.H_.je(t),!n.isEqual(B.min()))try{const t=await co(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.H_.ot(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.K_.get(r);i&&e.K_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.K_.get(t);if(!r)return;e.K_.set(t,r.withResumeToken(Je.EMPTY_BYTE_STRING,r.snapshotVersion)),Ko(e,t);const i=new Ei(r.target,t,n,r.sequenceNumber);Ho(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){m(Vo,"Failed to raise snapshot:",t),await ns(e,t)}}async function ns(e,t,n){if(!le(t))throw t;e.W_.add(1),await $o(e),e.j_.set("Offline"),n||(n=()=>co(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{m(Vo,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await Wo(e)}))}function rs(e,t){return t().catch((n=>ns(e,n,t)))}async function is(e){const t=S(e),n=gs(t);let r=t.U_.length>0?t.U_[t.U_.length-1].batchId:ue;for(;os(t);)try{const e=await ho(t.localStore,r);if(null===e){0===t.U_.length&&n.P_();break}r=e.batchId,ss(t,e)}catch(e){await ns(t,e)}as(t)&&ls(t)}function os(e){return Yo(e)&&e.U_.length<10}function ss(e,t){e.U_.push(t);const n=gs(e);n.c_()&&n.S_&&n.b_(t.mutations)}function as(e){return Yo(e)&&!gs(e).u_()&&e.U_.length>0}function ls(e){gs(e).start()}async function cs(e){gs(e).C_()}async function us(e){const t=gs(e);for(const n of e.U_)t.b_(n.mutations)}async function ds(e,t,n){const r=e.U_.shift(),i=Er.from(r,t,n);await rs(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await is(e)}async function hs(e,t){t&&gs(e).S_&&await async function(e,t){if(function(e){return Ir(e)&&e!==E.ABORTED}(t.code)){const n=e.U_.shift();gs(e).h_(),await rs(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await is(e)}}(e,t),as(e)&&ls(e)}async function fs(e,t){const n=S(e);n.asyncQueue.verifyOperationInProgress(),m(Vo,"RemoteStore received new credentials");const r=Yo(n);n.W_.add(3),await $o(n),r&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await Wo(n)}async function ps(e,t){const n=S(e);t?(n.W_.delete(2),await Wo(n)):t||(n.W_.add(2),await $o(n),n.j_.set("Unknown"))}function ms(e){return e.J_||(e.J_=function(e,t,n){const r=S(e);return r.M_(),new Po(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{xo:Xo.bind(null,e),No:Zo.bind(null,e),Lo:es.bind(null,e),p_:ts.bind(null,e)}),e.G_.push((async t=>{t?(e.J_.h_(),Qo(e)?Go(e):e.j_.set("Unknown")):(await e.J_.stop(),Jo(e))}))),e.J_}function gs(e){return e.Y_||(e.Y_=function(e,t,n){const r=S(e);return r.M_(),new Mo(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{xo:()=>Promise.resolve(),No:cs.bind(null,e),Lo:hs.bind(null,e),D_:us.bind(null,e),v_:ds.bind(null,e)}),e.G_.push((async t=>{t?(e.Y_.h_(),await is(e)):(await e.Y_.stop(),e.U_.length>0&&(m(Vo,`Stopping write stream with ${e.U_.length} pending writes`),e.U_=[]))}))),e.Y_}class vs{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new _,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,s=new vs(e,t,o,r,i);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new k(E.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ys(e,t){if(g("AsyncQueue",`${t}: ${e}`),le(e))return new k(E.UNAVAILABLE,`${t}: ${e}`);throw e}class bs{static emptySet(e){return new bs(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Y.comparator(t.key,n.key):(e,t)=>Y.comparator(e.key,t.key),this.keyedMap=On(),this.sortedSet=new Be(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof bs))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new bs;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class ws{constructor(){this.Z_=new Be(Y.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?0!==e.type&&3===n.type?this.Z_=this.Z_.insert(t,e):3===e.type&&1!==n.type?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Z_=this.Z_.remove(t):1===e.type&&2===n.type?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):b():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Ss{constructor(e,t,n,r,i,o,s,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach((e=>{o.push({type:0,doc:e})})),new Ss(e,t,bs.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&En(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class Es{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some((e=>e.ra()))}}class ks{constructor(){this.queries=_s(),this.onlineState="Unknown",this.ia=new Set}terminate(){!function(e,t){const n=S(e),r=n.queries;n.queries=_s(),r.forEach(((e,n)=>{for(const e of n.ta)e.onError(t)}))}(this,new k(E.ABORTED,"Firestore shutting down"))}}function _s(){return new Nn((e=>kn(e)),En)}async function xs(e,t){const n=S(e);let r=3;const i=t.query;let o=n.queries.get(i);o?!o.na()&&t.ra()&&(r=2):(o=new Es,r=t.ra()?0:1);try{switch(r){case 0:o.ea=await n.onListen(i,!0);break;case 1:o.ea=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=ys(e,`Initialization of query '${_n(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,o),o.ta.push(t),t.sa(n.onlineState),o.ea&&t.oa(o.ea)&&Ns(n)}async function Ts(e,t){const n=S(e),r=t.query;let i=3;const o=n.queries.get(r);if(o){const e=o.ta.indexOf(t);e>=0&&(o.ta.splice(e,1),0===o.ta.length?i=t.ra()?0:1:!o.na()&&t.ra()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Is(e,t){const n=S(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.ta)t.oa(e)&&(r=!0);i.ea=e}}r&&Ns(n)}function Cs(e,t,n){const r=S(e),i=r.queries.get(t);if(i)for(const e of i.ta)e.onError(n);r.queries.delete(t)}function Ns(e){e.ia.forEach((e=>{e.next()}))}var As,Ds;(Ds=As||(As={}))._a="default",Ds.Cache="cache";class Rs{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Ss(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache)return!0;if(!this.ra())return!0;const n="Offline"!==t;return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Pa(e){e=Ss.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==As.Cache}}class Os{constructor(e){this.key=e}}class Ls{constructor(e){this.key=e}}class Ps{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Vn(),this.mutatedKeys=Vn(),this.ya=In(e),this.wa=new bs(this.ya)}get Sa(){return this.fa}ba(e,t){const n=t?t.Da:new ws,r=t?t.wa:this.wa;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,s=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=xn(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.va(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.ya(u,a)>0||l&&this.ya(u,l)<0)&&(s=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(s=!0)),f&&(u?(o=o.add(u),i=h?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){const e="F"===this.query.limitType?o.last():o.first();o=o.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{wa:o,Da:n,ls:s,mutatedKeys:i}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const o=e.Da.X_();o.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return b()}};return n(e)-n(t)}(e.type,t.type)||this.ya(e.doc,t.doc))),this.Ca(n),r=null!=r&&r;const s=t&&!r?this.Fa():[],a=0===this.pa.size&&this.current&&!r?1:0,l=a!==this.ga;return this.ga=a,0!==o.length||l?{snapshot:new Ss(this.query,e.wa,i,o,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:s}:{Ma:s}}sa(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({wa:this.wa,Da:new ws,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach((e=>this.fa=this.fa.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.fa=this.fa.delete(e))),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=Vn(),this.wa.forEach((e=>{this.xa(e.key)&&(this.pa=this.pa.add(e.key))}));const t=[];return e.forEach((e=>{this.pa.has(e)||t.push(new Ls(e))})),this.pa.forEach((n=>{e.has(n)||t.push(new Os(n))})),t}Oa(e){this.fa=e.gs,this.pa=Vn();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return Ss.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,0===this.ga,this.hasCachedResults)}}const Ms="SyncEngine";class Fs{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Us{constructor(e){this.key=e,this.Ba=!1}}class zs{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new Nn((e=>kn(e)),En),this.qa=new Map,this.Qa=new Set,this.$a=new Be(Y.comparator),this.Ua=new Map,this.Ka=new qi,this.Wa={},this.Ga=new Map,this.za=Di.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return!0===this.ja}}async function Vs(e,t,n=!0){const r=aa(e);let i;const o=r.ka.get(t);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Na()):i=await Ws(r,t,n,!0),i}async function js(e,t){const n=aa(e);await Ws(n,t,!0,!1)}async function Ws(e,t,n,r){const i=await fo(e.localStore,yn(t)),o=i.targetId,s=e.sharedClientState.addLocalQueryTarget(o,n);let a;return r&&(a=await $s(e,t,o,"current"===s,i.resumeToken)),e.isPrimaryClient&&n&&Bo(e.remoteStore,i),a}async function $s(e,t,n,r,i){e.Ha=(t,n,r)=>async function(e,t,n,r){let i=t.view.ba(n);i.ls&&(i=await mo(e.localStore,t.query,!1).then((({documents:e})=>t.view.ba(e,i))));const o=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,o,s);return ta(e,t.targetId,a.Ma),a.snapshot}(e,t,n,r);const o=await mo(e.localStore,t,!0),s=new Ps(t,o.gs),a=s.ba(o.documents),l=Mr.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=s.applyChanges(a,e.isPrimaryClient,l);ta(e,n,c.Ma);const u=new Fs(t,n,s);return e.ka.set(t,u),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),c.snapshot}async function Bs(e,t,n){const r=S(e),i=r.ka.get(t),o=r.qa.get(i.targetId);if(o.length>1)return r.qa.set(i.targetId,o.filter((e=>!En(e,t)))),void r.ka.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await po(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&qo(r.remoteStore,i.targetId),Zs(r,i.targetId)})).catch(oe)):(Zs(r,i.targetId),await po(r.localStore,i.targetId,!0))}async function qs(e,t){const n=S(e),r=n.ka.get(t),i=n.qa.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),qo(n.remoteStore,r.targetId))}async function Hs(e,t){const n=S(e);try{const e=await function(e,t){const n=S(e),r=t.snapshotVersion;let i=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const o=n.ds.newChangeBuffer({trackRemovals:!0});i=n.Ts;const s=[];t.targetChanges.forEach(((o,a)=>{const l=i.get(a);if(!l)return;s.push(n.Hr.removeMatchingKeys(e,o.removedDocuments,a).next((()=>n.Hr.addMatchingKeys(e,o.addedDocuments,a))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(Je.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):o.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(o.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=oo||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,o)&&s.push(n.Hr.updateTargetData(e,c))}));let a=Dn(),l=Vn();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),s.push(uo(e,o,t.documentUpdates).next((e=>{a=e.Vs,l=e.fs}))),!r.isEqual(B.min())){const t=n.Hr.getLastRemoteSnapshotVersion(e).next((t=>n.Hr.setTargetsMetadata(e,e.currentSequenceNumber,r)));s.push(t)}return se.waitFor(s).next((()=>o.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,l))).next((()=>a))})).then((e=>(n.Ts=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Ua.get(t);r&&(w(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Ba=!0:e.modifiedDocuments.size>0?w(r.Ba):e.removedDocuments.size>0&&(w(r.Ba),r.Ba=!1))})),await ia(n,e,t)}catch(e){await oe(e)}}function Ks(e,t,n){const r=S(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ka.forEach(((n,r)=>{const i=r.view.sa(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=S(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.ta)e.sa(t)&&(r=!0)})),r&&Ns(n)}(r.eventManager,t),e.length&&r.La.p_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Gs(e,t,n){const r=S(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Ua.get(t),o=i&&i.key;if(o){let e=new Be(Y.comparator);e=e.insert(o,Ft.newNoDocument(o,B.min()));const n=Vn().add(o),i=new Pr(B.min(),new Map,new Be(M),e,n);await Hs(r,i),r.$a=r.$a.remove(o),r.Ua.delete(t),ra(r)}else await po(r.localStore,t,!1).then((()=>Zs(r,t,n))).catch(oe)}async function Qs(e,t){const n=S(e),r=t.batch.batchId;try{const e=await function(e,t){const n=S(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.ds.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,o=i.keys();let s=se.resolve();return o.forEach((e=>{s=s.next((()=>r.getEntry(t,e))).next((t=>{const o=n.docVersions.get(e);w(null!==o),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Vn();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Xs(n,r,null),Js(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ia(n,e)}catch(e){await oe(e)}}async function Ys(e,t,n){const r=S(e);try{const e=await function(e,t){const n=S(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(w(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Xs(r,t,n),Js(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await ia(r,e)}catch(n){await oe(n)}}function Js(e,t){(e.Ga.get(t)||[]).forEach((e=>{e.resolve()})),e.Ga.delete(t)}function Xs(e,t,n){const r=S(e);let i=r.Wa[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Wa[r.currentUser.toKey()]=i}}function Zs(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.qa.get(t))e.ka.delete(r),n&&e.La.Ja(r,n);e.qa.delete(t),e.isPrimaryClient&&e.Ka.br(t).forEach((t=>{e.Ka.containsKey(t)||ea(e,t)}))}function ea(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);null!==n&&(qo(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ua.delete(n),ra(e))}function ta(e,t,n){for(const r of n)r instanceof Os?(e.Ka.addReference(r.key,t),na(e,r)):r instanceof Ls?(m(Ms,"Document no longer in limbo: "+r.key),e.Ka.removeReference(r.key,t),e.Ka.containsKey(r.key)||ea(e,r.key)):b()}function na(e,t){const n=t.key,r=n.path.canonicalString();e.$a.get(n)||e.Qa.has(r)||(m(Ms,"New document in limbo: "+n),e.Qa.add(r),ra(e))}function ra(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new Y(K.fromString(t)),r=e.za.next();e.Ua.set(r,new Us(n)),e.$a=e.$a.insert(n,r),Bo(e.remoteStore,new Ei(yn(pn(n.path)),r,"TargetPurposeLimboResolution",ce.ae))}}async function ia(e,t,n){const r=S(e),i=[],o=[],s=[];r.ka.isEmpty()||(r.ka.forEach(((e,a)=>{s.push(r.Ha(a,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=to.Yi(a.targetId,e);o.push(t)}})))})),await Promise.all(s),r.La.p_(i),await async function(e,t){const n=S(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>se.forEach(t,(t=>se.forEach(t.Hi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>se.forEach(t.Ji,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!le(e))throw e;m(io,"Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ts.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Ts=n.Ts.insert(t,i)}}}(r.localStore,o))}async function oa(e,t){const n=S(e);if(!n.currentUser.isEqual(t)){m(Ms,"User change. New user:",t.toKey());const e=await lo(n.localStore,t);n.currentUser=t,function(e,t){e.Ga.forEach((e=>{e.forEach((e=>{e.reject(new k(E.CANCELLED,t))}))})),e.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await ia(n,e.Rs)}}function sa(e,t){const n=S(e),r=n.Ua.get(t);if(r&&r.Ba)return Vn().add(r.key);{let e=Vn();const r=n.qa.get(t);if(!r)return e;for(const t of r){const r=n.ka.get(t);e=e.unionWith(r.view.Sa)}return e}}function aa(e){const t=S(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Hs.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=sa.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Gs.bind(null,t),t.La.p_=Is.bind(null,t.eventManager),t.La.Ja=Cs.bind(null,t.eventManager),t}function la(e){const t=S(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Qs.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ys.bind(null,t),t}class ca{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Do(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return ao(this.persistence,new ro,e.initialUser,this.serializer)}Xa(e){return new Ji(Zi.ri,this.serializer)}Za(e){return new yo}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ca.provider={build:()=>new ca};class ua extends ca{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){w(this.persistence.referenceDelegate instanceof eo);const n=this.persistence.referenceDelegate.garbageCollector;return new Mi(n,e.asyncQueue,t)}Xa(e){const t=void 0!==this.cacheSizeBytes?Ai.withCacheSize(this.cacheSizeBytes):Ai.DEFAULT;return new Ji((e=>eo.ri(e,t)),this.serializer)}}class da{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Ks(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=oa.bind(null,this.syncEngine),await ps(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new ks}createDatastore(e){const t=Do(e.databaseInfo.databaseId),n=function(e){return new No(e)}(e.databaseInfo);return function(e,t,n,r){return new Uo(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new jo(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>Ks(this.syncEngine,e,0)),So.D()?new So:new bo)}createSyncEngine(e,t){return function(e,t,n,r,i,o,s){const a=new zs(e,t,n,r,i,o);return s&&(a.ja=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=S(e);m(Vo,"RemoteStore shutting down."),t.W_.add(5),await $o(t),t.z_.shutdown(),t.j_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}da.provider={build:()=>new da};class ha{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):g("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const fa="FirestoreClient";class pa{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=d.UNAUTHENTICATED,this.clientId=P.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{m(fa,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(m(fa,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=ys(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function ma(e,t){e.asyncQueue.verifyOperationInProgress(),m(fa,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await lo(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function ga(e,t){e.asyncQueue.verifyOperationInProgress();const n=await va(e);m(fa,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>fs(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>fs(t.remoteStore,n))),e._onlineComponents=t}async function va(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){m(fa,"Using user provided OfflineComponentProvider");try{await ma(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===E.FAILED_PRECONDITION||e.code===E.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;v("Error using user provided cache. Falling back to memory cache: "+n),await ma(e,new ca)}}else m(fa,"Using default OfflineComponentProvider"),await ma(e,new ua(void 0));return e._offlineComponents}async function ya(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(m(fa,"Using user provided OnlineComponentProvider"),await ga(e,e._uninitializedComponentsProvider._online)):(m(fa,"Using default OnlineComponentProvider"),await ga(e,new da))),e._onlineComponents}function ba(e){return ya(e).then((e=>e.syncEngine))}async function wa(e){const t=await ya(e),n=t.eventManager;return n.onListen=Vs.bind(null,t.syncEngine),n.onUnlisten=Bs.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=js.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=qs.bind(null,t.syncEngine),n}function Sa(e,t,n={}){const r=new _;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const o=new ha({next:a=>{o.su(),t.enqueueAndForget((()=>Ts(e,s)));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new k(E.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new k(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),s=new Rs(pn(n.path),o,{includeMetadataChanges:!0,Ta:!0});return xs(e,s)}(await wa(e),e.asyncQueue,t,n,r))),r.promise}function Ea(e,t,n={}){const r=new _;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const o=new ha({next:n=>{o.su(),t.enqueueAndForget((()=>Ts(e,s))),n.fromCache&&"server"===r.source?i.reject(new k(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),s=new Rs(n,o,{includeMetadataChanges:!0,Ta:!0});return xs(e,s)}(await wa(e),e.asyncQueue,t,n,r))),r.promise}function ka(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const _a=new Map;function xa(e,t,n){if(!n)throw new k(E.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Ta(e){if(!Y.isDocumentKey(e))throw new k(E.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Ia(e){if(Y.isDocumentKey(e))throw new k(E.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Ca(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":b()}function Na(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new k(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ca(e);throw new k(E.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}const Aa="firestore.googleapis.com",Da=!0;class Ra{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new k(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Aa,this.ssl=Da}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Da;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Ni;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Oi)throw new k(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new k(E.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ka(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new k(E.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new k(E.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new k(E.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Oa{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ra({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new k(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new k(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ra(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new T;switch(e.type){case"firstParty":return new A(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new k(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=_a.get(e);t&&(m("ComponentProvider","Removing Datastore"),_a.delete(e),t.terminate())}(this),Promise.resolve()}}class La{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new La(this.firestore,e,this._query)}}class Pa{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ma(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pa(this.firestore,e,this._key)}}class Ma extends La{constructor(e,t,n){super(e,t,pn(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pa(this.firestore,null,new Y(e))}withConverter(e){return new Ma(this.firestore,e,this._path)}}function Fa(e,t,...n){if(e=(0,s.Ku)(e),xa("collection","path",t),e instanceof Oa){const r=K.fromString(t,...n);return Ia(r),new Ma(e,null,r)}{if(!(e instanceof Pa||e instanceof Ma))throw new k(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(K.fromString(t,...n));return Ia(r),new Ma(e.firestore,null,r)}}function Ua(e,t,...n){if(e=(0,s.Ku)(e),1===arguments.length&&(t=P.newId()),xa("doc","path",t),e instanceof Oa){const r=K.fromString(t,...n);return Ta(r),new Pa(e,null,new Y(r))}{if(!(e instanceof Pa||e instanceof Ma))throw new k(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(K.fromString(t,...n));return Ta(r),new Pa(e.firestore,e instanceof Ma?e.converter:null,new Y(r))}}const za="AsyncQueue";class Va{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new Ro(this,"async_queue_retry"),this.Su=()=>{const e=Ao();e&&m(za,"Visibility state changed to "+e.visibilityState),this.a_.t_()},this.bu=e;const t=Ao();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=Ao();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise((()=>{}));const t=new _;return this.vu((()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Vu.push(e),this.Cu())))}async Cu(){if(0!==this.Vu.length){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!le(e))throw e;m(za,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo((()=>this.Cu()))}}vu(e){const t=this.bu.then((()=>(this.pu=!0,e().catch((e=>{this.gu=e,this.pu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw g("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.pu=!1,e))))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const r=vs.createAndSchedule(this,e,t,n,(e=>this.Fu(e)));return this.fu.push(r),r}Du(){this.gu&&b()}verifyOperationInProgress(){}async Mu(){let e;do{e=this.bu,await e}while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then((()=>{this.fu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.fu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Mu()}))}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function ja(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(e,["next","error","complete"])}class Wa extends Oa{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Va,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Va(e),this._firestoreClient=void 0,await e}}}function $a(e,t){const n="object"==typeof e?e:(0,r.Sx)(),i="string"==typeof e?e:t||ut,o=(0,r.j6)(n,"firestore").getImmediate({identifier:i});if(!o._initialized){const e=(0,s.yU)("firestore");e&&function(e,t,n,r={}){var i;const o=(e=Na(e,Oa))._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${n}`;o.host!==Aa&&o.host!==l&&v("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:l,ssl:!1,emulatorOptions:r});if(!(0,s.bD)(c,a)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=d.MOCK_USER;else{t=(0,s.Fy)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new k(E.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new d(o)}e._authCredentials=new I(new x(t,n))}}(o,...e)}return o}function Ba(e){if(e._terminated)throw new k(E.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||qa(e),e._firestoreClient}function qa(e){var t,n,r;const i=e._freezeSettings(),o=function(e,t,n,r){return new ct(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,ka(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new pa(e._authCredentials,e._appCheckCredentials,e._queue,o,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class Ha{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ha(Je.fromBase64String(e))}catch(e){throw new k(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Ha(Je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Ka{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new k(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Q(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Ga(){return new Ka(q)}class Qa{constructor(e){this._methodName=e}}class Ya{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return M(this._lat,e._lat)||M(this._long,e._long)}}class Ja{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Xa=/^__.*__$/;class Za{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new mr(e,this.data,this.fieldMask,t,this.fieldTransforms):new pr(e,this.data,t,this.fieldTransforms)}}class el{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new mr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function tl(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw b()}}class nl{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Bu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new nl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.$u(e),r}Uu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.Bu(),r}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return El(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(0===e.length)throw this.Wu("Document fields must not be empty");if(tl(this.Lu)&&Xa.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class rl{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Do(e)}ju(e,t,n,r=!1){return new nl({Lu:e,methodName:t,zu:n,path:Q.emptyPath(),Qu:!1,Gu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function il(e){const t=e._freezeSettings(),n=Do(e._databaseId);return new rl(e._databaseId,!!t.ignoreUndefinedProperties,n)}function ol(e,t,n,r,i,o={}){const s=e.ju(o.merge||o.mergeFields?2:0,t,n,i);yl("Data must be an object, but it was:",s,r);const a=gl(r,s);let l,c;if(o.merge)l=new Qe(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){const e=[];for(const r of o.mergeFields){const i=bl(t,r,n);if(!s.contains(i))throw new k(E.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);kl(e,i)||e.push(i)}l=new Qe(e),c=s.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=s.fieldTransforms;return new Za(new Pt(a),l,c)}class sl extends Qa{_toFieldTransform(e){if(2!==e.Lu)throw 1===e.Lu?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sl}}function al(e,t,n){return new nl({Lu:3,zu:t.settings.zu,methodName:e._methodName,Qu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class ll extends Qa{_toFieldTransform(e){return new ir(e.path,new Yn)}isEqual(e){return e instanceof ll}}class cl extends Qa{constructor(e,t){super(e),this.Hu=t}_toFieldTransform(e){const t=al(this,e,!0),n=this.Hu.map((e=>ml(e,t))),r=new Jn(n);return new ir(e.path,r)}isEqual(e){return e instanceof cl&&(0,s.bD)(this.Hu,e.Hu)}}class ul extends Qa{constructor(e,t){super(e),this.Hu=t}_toFieldTransform(e){const t=al(this,e,!0),n=this.Hu.map((e=>ml(e,t))),r=new Zn(n);return new ir(e.path,r)}isEqual(e){return e instanceof ul&&(0,s.bD)(this.Hu,e.Hu)}}class dl extends Qa{constructor(e,t){super(e),this.Ju=t}_toFieldTransform(e){const t=new tr(e.serializer,qn(e.serializer,this.Ju));return new ir(e.path,t)}isEqual(e){return e instanceof dl&&this.Ju===e.Ju}}function hl(e,t,n,r){const i=e.ju(1,t,n);yl("Data must be an object, but it was:",i,r);const o=[],a=Pt.empty();We(r,((e,r)=>{const l=Sl(t,e,n);r=(0,s.Ku)(r);const c=i.Uu(l);if(r instanceof sl)o.push(l);else{const e=ml(r,c);null!=e&&(o.push(l),a.set(l,e))}}));const l=new Qe(o);return new el(a,l,i.fieldTransforms)}function fl(e,t,n,r,i,o){const a=e.ju(1,t,n),l=[bl(t,r,n)],c=[i];if(o.length%2!=0)throw new k(E.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<o.length;e+=2)l.push(bl(t,o[e])),c.push(o[e+1]);const u=[],d=Pt.empty();for(let e=l.length-1;e>=0;--e)if(!kl(u,l[e])){const t=l[e];let n=c[e];n=(0,s.Ku)(n);const r=a.Uu(t);if(n instanceof sl)u.push(t);else{const e=ml(n,r);null!=e&&(u.push(t),d.set(t,e))}}const h=new Qe(u);return new el(d,h,a.fieldTransforms)}function pl(e,t,n,r=!1){return ml(n,e.ju(r?4:3,t))}function ml(e,t){if(vl(e=(0,s.Ku)(e)))return yl("Unsupported field value:",t,e),gl(e,t);if(e instanceof Qa)return function(e,t){if(!tl(t.Lu))throw t.Wu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Wu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&4!==t.Lu)throw t.Wu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=ml(i,t.Ku(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,s.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return qn(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=$.fromDate(e);return{timestampValue:Qr(t.serializer,n)}}if(e instanceof $){const n=new $(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Qr(t.serializer,n)}}if(e instanceof Ya)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Ha)return{bytesValue:Yr(t.serializer,e._byteString)};if(e instanceof Pa){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Wu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Zr(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Ja)return function(e,t){return{mapValue:{fields:{[ht]:{stringValue:mt},[gt]:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Wu("VectorValues must only contain numeric values.");return $n(t.serializer,e)}))}}}}}}(e,t);throw t.Wu(`Unsupported field value: ${Ca(e)}`)}(e,t)}function gl(e,t){const n={};return $e(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):We(e,((e,r)=>{const i=ml(r,t.qu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function vl(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof $||e instanceof Ya||e instanceof Ha||e instanceof Pa||e instanceof Qa||e instanceof Ja)}function yl(e,t,n){if(!vl(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Ca(n);throw"an object"===r?t.Wu(e+" a custom object"):t.Wu(e+" "+r)}}function bl(e,t,n){if((t=(0,s.Ku)(t))instanceof Ka)return t._internalPath;if("string"==typeof t)return Sl(e,t);throw El("Field path arguments must be of type string or ",e,!1,void 0,n)}const wl=new RegExp("[~\\*/\\[\\]]");function Sl(e,t,n){if(t.search(wl)>=0)throw El(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Ka(...t.split("."))._internalPath}catch(r){throw El(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function El(e,t,n,r,i){const o=r&&!r.isEmpty(),s=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${r}`),s&&(l+=` in document ${i}`),l+=")"),new k(E.INVALID_ARGUMENT,a+e+l)}function kl(e,t){return e.some((e=>e.isEqual(t)))}class _l{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Pa(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new xl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Tl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class xl extends _l{data(){return super.data()}}function Tl(e,t){return"string"==typeof t?Sl(e,t):t instanceof Ka?t._internalPath:t._delegate._internalPath}function Il(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new k(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cl{}class Nl extends Cl{}function Al(e,t,...n){let r=[];t instanceof Cl&&r.push(t),r=r.concat(n),function(e){const t=e.filter((e=>e instanceof Ol)).length,n=e.filter((e=>e instanceof Dl)).length;if(t>1||t>0&&n>0)throw new k(E.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const t of r)e=t._apply(e);return e}class Dl extends Nl{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Dl(e,t,n)}_apply(e){const t=this._parse(e);return Ul(e._query,t),new La(e.firestore,e.converter,wn(e._query,t))}_parse(e){const t=il(e.firestore),n=function(e,t,n,r,i,o,s){let a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new k(E.INVALID_ARGUMENT,`Invalid Query. You can't perform '${o}' queries on documentId().`);if("in"===o||"not-in"===o){Fl(s,o);const t=[];for(const n of s)t.push(Ml(r,e,n));a={arrayValue:{values:t}}}else a=Ml(r,e,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Fl(s,o),a=pl(n,t,s,"in"===o||"not-in"===o);return Bt.create(i,o,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Rl(e,t,n){const r=t,i=Tl("where",e);return Dl._create(i,r,n)}class Ol extends Cl{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ol(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:qt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const e of r)Ul(n,e),n=wn(n,e)}(e._query,t),new La(e.firestore,e.converter,wn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Ll extends Nl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Ll(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new k(E.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new k(E.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new jt(t,n)}(e._query,this._field,this._direction);return new La(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new hn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Pl(e,t="asc"){const n=t,r=Tl("orderBy",e);return Ll._create(r,n)}function Ml(e,t,n){if("string"==typeof(n=(0,s.Ku)(n))){if(""===n)throw new k(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gn(t)&&-1!==n.indexOf("/"))throw new k(E.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(K.fromString(n));if(!Y.isDocumentKey(r))throw new k(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Tt(e,new Y(r))}if(n instanceof Pa)return Tt(e,n._key);throw new k(E.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ca(n)}.`)}function Fl(e,t){if(!Array.isArray(e)||0===e.length)throw new k(E.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Ul(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new k(E.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new k(E.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class zl{convertValue(e,t="none"){switch(vt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(tt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw b()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return We(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[gt].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>et(e.doubleValue)));return new Ja(i)}convertGeoPoint(e){return new Ya(et(e.latitude),et(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=at(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(lt(e));default:return null}}convertTimestamp(e){const t=Ze(e);return new $(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=K.fromString(e);w(Si(n));const r=new dt(n.get(1),n.get(3)),i=new Y(n.popFirst(5));return r.isEqual(t)||g(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Vl(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class jl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Wl extends _l{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new $l(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Tl("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class $l extends Wl{data(e={}){return super.data(e)}}class Bl{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new jl(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new $l(this._firestore,this._userDataWriter,n.key,n,new jl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new $l(e._firestore,e._userDataWriter,n.doc.key,n.doc,new jl(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new $l(e._firestore,e._userDataWriter,t.doc.key,t.doc,new jl(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,o=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),o=n.indexOf(t.doc.key)),{type:ql(t.type),doc:r,oldIndex:i,newIndex:o}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function ql(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return b()}}function Hl(e){e=Na(e,Pa);const t=Na(e.firestore,Wa);return Sa(Ba(t),e._key).then((n=>tc(t,e,n)))}class Kl extends zl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ha(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pa(this.firestore,null,t)}}function Gl(e){e=Na(e,La);const t=Na(e.firestore,Wa),n=Ba(t),r=new Kl(t);return Il(e._query),Ea(n,e._query).then((n=>new Bl(t,r,e,n)))}function Ql(e,t,n){e=Na(e,Pa);const r=Na(e.firestore,Wa),i=Vl(e.converter,t,n);return ec(r,[ol(il(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,sr.none())])}function Yl(e,t,n,...r){e=Na(e,Pa);const i=Na(e.firestore,Wa),o=il(i);let a;return a="string"==typeof(t=(0,s.Ku)(t))||t instanceof Ka?fl(o,"updateDoc",e._key,t,n,r):hl(o,"updateDoc",e._key,t),ec(i,[a.toMutation(e._key,sr.exists(!0))])}function Jl(e){return ec(Na(e.firestore,Wa),[new br(e._key,sr.none())])}function Xl(e,t){const n=Na(e.firestore,Wa),r=Ua(e),i=Vl(e.converter,t);return ec(n,[ol(il(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,sr.exists(!1))]).then((()=>r))}function Zl(e,...t){var n,r,i;e=(0,s.Ku)(e);let o={includeMetadataChanges:!1,source:"default"},a=0;"object"!=typeof t[a]||ja(t[a])||(o=t[a],a++);const l={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(ja(t[a])){const e=t[a];t[a]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[a+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[a+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let c,u,d;if(e instanceof Pa)u=Na(e.firestore,Wa),d=pn(e._key.path),c={next:n=>{t[a]&&t[a](tc(u,e,n))},error:t[a+1],complete:t[a+2]};else{const n=Na(e,La);u=Na(n.firestore,Wa),d=n._query;const r=new Kl(u);c={next:e=>{t[a]&&t[a](new Bl(u,r,n,e))},error:t[a+1],complete:t[a+2]},Il(e._query)}return function(e,t,n,r){const i=new ha(r),o=new Rs(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>xs(await wa(e),o))),()=>{i.su(),e.asyncQueue.enqueueAndForget((async()=>Ts(await wa(e),o)))}}(Ba(u),d,l,c)}function ec(e,t){return function(e,t){const n=new _;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=la(e);try{const e=await function(e,t){const n=S(e),r=$.now(),i=t.reduce(((e,t)=>e.add(t.key)),Vn());let o,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Dn(),l=Vn();return n.ds.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{o=i;const s=[];for(const e of t){const t=hr(e,o.get(e.key).overlayedDocument);null!=t&&s.push(new mr(e.key,t,Mt(t.value.mapValue),sr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)})).next((t=>{s=t;const r=t.applyToLocalDocumentSet(o,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:s.batchId,changes:Ln(o)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Wa[e.currentUser.toKey()];r||(r=new Be(M)),r=r.insert(t,n),e.Wa[e.currentUser.toKey()]=r}(r,e.batchId,n),await ia(r,e.changes),await is(r.remoteStore)}catch(e){const t=ys(e,"Failed to persist write");n.reject(t)}}(await ba(e),t,n))),n.promise}(Ba(e),t)}function tc(e,t,n){const r=n.docs.get(t._key),i=new Kl(e);return new Wl(e,i,t._key,r,new jl(n.hasPendingWrites,n.fromCache),t.converter)}class nc{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=il(e)}set(e,t,n){this._verifyNotCommitted();const r=rc(e,this._firestore),i=Vl(r.converter,t,n),o=ol(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,sr.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=rc(e,this._firestore);let o;return o="string"==typeof(t=(0,s.Ku)(t))||t instanceof Ka?fl(this._dataReader,"WriteBatch.update",i._key,t,n,r):hl(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,sr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=rc(e,this._firestore);return this._mutations=this._mutations.concat(new br(t._key,sr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(E.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function rc(e,t){if((e=(0,s.Ku)(e)).firestore!==t)throw new k(E.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function ic(){return new sl("deleteField")}function oc(){return new ll("serverTimestamp")}function sc(...e){return new cl("arrayUnion",e)}function ac(...e){return new ul("arrayRemove",e)}function lc(e){return new dl("increment",e)}function cc(e){return Ba(e=Na(e,Wa)),new nc(e,(t=>ec(e,t)))}new WeakMap;!function(e,t=!0){!function(e){h=e}(r.MF),(0,r.om)(new i.uA("firestore",((e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),o=new Wa(new C(e.getProvider("auth-internal")),new R(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new k(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new dt(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),o._setSettings(r),o}),"PUBLIC").setMultipleInstances(!0)),(0,r.KO)(c,u,e),(0,r.KO)(c,u,"esm2017")}()},6743:(e,t,n)=>{n.d(t,{Am:()=>R,FA:()=>I,Fy:()=>g,I9:()=>O,Im:()=>N,Ku:()=>U,T9:()=>f,Tj:()=>d,Uj:()=>a,XA:()=>p,ZQ:()=>v,bD:()=>A,c1:()=>b,cY:()=>m,eX:()=>x,g:()=>T,hp:()=>L,jZ:()=>y,lT:()=>E,lV:()=>S,nr:()=>k,sr:()=>w,tD:()=>P,u:()=>l,yU:()=>h,zW:()=>_});var r=n(7773);const i=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},o={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],o=t+1<e.length,s=o?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0,c=i>>2,u=(3&i)<<4|s>>4;let d=(15&s)<<2|l>>6,h=63&l;a||(h=64,o||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const l=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==a||null==l)throw new s;const c=i<<2|o>>4;if(r.push(c),64!==a){const e=o<<4&240|a>>2;if(r.push(e),64!==l){const e=a<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(e){return function(e){const t=i(e);return o.encodeByteArray(t,!0)}(e).replace(/\./g,"")},l=function(e){try{return o.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};const c=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,u=()=>{try{return(0,r.M)()||c()||(()=>{const e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&l(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},d=e=>{var t,n;return null===(n=null===(t=u())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},h=e=>{const t=d(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},f=()=>{var e;return null===(e=u())||void 0===e?void 0:e.config},p=e=>{var t;return null===(t=u())||void 0===t?void 0:t[`_${e}`]};class m{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function g(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(o)),""].join(".")}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function y(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())}function b(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function w(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function S(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function E(){const e=v();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function k(){return!function(){var e;const t=null===(e=u())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _(){try{return"object"==typeof indexedDB}catch(e){return!1}}function x(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class T extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,T.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,I.prototype.create)}}class I{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?function(e,t){return e.replace(C,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",s=`${this.serviceName}: ${o} (${r}).`;return new T(r,s,n)}}const C=/\{\$([^}]+)}/g;function N(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function A(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(D(n)&&D(o)){if(!A(n,o))return!1}else if(n!==o)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function D(e){return null!==e&&"object"==typeof e}function R(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function O(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function L(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function P(e,t){const n=new M(e,t);return n.subscribe.bind(n)}class M{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=F),void 0===r.error&&(r.error=F),void 0===r.complete&&(r.complete=F);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function F(){}function U(e){return e&&e._delegate?e._delegate:e}},2551:(e,t,n)=>{var r=n(6540),i=n(9982);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),E=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),I=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function P(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=L&&e[L]||e["@@iterator"])?e:null}var M,F=Object.assign;function U(e){if(void 0===M)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var z=!1;function V(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var i=t.stack.split("\n"),o=r.stack.split("\n"),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||i[s]!==o[a]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function j(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case k:return"Fragment";case E:return"Portal";case x:return"Profiler";case _:return"StrictMode";case N:return"Suspense";case A:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return W(e(t))}catch(e){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function B(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=B(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){J(e,t);var n=B(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,B(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+B(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:B(n)}}function oe(e,t){var n=B(t.value),r=B(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,ke=null,_e=null;function xe(e){if(e=bi(e)){if("function"!=typeof Ee)throw Error(o(280));var t=e.stateNode;t&&(t=Si(t),Ee(e.stateNode,e.type,t))}}function Te(e){ke?_e?_e.push(e):_e=[e]:ke=e}function Ie(){if(ke){var e=ke,t=_e;if(_e=ke=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function Ce(e,t){return e(t)}function Ne(){}var Ae=!1;function De(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ce(e,t,n)}finally{Ae=!1,(null!==ke||null!==_e)&&(Ne(),Ie())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=Si(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(o(231,t,typeof n));return n}var Oe=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){Oe=!1}function Pe(e,t,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var Me=!1,Fe=null,Ue=!1,ze=null,Ve={onError:function(e){Me=!0,Fe=e}};function je(e,t,n,r,i,o,s,a,l){Me=!1,Fe=null,Pe.apply(Ve,arguments)}function We(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Be(e){if(We(e)!==e)throw Error(o(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Be(i),e;if(s===r)return Be(i),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Je=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~i;0!==a?r=dt(a):0!==(o&=s)&&(r=dt(o))}else 0!==(s=n&~i)?r=dt(s):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&!(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&4194240&o))return t;if(4&r&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-st(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return!(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var St,Et,kt,_t,xt,Tt=!1,It=[],Ct=null,Nt=null,At=null,Dt=new Map,Rt=new Map,Ot=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Mt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&Et(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=yi(e.target);if(null!==t){var n=We(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void xt(e.priority,(function(){kt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&Et(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function zt(e,t,n){Ut(e)&&n.delete(t)}function Vt(){Tt=!1,null!==Ct&&Ut(Ct)&&(Ct=null),null!==Nt&&Ut(Nt)&&(Nt=null),null!==At&&Ut(At)&&(At=null),Dt.forEach(zt),Rt.forEach(zt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Vt)))}function Wt(e){function t(t){return jt(t,e)}if(0<It.length){jt(It[0],e);for(var n=1;n<It.length;n++){var r=It[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&jt(Ct,e),null!==Nt&&jt(Nt,e),null!==At&&jt(At,e),Dt.forEach(t),Rt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Ft(n),null===n.blockedOn&&Ot.shift()}var $t=w.ReactCurrentBatchConfig,Bt=!0;function qt(e,t,n,r){var i=bt,o=$t.transition;$t.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=i,$t.transition=o}}function Ht(e,t,n,r){var i=bt,o=$t.transition;$t.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=i,$t.transition=o}}function Kt(e,t,n,r){if(Bt){var i=Qt(e,t,n,r);if(null===i)Br(e,t,r,Gt,n),Pt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Ct=Mt(Ct,e,t,n,r,i),!0;case"dragenter":return Nt=Mt(Nt,e,t,n,r,i),!0;case"mouseover":return At=Mt(At,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Dt.set(o,Mt(Dt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Rt.set(o,Mt(Rt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Pt(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var o=bi(i);if(null!==o&&St(o),null===(o=Qt(e,t,n,r))&&Br(e,t,r,Gt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Br(e,t,r,null,n)}}var Gt=null;function Qt(e,t,n,r){if(Gt=null,null!==(e=yi(e=Se(r))))if(null===(t=We(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),dn=F({},cn,{view:0,detail:0}),hn=on(dn),fn=F({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=on(fn),mn=on(F({},fn,{dataTransfer:0})),gn=on(F({},dn,{relatedTarget:0})),vn=on(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),wn=on(F({},cn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function xn(){return _n}var Tn=F({},dn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=on(Tn),Cn=on(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=on(F({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),An=on(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=on(Dn),On=[9,13,27,32],Ln=u&&"CompositionEvent"in window,Pn=null;u&&"documentMode"in document&&(Pn=document.documentMode);var Mn=u&&"TextEvent"in window&&!Pn,Fn=u&&(!Ln||Pn&&8<Pn&&11>=Pn),Un=String.fromCharCode(32),zn=!1;function Vn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function qn(e,t,n,r){Te(r),0<(t=Hr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Kn=null;function Gn(e){Ur(e,0)}function Qn(e){if(K(wi(e)))return e}function Yn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"==typeof er.oninput}Xn=Zn}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Kn=Hn=null)}function nr(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];qn(t,Kn,e,Se(e)),De(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function or(e,t){if("click"===e)return Qn(t)}function sr(e,t){if("input"===e||"change"===e)return Qn(t)}var ar="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function lr(e,t){if(ar(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=ur(n,o);var s=ur(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==G(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Hr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function Sr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:Sr("Animation","AnimationEnd"),animationiteration:Sr("Animation","AnimationIteration"),animationstart:Sr("Animation","AnimationStart"),transitionend:Sr("Transition","TransitionEnd")},kr={},_r={};function xr(e){if(kr[e])return kr[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in _r)return kr[e]=n[t];return e}u&&(_r=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var Tr=xr("animationend"),Ir=xr("animationiteration"),Cr=xr("animationstart"),Nr=xr("transitionend"),Ar=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Ar.set(e,t),l(t,[e])}for(var Or=0;Or<Dr.length;Or++){var Lr=Dr[Or];Rr(Lr.toLowerCase(),"on"+(Lr[0].toUpperCase()+Lr.slice(1)))}Rr(Tr,"onAnimationEnd"),Rr(Ir,"onAnimationIteration"),Rr(Cr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,s,a,l,c){if(je.apply(this,arguments),Me){if(!Me)throw Error(o(198));var u=Fe;Me=!1,Fe=null,Ue||(Ue=!0,ze=u)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;Fr(i,a,c),o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;Fr(i,a,c),o=l}}}if(Ue)throw e=ze,Ue=!1,ze=null,e}function zr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||($r(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),$r(n,e,r,t)}var jr="_reactListening"+Math.random().toString(36).slice(2);function Wr(e){if(!e[jr]){e[jr]=!0,s.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||Vr(t,!1,e),Vr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jr]||(t[jr]=!0,Vr("selectionchange",!1,t))}}function $r(e,t,n,r){switch(Yt(t)){case 1:var i=qt;break;case 4:i=Ht;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Br(e,t,n,r,i){var o=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==a;){if(null===(s=yi(a)))return;if(5===(l=s.tag)||6===l){r=o=s;continue e}a=a.parentNode}}r=r.return}De((function(){var r=o,i=Se(n),s=[];e:{var a=Ar.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Nn;break;case Tr:case Ir:case Cr:l=vn;break;case Nr:l=An;break;case"scroll":l=hn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var u=!!(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=Re(p,h))&&u.push(qr(p,m,f)))),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),s.push({event:a,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!yi(c)&&!c[pi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?yi(c):null)&&(c!==(d=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Cn,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:wi(l),f=null==c?a:wi(c),(a=new u(m,p+"leave",l,n,i)).target=d,a.relatedTarget=f,m=null,yi(i)===r&&((u=new u(h,p+"enter",c,n,i)).target=f,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Kr(f))p++;for(f=0,m=h;m;m=Kr(m))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)h=Kr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Kr(u),h=Kr(h)}u=null}else u=null;null!==l&&Gr(s,a,l,u,!1),null!==c&&null!==d&&Gr(s,d,c,u,!0)}if("select"===(l=(a=r?wi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Yn;else if(Bn(a))if(Jn)g=sr;else{g=ir;var v=rr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=or);switch(g&&(g=g(e,r))?qn(s,g,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=r?wi(r):window,e){case"focusin":(Bn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(s,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(s,n,i)}var y;if(Ln)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Wn?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wn&&(y=en()):(Xt="value"in(Jt=i)?Jt.value:Jt.textContent,Wn=!0)),0<(v=Hr(r,b)).length&&(b=new wn(b,e,null,n,i),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=jn(n))&&(b.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return jn(t);case"keypress":return 32!==t.which?null:(zn=!0,Un);case"textInput":return(e=t.data)===Un&&zn?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!Ln&&Vn(e,t)?(e=en(),Zt=Xt=Jt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=y))}Ur(s,t)}))}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Re(e,n))&&r.unshift(qr(e,o,i)),null!=(o=Re(e,t))&&r.push(qr(e,o,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Re(n,o))&&s.unshift(qr(n,l,a)):i||null!=(l=Re(n,o))&&s.push(qr(n,l,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Jr(e){return("string"==typeof e?e:""+e).replace(Qr,"\n").replace(Yr,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(o(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"==typeof setTimeout?setTimeout:void 0,ii="function"==typeof clearTimeout?clearTimeout:void 0,oi="function"==typeof Promise?Promise:void 0,si="function"==typeof queueMicrotask?queueMicrotask:void 0!==oi?function(e){return oi.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Wt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Wt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,vi="__reactHandles$"+di;function yi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[hi])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function Si(e){return e[fi]||null}var Ei=[],ki=-1;function _i(e){return{current:e}}function xi(e){0>ki||(e.current=Ei[ki],Ei[ki]=null,ki--)}function Ti(e,t){ki++,Ei[ki]=e.current,e.current=t}var Ii={},Ci=_i(Ii),Ni=_i(!1),Ai=Ii;function Di(e,t){var n=e.type.contextTypes;if(!n)return Ii;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ri(e){return null!=(e=e.childContextTypes)}function Oi(){xi(Ni),xi(Ci)}function Li(e,t,n){if(Ci.current!==Ii)throw Error(o(168));Ti(Ci,t),Ti(Ni,n)}function Pi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,$(e)||"Unknown",i));return F({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ii,Ai=Ci.current,Ti(Ci,e),Ti(Ni,Ni.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Pi(e,t,Ai),r.__reactInternalMemoizedMergedChildContext=e,xi(Ni),xi(Ci),Ti(Ci,e)):xi(Ni),Ti(Ni,n)}var Ui=null,zi=!1,Vi=!1;function ji(e){null===Ui?Ui=[e]:Ui.push(e)}function Wi(){if(!Vi&&null!==Ui){Vi=!0;var e=0,t=bt;try{var n=Ui;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ui=null,zi=!1}catch(t){throw null!==Ui&&(Ui=Ui.slice(e+1)),Ke(Ze,Wi),t}finally{bt=t,Vi=!1}}return null}var $i=[],Bi=0,qi=null,Hi=0,Ki=[],Gi=0,Qi=null,Yi=1,Ji="";function Xi(e,t){$i[Bi++]=Hi,$i[Bi++]=qi,qi=e,Hi=t}function Zi(e,t,n){Ki[Gi++]=Yi,Ki[Gi++]=Ji,Ki[Gi++]=Qi,Qi=e;var r=Yi;e=Ji;var i=32-st(r)-1;r&=~(1<<i),n+=1;var o=32-st(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Yi=1<<32-st(t)+i|n<<i|r,Ji=o+e}else Yi=1<<o|n<<i|r,Ji=e}function eo(e){null!==e.return&&(Xi(e,1),Zi(e,1,0))}function to(e){for(;e===qi;)qi=$i[--Bi],$i[Bi]=null,Hi=$i[--Bi],$i[Bi]=null;for(;e===Qi;)Qi=Ki[--Gi],Ki[Gi]=null,Ji=Ki[--Gi],Ki[Gi]=null,Yi=Ki[--Gi],Ki[Gi]=null}var no=null,ro=null,io=!1,oo=null;function so(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ao(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Yi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function lo(e){return!(!(1&e.mode)||128&e.flags)}function co(e){if(io){var t=ro;if(t){var n=t;if(!ao(e,t)){if(lo(e))throw Error(o(418));t=ci(n.nextSibling);var r=no;t&&ao(e,t)?so(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!io)return uo(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw fo(),Error(o(418));for(;t;)so(e,t),t=ci(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?ci(e.stateNode.nextSibling):null;return!0}function fo(){for(var e=ro;e;)e=ci(e.nextSibling)}function po(){ro=no=null,io=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=w.ReactCurrentBatchConfig;function vo(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!=typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bo(e){return(0,e._init)(e._payload)}function wo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===k?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===R&&bo(o)===t.type)?((r=i(t,n.props)).ref=vo(e,t,n),r.return=e,r):((r=Lc(n.type,n.key,n.props,null,e.mode,r)).ref=vo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Pc(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=vo(e,null,t),n.return=e,n;case E:return(t=Uc(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||P(t))return(t=Pc(t,e.mode,n,null)).return=e,t;yo(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==i?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===i?c(e,t,n,r):null;case E:return n.key===i?u(e,t,n,r):null;case R:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||P(n))return null!==i?null:d(e,t,n,r,null);yo(e,n)}return null}function p(e,t,n,r,i){if("string"==typeof r&&""!==r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case S:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case E:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case R:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||P(r))return d(t,e=e.get(n)||null,r,i,null);yo(t,r)}return null}function m(i,o,a,l){for(var c=null,u=null,d=o,m=o=0,g=null;null!==d&&m<a.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=f(i,d,a[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(i,d),o=s(v,o,m),null===u?c=v:u.sibling=v,u=v,d=g}if(m===a.length)return n(i,d),io&&Xi(i,m),c;if(null===d){for(;m<a.length;m++)null!==(d=h(i,a[m],l))&&(o=s(d,o,m),null===u?c=d:u.sibling=d,u=d);return io&&Xi(i,m),c}for(d=r(i,d);m<a.length;m++)null!==(g=p(d,i,m,a[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),o=s(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(i,e)})),io&&Xi(i,m),c}function g(i,a,l,c){var u=P(l);if("function"!=typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var d=u=null,m=a,g=a=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(i,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),a=s(b,a,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(i,m),io&&Xi(i,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(i,y.value,c))&&(a=s(y,a,g),null===d?u=y:d.sibling=y,d=y);return io&&Xi(i,g),u}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=p(m,i,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=s(y,a,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach((function(e){return t(i,e)})),io&&Xi(i,g),u}return function e(r,o,s,l){if("object"==typeof s&&null!==s&&s.type===k&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case S:e:{for(var c=s.key,u=o;null!==u;){if(u.key===c){if((c=s.type)===k){if(7===u.tag){n(r,u.sibling),(o=i(u,s.props.children)).return=r,r=o;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===R&&bo(c)===u.type){n(r,u.sibling),(o=i(u,s.props)).ref=vo(r,u,s),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===k?((o=Pc(s.props.children,r.mode,l,s.key)).return=r,r=o):((l=Lc(s.type,s.key,s.props,null,r.mode,l)).ref=vo(r,o,s),l.return=r,r=l)}return a(r);case E:e:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(r,o.sibling),(o=i(o,s.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Uc(s,r.mode,l)).return=r,r=o}return a(r);case R:return e(r,o,(u=s._init)(s._payload),l)}if(te(s))return m(r,o,s,l);if(P(s))return g(r,o,s,l);yo(r,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,s)).return=r,r=o):(n(r,o),(o=Fc(s,r.mode,l)).return=r,r=o),a(r)):n(r,o)}}var So=wo(!0),Eo=wo(!1),ko=_i(null),_o=null,xo=null,To=null;function Io(){To=xo=_o=null}function Co(e){var t=ko.current;xi(ko),e._currentValue=t}function No(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ao(e,t){_o=e,To=xo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(ba=!0),e.firstContext=null)}function Do(e){var t=e._currentValue;if(To!==e)if(e={context:e,memoizedValue:t,next:null},null===xo){if(null===_o)throw Error(o(308));xo=e,_o.dependencies={lanes:0,firstContext:e}}else xo=xo.next=e;return t}var Ro=null;function Oo(e){null===Ro?Ro=[e]:Ro.push(e)}function Lo(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Oo(t)):(n.next=i.next,i.next=n),t.interleaved=n,Po(e,r)}function Po(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Mo=!1;function Fo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Uo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Vo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&Cl){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Po(e,n)}return null===(i=r.interleaved)?(t.next=t,Oo(r)):(t.next=i.next,i.next=t),r.interleaved=t,Po(e,n)}function jo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Wo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function $o(e,t,n,r){var i=e.updateQueue;Mo=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=i.baseState;for(s=0,u=c=l=null,a=o;;){var h=a.lane,f=a.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(h=t,f=n,m.tag){case 1:if("function"==typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(h="function"==typeof(p=m.payload)?p.call(f,d,h):p))break e;d=F({},d,h);break e;case 2:Mo=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,s|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Ml|=s,e.lanes=s,e.memoizedState=d}}function Bo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!=typeof i)throw Error(o(191,i));i.call(r)}}}var qo={},Ho=_i(qo),Ko=_i(qo),Go=_i(qo);function Qo(e){if(e===qo)throw Error(o(174));return e}function Yo(e,t){switch(Ti(Go,t),Ti(Ko,e),Ti(Ho,qo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xi(Ho),Ti(Ho,t)}function Jo(){xi(Ho),xi(Ko),xi(Go)}function Xo(e){Qo(Go.current);var t=Qo(Ho.current),n=le(t,e.type);t!==n&&(Ti(Ko,e),Ti(Ho,n))}function Zo(e){Ko.current===e&&(xi(Ho),xi(Ko))}var es=_i(0);function ts(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ns=[];function rs(){for(var e=0;e<ns.length;e++)ns[e]._workInProgressVersionPrimary=null;ns.length=0}var is=w.ReactCurrentDispatcher,os=w.ReactCurrentBatchConfig,ss=0,as=null,ls=null,cs=null,us=!1,ds=!1,hs=0,fs=0;function ps(){throw Error(o(321))}function ms(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function gs(e,t,n,r,i,s){if(ss=s,as=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,is.current=null===e||null===e.memoizedState?Zs:ea,e=n(r,i),ds){s=0;do{if(ds=!1,hs=0,25<=s)throw Error(o(301));s+=1,cs=ls=null,t.updateQueue=null,is.current=ta,e=n(r,i)}while(ds)}if(is.current=Xs,t=null!==ls&&null!==ls.next,ss=0,cs=ls=as=null,us=!1,t)throw Error(o(300));return e}function vs(){var e=0!==hs;return hs=0,e}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cs?as.memoizedState=cs=e:cs=cs.next=e,cs}function bs(){if(null===ls){var e=as.alternate;e=null!==e?e.memoizedState:null}else e=ls.next;var t=null===cs?as.memoizedState:cs.next;if(null!==t)cs=t,ls=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ls=e).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===cs?as.memoizedState=cs=e:cs=cs.next=e}return cs}function ws(e,t){return"function"==typeof t?t(e):t}function Ss(e){var t=bs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=ls,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var l=a=null,c=null,u=s;do{var d=u.lane;if((ss&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=r):c=c.next=h,as.lanes|=d,Ml|=d}u=u.next}while(null!==u&&u!==s);null===c?a=r:c.next=l,ar(r,t.memoizedState)||(ba=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,as.lanes|=s,Ml|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Es(e){var t=bs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);ar(s,t.memoizedState)||(ba=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function ks(){}function _s(e,t){var n=as,r=bs(),i=t(),s=!ar(r.memoizedState,i);if(s&&(r.memoizedState=i,ba=!0),r=r.queue,Ms(Is.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==cs&&1&cs.memoizedState.tag){if(n.flags|=2048,Ds(9,Ts.bind(null,n,r,i,t),void 0,null),null===Nl)throw Error(o(349));30&ss||xs(n,t,i)}return i}function xs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=as.updateQueue)?(t={lastEffect:null,stores:null},as.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ts(e,t,n,r){t.value=n,t.getSnapshot=r,Cs(t)&&Ns(e)}function Is(e,t,n){return n((function(){Cs(t)&&Ns(e)}))}function Cs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(e){return!0}}function Ns(e){var t=Po(e,1);null!==t&&nc(t,e,1,-1)}function As(e){var t=ys();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ws,lastRenderedState:e},t.queue=e,e=e.dispatch=Gs.bind(null,as,e),[t.memoizedState,e]}function Ds(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=as.updateQueue)?(t={lastEffect:null,stores:null},as.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Rs(){return bs().memoizedState}function Os(e,t,n,r){var i=ys();as.flags|=e,i.memoizedState=Ds(1|t,n,void 0,void 0===r?null:r)}function Ls(e,t,n,r){var i=bs();r=void 0===r?null:r;var o=void 0;if(null!==ls){var s=ls.memoizedState;if(o=s.destroy,null!==r&&ms(r,s.deps))return void(i.memoizedState=Ds(t,n,o,r))}as.flags|=e,i.memoizedState=Ds(1|t,n,o,r)}function Ps(e,t){return Os(8390656,8,e,t)}function Ms(e,t){return Ls(2048,8,e,t)}function Fs(e,t){return Ls(4,2,e,t)}function Us(e,t){return Ls(4,4,e,t)}function zs(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Vs(e,t,n){return n=null!=n?n.concat([e]):null,Ls(4,4,zs.bind(null,t,e),n)}function js(){}function Ws(e,t){var n=bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $s(e,t){var n=bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Bs(e,t,n){return 21&ss?(ar(n,t)||(n=mt(),as.lanes|=n,Ml|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ba=!0),e.memoizedState=n)}function qs(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=os.transition;os.transition={};try{e(!1),t()}finally{bt=n,os.transition=r}}function Hs(){return bs().memoizedState}function Ks(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qs(e))Ys(t,n);else if(null!==(n=Lo(e,t,n,r))){nc(n,e,r,ec()),Js(n,t,r)}}function Gs(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qs(e))Ys(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,s)){var l=t.interleaved;return null===l?(i.next=i,Oo(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(e){}null!==(n=Lo(e,t,i,r))&&(nc(n,e,r,i=ec()),Js(n,t,r))}}function Qs(e){var t=e.alternate;return e===as||null!==t&&t===as}function Ys(e,t){ds=us=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Js(e,t,n){if(4194240&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xs={readContext:Do,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},Zs={readContext:Do,useCallback:function(e,t){return ys().memoizedState=[e,void 0===t?null:t],e},useContext:Do,useEffect:Ps,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Os(4194308,4,zs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Os(4194308,4,e,t)},useInsertionEffect:function(e,t){return Os(4,2,e,t)},useMemo:function(e,t){var n=ys();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ys();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ks.bind(null,as,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ys().memoizedState=e},useState:As,useDebugValue:js,useDeferredValue:function(e){return ys().memoizedState=e},useTransition:function(){var e=As(!1),t=e[0];return e=qs.bind(null,e[1]),ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=as,i=ys();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Nl)throw Error(o(349));30&ss||xs(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Ps(Is.bind(null,r,s,e),[e]),r.flags|=2048,Ds(9,Ts.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=ys(),t=Nl.identifierPrefix;if(io){var n=Ji;t=":"+t+"R"+(n=(Yi&~(1<<32-st(Yi)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Do,useCallback:Ws,useContext:Do,useEffect:Ms,useImperativeHandle:Vs,useInsertionEffect:Fs,useLayoutEffect:Us,useMemo:$s,useReducer:Ss,useRef:Rs,useState:function(){return Ss(ws)},useDebugValue:js,useDeferredValue:function(e){return Bs(bs(),ls.memoizedState,e)},useTransition:function(){return[Ss(ws)[0],bs().memoizedState]},useMutableSource:ks,useSyncExternalStore:_s,useId:Hs,unstable_isNewReconciler:!1},ta={readContext:Do,useCallback:Ws,useContext:Do,useEffect:Ms,useImperativeHandle:Vs,useInsertionEffect:Fs,useLayoutEffect:Us,useMemo:$s,useReducer:Es,useRef:Rs,useState:function(){return Es(ws)},useDebugValue:js,useDeferredValue:function(e){var t=bs();return null===ls?t.memoizedState=e:Bs(t,ls.memoizedState,e)},useTransition:function(){return[Es(ws)[0],bs().memoizedState]},useMutableSource:ks,useSyncExternalStore:_s,useId:Hs,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ra(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),o=zo(r,i);o.payload=t,null!=n&&(o.callback=n),null!==(t=Vo(e,o,i))&&(nc(t,e,i,r),jo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),o=zo(r,i);o.tag=1,o.payload=t,null!=n&&(o.callback=n),null!==(t=Vo(e,o,i))&&(nc(t,e,i,r),jo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=zo(n,r);i.tag=2,null!=t&&(i.callback=t),null!==(t=Vo(e,i,r))&&(nc(t,e,r,n),jo(t,e,r))}};function oa(e,t,n,r,i,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,o))}function sa(e,t,n){var r=!1,i=Ii,o=t.contextType;return"object"==typeof o&&null!==o?o=Do(o):(i=Ri(t)?Ai:Ci.current,o=(r=null!=(r=t.contextTypes))?Di(e,i):Ii),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function aa(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function la(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Fo(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=Do(o):(o=Ri(t)?Ai:Ci.current,i.context=Di(e,o)),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(ra(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ia.enqueueReplaceState(i,i.state,null),$o(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",r=t;do{n+=j(r),r=r.return}while(r);var i=n}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var ha="function"==typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=zo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Bl||(Bl=!0,ql=r),da(0,t)},n}function pa(e,t,n){(n=zo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){da(0,t)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){da(0,t),"function"!=typeof r&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ha;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=xc.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,r,i){return 1&e.mode?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=zo(-1,1)).tag=2,Vo(n,t,1))),n.lanes|=1),e)}var ya=w.ReactCurrentOwner,ba=!1;function wa(e,t,n,r){t.child=null===e?Eo(t,null,n,r):So(t,e.child,n,r)}function Sa(e,t,n,r,i){n=n.render;var o=t.ref;return Ao(t,i),r=gs(e,t,n,r,o,i),n=vs(),null===e||ba?(io&&n&&eo(t),t.flags|=1,wa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ba(e,t,i))}function Ea(e,t,n,r,i){if(null===e){var o=n.type;return"function"!=typeof o||Rc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,ka(e,t,o,r,i))}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Ba(e,t,i)}return t.flags|=1,(e=Oc(o,r)).ref=t.ref,e.return=t,t.child=e}function ka(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(lr(o,r)&&e.ref===t.ref){if(ba=!1,t.pendingProps=r=o,!(e.lanes&i))return t.lanes=e.lanes,Ba(e,t,i);131072&e.flags&&(ba=!0)}}return Ta(e,t,n,r,i)}function _a(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Ol,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Ti(Ol,Rl),Rl|=r}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Ol,Rl),Rl|=n;else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ti(Ol,Rl),Rl|=r;return wa(e,t,i,n),t.child}function xa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ta(e,t,n,r,i){var o=Ri(n)?Ai:Ci.current;return o=Di(t,o),Ao(t,i),n=gs(e,t,n,r,o,i),r=vs(),null===e||ba?(io&&r&&eo(t),t.flags|=1,wa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ba(e,t,i))}function Ia(e,t,n,r,i){if(Ri(n)){var o=!0;Mi(t)}else o=!1;if(Ao(t,i),null===t.stateNode)$a(e,t),sa(t,n,r),la(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;"object"==typeof c&&null!==c?c=Do(c):c=Di(t,c=Ri(n)?Ai:Ci.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||l!==c)&&aa(t,s,r,c),Mo=!1;var h=t.memoizedState;s.state=h,$o(t,r,s,i),l=t.memoizedState,a!==r||h!==l||Ni.current||Mo?("function"==typeof u&&(ra(t,n,u,r),l=t.memoizedState),(a=Mo||oa(t,n,a,r,h,l,c))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):("function"==typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Uo(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),s.props=c,d=t.pendingProps,h=s.context,"object"==typeof(l=n.contextType)&&null!==l?l=Do(l):l=Di(t,l=Ri(n)?Ai:Ci.current);var f=n.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==d||h!==l)&&aa(t,s,r,l),Mo=!1,h=t.memoizedState,s.state=h,$o(t,r,s,i);var p=t.memoizedState;a!==d||h!==p||Ni.current||Mo?("function"==typeof f&&(ra(t,n,f,r),p=t.memoizedState),(c=Mo||oa(t,n,c,r,h,p,l)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ca(e,t,n,r,o,i)}function Ca(e,t,n,r,i,o){xa(e,t);var s=!!(128&t.flags);if(!r&&!s)return i&&Fi(t,n,!1),Ba(e,t,o);r=t.stateNode,ya.current=t;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=So(t,e.child,null,o),t.child=So(t,null,a,o)):wa(e,t,a,o),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Na(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),Yo(e,t.containerInfo)}function Aa(e,t,n,r,i){return po(),mo(i),t.flags|=256,wa(e,t,n,r),t.child}var Da,Ra,Oa,La,Pa={dehydrated:null,treeContext:null,retryLane:0};function Ma(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fa(e,t,n){var r,i=t.pendingProps,s=es.current,a=!1,l=!!(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&!!(2&s)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ti(es,1&s),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},1&i||null===a?a=Mc(l,i,0,null):(a.childLanes=0,a.pendingProps=l),e=Pc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ma(n),t.memoizedState=Pa,e):Ua(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,i,s,a){if(n)return 256&t.flags?(t.flags&=-257,za(e,t,a,r=ua(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Mc({mode:"visible",children:r.children},i,0,null),(s=Pc(s,i,a,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,1&t.mode&&So(t,e.child,null,a),t.child.memoizedState=Ma(a),t.memoizedState=Pa,s);if(!(1&t.mode))return za(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,za(e,t,a,r=ua(s=Error(o(419)),r,void 0))}if(l=!!(a&e.childLanes),ba||l){if(null!==(r=Nl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=i&(r.suspendedLanes|a)?0:i)&&i!==s.retryLane&&(s.retryLane=i,Po(e,i),nc(r,e,i,-1))}return mc(),za(e,t,a,r=ua(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ro=ci(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(Ki[Gi++]=Yi,Ki[Gi++]=Ji,Ki[Gi++]=Qi,Yi=e.id,Ji=e.overflow,Qi=t),t=Ua(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,s,n);if(a){a=i.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:i.children};return 1&l||t.child===s?(i=Oc(s,c)).subtreeFlags=14680064&s.subtreeFlags:((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null),null!==r?a=Oc(r,a):(a=Pc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?Ma(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Pa,i}return e=(a=e.child).sibling,i=Oc(a,{mode:"visible",children:i.children}),!(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ua(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function za(e,t,n,r){return null!==r&&mo(r),So(t,e.child,null,n),(e=Ua(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Va(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),No(e.return,t,n)}function ja(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Wa(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(wa(e,t,r.children,n),2&(r=es.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Va(e,n,t);else if(19===e.tag)Va(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ti(es,r),1&t.mode)switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ts(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),ja(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ts(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}ja(t,!0,n,null,o);break;case"together":ja(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function $a(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ba(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qa(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ha(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ka(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ha(t),null;case 1:case 17:return Ri(t.type)&&Oi(),Ha(t),null;case 3:return r=t.stateNode,Jo(),xi(Ni),xi(Ci),rs(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==oo&&(sc(oo),oo=null))),Ra(e,t),Ha(t),null;case 5:Zo(t);var i=Qo(Go.current);if(n=t.type,null!==e&&null!=t.stateNode)Oa(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Ha(t),null}if(e=Qo(Ho.current),ho(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[hi]=t,r[fi]=s,e=!!(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(i=0;i<Pr.length;i++)zr(Pr[i],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":Y(r,s),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},zr("invalid",r);break;case"textarea":ie(r,s),zr("invalid",r)}for(var l in ye(n,s),i=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"==typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",c]):"number"==typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zr("scroll",r)}switch(n){case"input":H(r),Z(r,s,!0);break;case"textarea":H(r),se(r);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[fi]=r,Da(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":zr("cancel",e),zr("close",e),i=r;break;case"iframe":case"object":case"embed":zr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Pr.length;i++)zr(Pr[i],e);i=r;break;case"source":zr("error",e),i=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),i=r;break;case"details":zr("toggle",e),i=r;break;case"input":Y(e,r),i=Q(e,r),zr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),zr("invalid",e)}for(s in ye(n,i),c=i)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"==typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"==typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&zr("scroll",e):null!=u&&b(e,s,u,l))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+B(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ha(t),null;case 6:if(e&&null!=t.stateNode)La(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(o(166));if(n=Qo(Go.current),Qo(Ho.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(s=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Xr(r.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,!!(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ha(t),null;case 13:if(xi(es),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&1&t.mode&&!(128&t.flags))fo(),po(),t.flags|=98560,s=!1;else if(s=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[hi]=t}else po(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ha(t),s=!1}else null!==oo&&(sc(oo),oo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,1&t.mode&&(null===e||1&es.current?0===Ll&&(Ll=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ha(t),null);case 4:return Jo(),Ra(e,t),null===e&&Wr(t.stateNode.containerInfo),Ha(t),null;case 10:return Co(t.type._context),Ha(t),null;case 19:if(xi(es),null===(s=t.memoizedState))return Ha(t),null;if(r=!!(128&t.flags),null===(l=s.rendering))if(r)qa(s,!1);else{if(0!==Ll||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=ts(e))){for(t.flags|=128,qa(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ti(es,1&es.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>Wl&&(t.flags|=128,r=!0,qa(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ts(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qa(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!io)return Ha(t),null}else 2*Je()-s.renderingStartTime>Wl&&1073741824!==n&&(t.flags|=128,r=!0,qa(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,n=es.current,Ti(es,r?1&n|2:1&n),t):(Ha(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&1&t.mode?!!(1073741824&Rl)&&(Ha(t),6&t.subtreeFlags&&(t.flags|=8192)):Ha(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ga(e,t){switch(to(t),t.tag){case 1:return Ri(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Jo(),xi(Ni),xi(Ci),rs(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zo(t),null;case 13:if(xi(es),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));po()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xi(es),null;case 4:return Jo(),null;case 10:return Co(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Da=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ra=function(){},Oa=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qo(Ho.current);var o,s=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),s=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),s=[];break;case"textarea":i=re(e,i),r=re(e,r),s=[];break;default:"function"!=typeof i.onClick&&"function"==typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&zr("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},La=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qa=!1,Ya=!1,Ja="function"==typeof WeakSet?WeakSet:Set,Xa=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){_c(e,t,n)}else n.current=null}function el(e,t,n){try{n()}catch(n){_c(e,t,n)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&el(t,n,o)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(ot&&"function"==typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(e){}switch(n.tag){case 5:Ya||Za(n,t);case 6:var r=ul,i=dl;ul=null,hl(e,t,n),dl=i,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Wt(e)):li(ul,n.stateNode));break;case 4:r=ul,i=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,void 0!==s&&(2&o||4&o)&&el(n,t,s),i=i.next}while(i!==r)}hl(e,t,n);break;case 1:if(!Ya&&(Za(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(e){_c(n,t,e)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Ya=(r=Ya)||null!==n.memoizedState,hl(e,t,n),Ya=r):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ja),t.forEach((function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(o(160));fl(s,a,i),ul=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(e){_c(i,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(t){_c(e,e.return,t)}try{nl(5,e,e.return)}catch(t){_c(e,e.return,t)}}break;case 1:ml(t,e),vl(e),512&r&&null!==n&&Za(n,n.return);break;case 5:if(ml(t,e),vl(e),512&r&&null!==n&&Za(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(t){_c(e,e.return,t)}}if(4&r&&null!=(i=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&J(i,s),be(l,a);var u=be(l,s);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,u)}switch(l){case"input":X(i,s);break;case"textarea":oe(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?ne(i,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(i,!!s.multiple,s.defaultValue,!0):ne(i,!!s.multiple,s.multiple?[]:"",!1))}i[fi]=s}catch(t){_c(e,e.return,t)}}break;case 6:if(ml(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(t){_c(e,e.return,t)}}break;case 3:if(ml(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(t){_c(e,e.return,t)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(jl=Je())),4&r&&pl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(u=Ya)||d,ml(t,e),Ya=u):ml(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&1&e.mode)for(Xa=e,d=e.child;null!==d;){for(h=Xa=d;null!==Xa;){switch(p=(f=Xa).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Za(f,f.return);var m=f.stateNode;if("function"==typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(e){_c(r,n,e)}}break;case 5:Za(f,f.return);break;case 22:if(null!==f.memoizedState){Sl(h);continue}}null!==p?(p.return=f,Xa=p):Sl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"==typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,a=null!=(c=h.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(t){_c(e,e.return,t)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(t){_c(e,e.return,t)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),vl(e),4&r&&pl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,al(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;ll(e,al(e),s);break;default:throw Error(o(161))}}catch(t){_c(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Xa=e,bl(e,t,n)}function bl(e,t,n){for(var r=!!(1&e.mode);null!==Xa;){var i=Xa,o=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||Qa;if(!s){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Qa;var c=Ya;if(Qa=s,(Ya=l)&&!c)for(Xa=i;null!==Xa;)l=(s=Xa).child,22===s.tag&&null!==s.memoizedState?El(i):null!==l?(l.return=s,Xa=l):El(i);for(;null!==o;)Xa=o,bl(o,t,n),o=o.sibling;Xa=i,Qa=a,Ya=c}wl(e)}else 8772&i.subtreeFlags&&null!==o?(o.return=i,Xa=o):wl(e)}}function wl(e){for(;null!==Xa;){var t=Xa;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Ya||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ya)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Bo(t,s,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bo(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Wt(h)}}}break;default:throw Error(o(163))}Ya||512&t.flags&&il(t)}catch(e){_c(t,t.return,e)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function Sl(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function El(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(e){_c(t,n,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(e){_c(t,i,e)}}var o=t.return;try{il(t)}catch(e){_c(t,o,e)}break;case 5:var s=t.return;try{il(t)}catch(e){_c(t,s,e)}}}catch(e){_c(t,t.return,e)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var kl,_l=Math.ceil,xl=w.ReactCurrentDispatcher,Tl=w.ReactCurrentOwner,Il=w.ReactCurrentBatchConfig,Cl=0,Nl=null,Al=null,Dl=0,Rl=0,Ol=_i(0),Ll=0,Pl=null,Ml=0,Fl=0,Ul=0,zl=null,Vl=null,jl=0,Wl=1/0,$l=null,Bl=!1,ql=null,Hl=null,Kl=!1,Gl=null,Ql=0,Yl=0,Jl=null,Xl=-1,Zl=0;function ec(){return 6&Cl?Je():-1!==Xl?Xl:Xl=Je()}function tc(e){return 1&e.mode?2&Cl&&0!==Dl?Dl&-Dl:null!==go.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type):1}function nc(e,t,n,r){if(50<Yl)throw Yl=0,Jl=null,Error(o(185));vt(e,n,r),2&Cl&&e===Nl||(e===Nl&&(!(2&Cl)&&(Fl|=n),4===Ll&&ac(e,Dl)),rc(e,r),1===n&&0===Cl&&!(1&t.mode)&&(Wl=Je()+500,zi&&Wi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),a=1<<s,l=i[s];-1===l?a&n&&!(a&r)||(i[s]=ft(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var r=ht(e,e===Nl?Dl:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){zi=!0,ji(e)}(lc.bind(null,e)):ji(lc.bind(null,e)),si((function(){!(6&Cl)&&Wi()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Nc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Xl=-1,Zl=0,6&Cl)throw Error(o(327));var n=e.callbackNode;if(Ec()&&e.callbackNode!==n)return null;var r=ht(e,e===Nl?Dl:0);if(0===r)return null;if(30&r||r&e.expiredLanes||t)t=gc(e,r);else{t=r;var i=Cl;Cl|=2;var s=pc();for(Nl===e&&Dl===t||($l=null,Wl=Je()+500,hc(e,t));;)try{yc();break}catch(t){fc(e,t)}Io(),xl.current=s,Cl=i,null!==Al?t=0:(Nl=null,Dl=0,t=Ll)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=oc(e,i))),1===t)throw n=Pl,hc(e,0),ac(e,r),rc(e,Je()),n;if(6===t)ac(e,r);else{if(i=e.current.alternate,!(30&r||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!ar(o(),i))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)||(t=gc(e,r),2===t&&(s=pt(e),0!==s&&(r=s,t=oc(e,s))),1!==t)))throw n=Pl,hc(e,0),ac(e,r),rc(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:Sc(e,Vl,$l);break;case 3:if(ac(e,r),(130023424&r)===r&&10<(t=jl+500-Je())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Sc.bind(null,e,Vl,$l),t);break}Sc(e,Vl,$l);break;case 4:if(ac(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-st(r);s=1<<a,(a=t[a])>i&&(i=a),r&=~s}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_l(r/1960))-r)){e.timeoutHandle=ri(Sc.bind(null,e,Vl,$l),r);break}Sc(e,Vl,$l);break;default:throw Error(o(329))}}}return rc(e,Je()),e.callbackNode===n?ic.bind(null,e):null}function oc(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Vl,Vl=n,null!==t&&sc(t)),e}function sc(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function ac(e,t){for(t&=~Ul,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(6&Cl)throw Error(o(327));Ec();var t=ht(e,0);if(!(1&t))return rc(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Pl,hc(e,0),ac(e,t),rc(e,Je()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sc(e,Vl,$l),rc(e,Je()),null}function cc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(Wl=Je()+500,zi&&Wi())}}function uc(e){null!==Gl&&0===Gl.tag&&!(6&Cl)&&Ec();var t=Cl;Cl|=1;var n=Il.transition,r=bt;try{if(Il.transition=null,bt=1,e)return e()}finally{bt=r,Il.transition=n,!(6&(Cl=t))&&Wi()}}function dc(){Rl=Ol.current,xi(Ol)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Oi();break;case 3:Jo(),xi(Ni),xi(Ci),rs();break;case 5:Zo(r);break;case 4:Jo();break;case 13:case 19:xi(es);break;case 10:Co(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Nl=e,Al=e=Oc(e.current,null),Dl=Rl=t,Ll=0,Pl=null,Ul=Fl=Ml=0,Vl=zl=null,null!==Ro){for(t=0;t<Ro.length;t++)if(null!==(r=(n=Ro[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var s=o.next;o.next=i,r.next=s}n.pending=r}Ro=null}return e}function fc(e,t){for(;;){var n=Al;try{if(Io(),is.current=Xs,us){for(var r=as.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}us=!1}if(ss=0,cs=ls=as=null,ds=!1,hs=0,Tl.current=null,null===n||null===n.return){Ll=1,Pl=t,Al=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=Dl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,d=l,h=d.tag;if(!(1&d.mode||0!==h&&11!==h&&15!==h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ga(a);if(null!==p){p.flags&=-257,va(p,a,l,0,t),1&p.mode&&ma(s,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(!(1&t)){ma(s,u,t),mc();break e}c=Error(o(426))}else if(io&&1&l.mode){var v=ga(a);if(null!==v){!(65536&v.flags)&&(v.flags|=256),va(v,a,l,0,t),mo(ca(c,l));break e}}s=c=ca(c,l),4!==Ll&&(Ll=2),null===zl?zl=[s]:zl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Wo(s,fa(0,c,t));break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(128&s.flags||"function"!=typeof y.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==Hl&&Hl.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Wo(s,pa(s,l,t));break e}}s=s.return}while(null!==s)}wc(n)}catch(e){t=e,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function pc(){var e=xl.current;return xl.current=Xs,null===e?Xs:e}function mc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Nl||!(268435455&Ml)&&!(268435455&Fl)||ac(Nl,Dl)}function gc(e,t){var n=Cl;Cl|=2;var r=pc();for(Nl===e&&Dl===t||($l=null,hc(e,t));;)try{vc();break}catch(t){fc(e,t)}if(Io(),Cl=n,xl.current=r,null!==Al)throw Error(o(261));return Nl=null,Dl=0,Ll}function vc(){for(;null!==Al;)bc(Al)}function yc(){for(;null!==Al&&!Qe();)bc(Al)}function bc(e){var t=kl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?wc(e):Al=t,Tl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=Ga(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Ll=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Ka(n,t,Rl)))return void(Al=n);if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Ll&&(Ll=5)}function Sc(e,t,n){var r=bt,i=Il.transition;try{Il.transition=null,bt=1,function(e,t,n,r){do{Ec()}while(null!==Gl);if(6&Cl)throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-st(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,s),e===Nl&&(Al=Nl=null,Dl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Kl||(Kl=!0,Nc(tt,(function(){return Ec(),null}))),s=!!(15990&n.flags),!!(15990&n.subtreeFlags)||s){s=Il.transition,Il.transition=null;var a=bt;bt=1;var l=Cl;Cl|=4,Tl.current=null,function(e,t){if(ei=Bt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(e){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=a+i),h!==s||0!==r&&3!==h.nodeType||(c=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=a),f===s&&++d===r&&(c=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Bt=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,1028&t.subtreeFlags&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var m=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(o(163))}}catch(e){_c(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}m=tl,tl=!1}(e,n),gl(n,e),pr(ti),Bt=!!ei,ti=ei=null,e.current=n,yl(n,e,i),Ye(),Cl=l,bt=a,Il.transition=s}else e.current=n;if(Kl&&(Kl=!1,Gl=e,Ql=i),s=e.pendingLanes,0===s&&(Hl=null),function(e){if(ot&&"function"==typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),rc(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Bl)throw Bl=!1,e=ql,ql=null,e;!!(1&Ql)&&0!==e.tag&&Ec(),s=e.pendingLanes,1&s?e===Jl?Yl++:(Yl=0,Jl=e):Yl=0,Wi()}(e,t,n,r)}finally{Il.transition=i,bt=r}return null}function Ec(){if(null!==Gl){var e=wt(Ql),t=Il.transition,n=bt;try{if(Il.transition=null,bt=16>e?16:e,null===Gl)var r=!1;else{if(e=Gl,Gl=null,Ql=0,6&Cl)throw Error(o(331));var i=Cl;for(Cl|=4,Xa=e.current;null!==Xa;){var s=Xa,a=s.child;if(16&Xa.flags){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Xa=u;null!==Xa;){var d=Xa;switch(d.tag){case 0:case 11:case 15:nl(8,d,s)}var h=d.child;if(null!==h)h.return=d,Xa=h;else for(;null!==Xa;){var f=(d=Xa).sibling,p=d.return;if(ol(d),d===u){Xa=null;break}if(null!==f){f.return=p,Xa=f;break}Xa=p}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Xa=s}}if(2064&s.subtreeFlags&&null!==a)a.return=s,Xa=a;else e:for(;null!==Xa;){if(2048&(s=Xa).flags)switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Xa=y;break e}Xa=s.return}}var b=e.current;for(Xa=b;null!==Xa;){var w=(a=Xa).child;if(2064&a.subtreeFlags&&null!==w)w.return=a,Xa=w;else e:for(a=b;null!==Xa;){if(2048&(l=Xa).flags)try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(e){_c(l,l.return,e)}if(l===a){Xa=null;break e}var S=l.sibling;if(null!==S){S.return=l.return,Xa=S;break e}Xa=l.return}}if(Cl=i,Wi(),ot&&"function"==typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(e){}r=!0}return r}finally{bt=n,Il.transition=t}}return!1}function kc(e,t,n){e=Vo(e,t=fa(0,t=ca(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function _c(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Hl||!Hl.has(r))){t=Vo(t,e=pa(t,e=ca(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function xc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Nl===e&&(Dl&n)===n&&(4===Ll||3===Ll&&(130023424&Dl)===Dl&&500>Je()-jl?hc(e,0):Ul|=n),rc(e,t)}function Tc(e,t){0===t&&(1&e.mode?(t=ut,!(130023424&(ut<<=1))&&(ut=4194304)):t=1);var n=ec();null!==(e=Po(e,t))&&(vt(e,t,n),rc(e,n))}function Ic(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Tc(e,n)}function Nc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,n,r){return new Ac(e,t,n,r)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,r,i,s){var a=2;if(r=e,"function"==typeof e)Rc(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case k:return Pc(n.children,i,s,t);case _:a=8,i|=8;break;case x:return(e=Dc(12,n,t,2|i)).elementType=x,e.lanes=s,e;case N:return(e=Dc(13,n,t,i)).elementType=N,e.lanes=s,e;case A:return(e=Dc(19,n,t,i)).elementType=A,e.lanes=s,e;case O:return Mc(n,i,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case T:a=10;break e;case I:a=9;break e;case C:a=11;break e;case D:a=14;break e;case R:a=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Dc(a,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function Pc(e,t,n,r){return(e=Dc(7,e,r,t)).lanes=n,e}function Mc(e,t,n,r){return(e=Dc(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Dc(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,r,i,o,s,a,l){return e=new zc(e,t,n,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Dc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fo(o),e}function jc(e){if(!e)return Ii;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ri(n))return Pi(e,n,t)}return t}function Wc(e,t,n,r,i,o,s,a,l){return(e=Vc(n,r,!0,e,0,o,0,a,l)).context=jc(null),n=e.current,(o=zo(r=ec(),i=tc(n))).callback=null!=t?t:null,Vo(n,o,i),e.current.lanes=i,vt(e,i,r),rc(e,r),e}function $c(e,t,n,r){var i=t.current,o=ec(),s=tc(i);return n=jc(n),null===t.context?t.context=n:t.pendingContext=n,(t=zo(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Vo(i,t,s))&&(nc(e,i,s,o),jo(e,i,s)),s}function Bc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}kl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ni.current)ba=!0;else{if(!(e.lanes&n||128&t.flags))return ba=!1,function(e,t,n){switch(t.tag){case 3:Na(t),po();break;case 5:Xo(t);break;case 1:Ri(t.type)&&Mi(t);break;case 4:Yo(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ti(ko,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ti(es,1&es.current),t.flags|=128,null):n&t.child.childLanes?Fa(e,t,n):(Ti(es,1&es.current),null!==(e=Ba(e,t,n))?e.sibling:null);Ti(es,1&es.current);break;case 19:if(r=!!(n&t.childLanes),128&e.flags){if(r)return Wa(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(es,es.current),r)break;return null;case 22:case 23:return t.lanes=0,_a(e,t,n)}return Ba(e,t,n)}(e,t,n);ba=!!(131072&e.flags)}else ba=!1,io&&1048576&t.flags&&Zi(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;$a(e,t),e=t.pendingProps;var i=Di(t,Ci.current);Ao(t,n),i=gs(null,t,r,e,i,n);var s=vs();return t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(r)?(s=!0,Mi(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Fo(t),i.updater=ia,t.stateNode=i,i._reactInternals=t,la(t,r,e,n),t=Ca(null,t,r,!0,s,n)):(t.tag=0,io&&s&&eo(t),wa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch($a(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"==typeof e)return Rc(e)?1:0;if(null!=e){if((e=e.$$typeof)===C)return 11;if(e===D)return 14}return 2}(r),e=na(r,e),i){case 0:t=Ta(null,t,r,e,n);break e;case 1:t=Ia(null,t,r,e,n);break e;case 11:t=Sa(null,t,r,e,n);break e;case 14:t=Ea(null,t,r,na(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ta(e,t,r,i=t.elementType===r?i:na(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ia(e,t,r,i=t.elementType===r?i:na(r,i),n);case 3:e:{if(Na(t),null===e)throw Error(o(387));r=t.pendingProps,i=(s=t.memoizedState).element,Uo(e,t),$o(t,r,null,n);var a=t.memoizedState;if(r=a.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Aa(e,t,r,n,i=ca(Error(o(423)),t));break e}if(r!==i){t=Aa(e,t,r,n,i=ca(Error(o(424)),t));break e}for(ro=ci(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=Eo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(po(),r===i){t=Ba(e,t,n);break e}wa(e,t,r,n)}t=t.child}return t;case 5:return Xo(t),null===e&&co(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==s&&ni(r,s)&&(t.flags|=32),xa(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&co(t),null;case 13:return Fa(e,t,n);case 4:return Yo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=So(t,null,r,n):wa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Sa(e,t,r,i=t.elementType===r?i:na(r,i),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Ti(ko,r._currentValue),r._currentValue=a,null!==s)if(ar(s.value,a)){if(s.children===i.children&&!Ni.current){t=Ba(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=zo(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),No(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),No(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}wa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ao(t,n),r=r(i=Do(i)),t.flags|=1,wa(e,t,r,n),t.child;case 14:return i=na(r=t.type,t.pendingProps),Ea(e,t,r,i=na(r.type,i),n);case 15:return ka(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:na(r,i),$a(e,t),t.tag=1,Ri(r)?(e=!0,Mi(t)):e=!1,Ao(t,n),sa(t,r,i),la(t,r,i,n),Ca(null,t,r,!0,e,n);case 19:return Wa(e,t,n);case 22:return _a(e,t,n)}throw Error(o(156,t.tag))};var Kc="function"==typeof reportError?reportError:function(e){console.error(e)};function Gc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if("function"==typeof i){var a=i;i=function(){var e=Bc(s);a.call(e)}}$c(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"==typeof r){var o=r;r=function(){var e=Bc(s);o.call(e)}}var s=Wc(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=s,e[pi]=s.current,Wr(8===e.nodeType?e.parentNode:e),uc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"==typeof r){var a=r;r=function(){var e=Bc(l);a.call(e)}}var l=Vc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[pi]=l.current,Wr(8===e.nodeType?e.parentNode:e),uc((function(){$c(t,l,n,r)})),l}(n,t,e,i,r);return Bc(s)}Qc.prototype.render=Gc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));$c(e,t,null,null)},Qc.prototype.unmount=Gc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){$c(null,e,null,null)})),t[pi]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=_t();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Ft(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Je()),!(6&Cl)&&(Wl=Je()+500,Wi()))}break;case 13:uc((function(){var t=Po(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Hc(e,1)}},Et=function(e){if(13===e.tag){var t=Po(e,134217728);if(null!==t)nc(t,e,134217728,ec());Hc(e,134217728)}},kt=function(e){if(13===e.tag){var t=tc(e),n=Po(e,t);if(null!==n)nc(n,e,t,ec());Hc(e,t)}},_t=function(){return bt},xt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ee=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Si(r);if(!i)throw Error(o(90));K(r),X(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=cc,Ne=uc;var eu={usingClientEntryPoint:!1,Events:[bi,wi,Si,Te,Ie,cc]},tu={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),ot=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(o(299));var n=!1,r="",i=Kc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Wr(8===e.nodeType?e.parentNode:e),new Gc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(o(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,s="",a=Kc;if(null!=n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,i,0,s,a),e[pi]=t.current,Wr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Qc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(o(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(o(40));return!!e._reactRootContainer&&(uc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},5338:(e,t,n)=>{var r=n(961);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},961:(e,t,n)=>{!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(2551)},5287:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var S=Array.isArray,E=Object.prototype.hasOwnProperty,k={current:null},_={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,r){var i,o={},s=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)E.call(t,i)&&!_.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:e,key:s,ref:a,props:o,_owner:k.current}}function T(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function C(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===o?"."+C(l,0):o,S(s)?(i="",null!=e&&(i=e.replace(I,"$&/")+"/"),N(s,t,i,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(I,"$&/")+"/")+e)),t.push(s)),1;if(l=0,o=""===o?".":o+":",S(e))for(var c=0;c<e.length;c++){var u=o+C(a=e[c],c);l+=N(a,t,i,u,s)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=N(a=a.value,t,i,u=o+C(a,c++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},O={transition:null},L={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:O,ReactCurrentOwner:k};function P(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.act=P,t.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=k.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!_.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:o,ref:s,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=P,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},6540:(e,t,n)=>{e.exports=n(5287)},7463:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,O(E);else{var t=r(u);null!==t&&L(S,t.startTime-e)}}function E(e,n){m=!1,g&&(g=!1,y(T),T=-1),p=!0;var o=f;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!N());){var s=h.callback;if("function"==typeof s){h.callback=null,f=h.priorityLevel;var a=s(h.expirationTime<=n);n=t.unstable_now(),"function"==typeof a?h.callback=a:h===r(c)&&i(c),w(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&L(S,d.startTime-n),l=!1}return l}finally{h=null,f=o,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,_=!1,x=null,T=-1,I=5,C=-1;function N(){return!(t.unstable_now()-C<I)}function A(){if(null!==x){var e=t.unstable_now();C=e;var n=!0;try{n=x(!0,e)}finally{n?k():(_=!1,x=null)}}else _=!1}if("function"==typeof b)k=function(){b(A)};else if("undefined"!=typeof MessageChannel){var D=new MessageChannel,R=D.port2;D.port1.onmessage=A,k=function(){R.postMessage(null)}}else k=function(){v(A,0)};function O(e){x=e,_||(_=!0,k())}function L(e,n){T=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,O(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"==typeof o&&null!==o?o="number"==typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(g?(y(T),T=-1):g=!0,L(S,o-s))):(e.sortIndex=a,n(c,e),m||p||(m=!0,O(E))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},9982:(e,t,n)=>{e.exports=n(7463)},8542:(e,t,n)=>{n.r(t),n.d(t,{app:()=>c,auth:()=>u,firestore:()=>d});var r,i=n(223),o=n(5908),s=n(2405);const a="undefined"!=typeof chrome&&(null===(r=chrome.runtime)||void 0===r?void 0:r.id),l={apiKey:"AIzaSyAVxAdCx5JW0K7o5B53p_fThHYUPtWRQF4",authDomain:"vidlearn-ai.firebaseapp.com",projectId:"vidlearn-ai",storageBucket:"vidlearn-ai.firebasestorage.app",messagingSenderId:"1097713470067",appId:"1:1097713470067:web:821f08db03951f83363806"},c=(0,i.Wp)(l),u=(0,o.xI)(c),d=(0,s.aU)(c);if(a){console.log("WordStream: Running in Chrome extension environment");const e=chrome.runtime.id?`chrome-extension://${chrome.runtime.id}`:"";e&&console.log(`WordStream: Extension origin: ${e}`)}console.log("WordStream: Firebase initialized with config:",Object.keys(l).filter((e=>"apiKey"!==e)).join(", "))},768:(e,t,n)=>{function r(e,t=new Date){try{if(!e)return t;if("[object Object]"===e||"[object Object"===e||"string"==typeof e&&(e.includes("[object Object]")||e.includes("[object Object"))||e&&"function"==typeof e.toString&&("[object Object]"===e.toString()||"[object Object"===e.toString()))return console.log("WordStream: Intercepted [object Object] value in safeDate, using default date"),t;if(e instanceof Date)return isNaN(e.getTime())?t:e;if(e&&"object"==typeof e&&"function"==typeof e.toDate)try{const t=e.toDate();if(!isNaN(t.getTime()))return t}catch(e){}if(e&&"object"==typeof e&&"seconds"in e)try{const t="number"==typeof e.seconds?e.seconds:parseInt(String(e.seconds),10);if(!isNaN(t)){const e=new Date(1e3*t);if(!isNaN(e.getTime()))return e}}catch(e){}if("number"==typeof e){const n=e<1e10?new Date(1e3*e):new Date(e);return isNaN(n.getTime())||n.getFullYear()<1970||n.getFullYear()>2100?(console.warn("WordStream: Invalid timestamp value:",e),t):n}if("string"==typeof e){if(e.startsWith("[object")||e.includes("undefined")||e.includes("null"))return t;if(e.includes("seconds")&&e.includes("nanoseconds"))try{const t=JSON.parse(e);if(t.seconds)return new Date(1e3*t.seconds)}catch(e){}const n=new Date(e);return isNaN(n.getTime())?(console.warn("WordStream: Invalid date string format:",e),t):n.getFullYear()<1970||n.getFullYear()>2100?(console.warn("WordStream: Date value out of reasonable range:",e),t):n}if(e&&"object"==typeof e){const n=["time","date","timestamp","created","createdAt","modified","modifiedAt","updated","updatedAt"];for(const i of n)if(i in e&&null!==e[i]&&void 0!==e[i])try{return r(e[i],t)}catch(e){}}const n=new Date(String(e));return isNaN(n.getTime())?(console.warn("WordStream: Failed to convert value to date:",e),t):n.getFullYear()<1970||n.getFullYear()>2100?(console.warn("WordStream: Converted date out of reasonable range:",e),t):n}catch(e){return console.warn("WordStream: Error parsing date value:",e),t}}function i(e){if(!e)return!1;if("number"==typeof e){const t=new Date(e);return!isNaN(t.getTime())&&t.getFullYear()>=1970&&t.getFullYear()<=2100}if(e instanceof Date)return!isNaN(e.getTime())&&e.getFullYear()>=1970&&e.getFullYear()<=2100;try{const t=new Date(String(e));return!isNaN(t.getTime())&&t.getFullYear()>=1970&&t.getFullYear()<=2100}catch(e){return!1}}function o(e){if(null==e)return new Date;try{if("[object Object]"===e||"[object Object"===e||"string"==typeof e&&(e.includes("[object Object]")||e.includes("[object Object"))||e&&"function"==typeof e.toString&&("[object Object]"===e.toString()||"[object Object"===e.toString()))return console.log("WordStream: Intercepted [object Object] value, using current date"),new Date;if(e instanceof Date)return i(e)?e:new Date;if(e&&"object"==typeof e&&"function"==typeof e.toDate)try{const t=e.toDate();return i(t)?t:new Date}catch(e){}if(e&&"object"==typeof e&&"seconds"in e)try{const t="number"==typeof e.seconds?e.seconds:parseInt(String(e.seconds),10);if(!isNaN(t)){const e=new Date(1e3*t);return i(e)?e:new Date}}catch(e){}if("string"==typeof e){if(e.startsWith("[object")||e.includes("undefined")||e.includes("null"))return new Date;if(e.includes("seconds")||e.includes("nanoseconds"))try{const t=JSON.parse(e);if(t&&t.seconds){const e="number"==typeof t.seconds?t.seconds:parseInt(String(t.seconds),10);if(!isNaN(e)){const t=new Date(1e3*e);return i(t)?t:new Date}}}catch(e){}try{const t=new Date(e);if(i(t))return t}catch(e){}const t=e.match(/(\d+)/);if(t&&t[1]){const e=parseInt(t[1],10);if(!isNaN(e)){const t=e<1e10?new Date(1e3*e):new Date(e);if(i(t))return t}}}if("number"==typeof e)try{const t=e<1e10?new Date(1e3*e):new Date(e);return i(t)?t:new Date}catch(e){}if(e&&"object"==typeof e){const t=["time","date","timestamp","created","createdAt","modified","modifiedAt","updated","updatedAt"];for(const n of t)if(n in e&&null!==e[n]&&void 0!==e[n]){const t=e[n];if(t instanceof Date)return i(t)?t:new Date;if("object"==typeof t&&t&&"function"==typeof t.toDate)try{const e=t.toDate();return i(e)?e:new Date}catch(e){}if("object"==typeof t&&t&&"seconds"in t)try{const e="number"==typeof t.seconds?t.seconds:parseInt(String(t.seconds),10);if(!isNaN(e)){const t=new Date(1e3*e);return i(t)?t:new Date}}catch(e){}try{const e=String(t);if(e.includes("[object"))continue;const n=new Date(e);if(i(n))return n}catch(e){}}for(const n in e){const r=e[n];if(r&&"object"==typeof r)for(const e of t)if(e in r&&null!==r[e]&&void 0!==r[e])try{const t=o(r[e]);if(t)return t}catch(e){}}}return new Date}catch(e){return console.log("WordStream: Date conversion error suppressed, using current date"),new Date}}n.d(t,{cP:()=>o,u:()=>r})},8461:(e,t,n)=>{n.d(t,{KO:()=>X,MF:()=>Q,Sx:()=>J,Wp:()=>Y,j6:()=>B,om:()=>$,xZ:()=>q});var r=n(5125),i=n(3424),o=n(6743),s=n(602);class a{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const l="@firebase/app",c="0.11.3",u=new i.Vy("@firebase/app"),d="@firebase/app-compat",h="@firebase/analytics-compat",f="@firebase/analytics",p="@firebase/app-check-compat",m="@firebase/app-check",g="@firebase/auth",v="@firebase/auth-compat",y="@firebase/database",b="@firebase/data-connect",w="@firebase/database-compat",S="@firebase/functions",E="@firebase/functions-compat",k="@firebase/installations",_="@firebase/installations-compat",x="@firebase/messaging",T="@firebase/messaging-compat",I="@firebase/performance",C="@firebase/performance-compat",N="@firebase/remote-config",A="@firebase/remote-config-compat",D="@firebase/storage",R="@firebase/storage-compat",O="@firebase/firestore",L="@firebase/vertexai",P="@firebase/firestore-compat",M="firebase",F="[DEFAULT]",U={[l]:"fire-core",[d]:"fire-core-compat",[f]:"fire-analytics",[h]:"fire-analytics-compat",[m]:"fire-app-check",[p]:"fire-app-check-compat",[g]:"fire-auth",[v]:"fire-auth-compat",[y]:"fire-rtdb",[b]:"fire-data-connect",[w]:"fire-rtdb-compat",[S]:"fire-fn",[E]:"fire-fn-compat",[k]:"fire-iid",[_]:"fire-iid-compat",[x]:"fire-fcm",[T]:"fire-fcm-compat",[I]:"fire-perf",[C]:"fire-perf-compat",[N]:"fire-rc",[A]:"fire-rc-compat",[D]:"fire-gcs",[R]:"fire-gcs-compat",[O]:"fire-fst",[P]:"fire-fst-compat",[L]:"fire-vertex","fire-js":"fire-js",[M]:"fire-js-all"},z=new Map,V=new Map,j=new Map;function W(e,t){try{e.container.addComponent(t)}catch(n){u.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function $(e){const t=e.name;if(j.has(t))return u.debug(`There were multiple attempts to register component ${t}.`),!1;j.set(t,e);for(const t of z.values())W(t,e);for(const t of V.values())W(t,e);return!0}function B(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function q(e){return null!=e&&void 0!==e.settings}const H={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},K=new o.FA("app","Firebase",H);class G{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw K.create("app-deleted",{appName:this._name})}}const Q="11.5.0";function Y(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const i=Object.assign({name:F,automaticDataCollectionEnabled:!1},t),s=i.name;if("string"!=typeof s||!s)throw K.create("bad-app-name",{appName:String(s)});if(n||(n=(0,o.T9)()),!n)throw K.create("no-options");const a=z.get(s);if(a){if((0,o.bD)(n,a.options)&&(0,o.bD)(i,a.config))return a;throw K.create("duplicate-app",{appName:s})}const l=new r.h1(s);for(const e of j.values())l.addComponent(e);const c=new G(n,i,l);return z.set(s,c),c}function J(e=F){const t=z.get(e);if(!t&&e===F&&(0,o.T9)())return Y();if(!t)throw K.create("no-app",{appName:e});return t}function X(e,t,n){var i;let o=null!==(i=U[e])&&void 0!==i?i:e;n&&(o+=`-${n}`);const s=o.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const e=[`Unable to register library "${o}" with version "${t}":`];return s&&e.push(`library name "${o}" contains illegal characters (whitespace or "/")`),s&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void u.warn(e.join(" "))}$(new r.uA(`${o}-version`,(()=>({library:o,version:t})),"VERSION"))}const Z="firebase-heartbeat-store";let ee=null;function te(){return ee||(ee=(0,s.P2)("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Z)}catch(e){console.warn(e)}}}).catch((e=>{throw K.create("idb-open",{originalErrorMessage:e.message})}))),ee}async function ne(e,t){try{const n=(await te()).transaction(Z,"readwrite"),r=n.objectStore(Z);await r.put(t,re(e)),await n.done}catch(e){if(e instanceof o.g)u.warn(e.message);else{const t=K.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});u.warn(t.message)}}}function re(e){return`${e.name}!${e.options.appId}`}class ie{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new se(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=oe();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){u.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=oe(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),ae(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ae(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=(0,o.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return u.warn(e),""}}}function oe(){return(new Date).toISOString().substring(0,10)}class se{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,o.zW)()&&(0,o.eX)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await te()).transaction(Z),n=await t.objectStore(Z).get(re(e));return await t.done,n}catch(e){if(e instanceof o.g)u.warn(e.message);else{const t=K.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});u.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ne(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ne(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ae(e){return(0,o.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var le;le="",$(new r.uA("platform-logger",(e=>new a(e)),"PRIVATE")),$(new r.uA("heartbeat",(e=>new ie(e)),"PRIVATE")),X(l,c,le),X(l,c,"esm2017"),X("fire-js","")},5125:(e,t,n)=>{n.d(t,{h1:()=>a,uA:()=>i});var r=n(6743);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const o="[DEFAULT]";class s{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=o){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=o){return this.instances.has(e)}getOptions(e=o){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===o?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=o){return this.component?this.component.multipleInstances?e:o:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new s(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},3424:(e,t,n)=>{n.d(t,{$b:()=>i,Vy:()=>c});const r=[];var i;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));const o={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},s=i.INFO,a={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},l=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=a[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class c{constructor(e){this.name=e,this._logLevel=s,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?o[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...e),this._logHandler(this,i.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...e),this._logHandler(this,i.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,i.INFO,...e),this._logHandler(this,i.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,i.WARN,...e),this._logHandler(this,i.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,i.ERROR,...e),this._logHandler(this,i.ERROR,...e)}}},7773:(e,t,n)=>{n.d(t,{M:()=>r});const r=()=>{}},2429:(e,t,n)=>{n.d(t,{VV:()=>i,jz:()=>r});var r,i,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var o=e.g[3],s=t+(o^n&(i^o))+r[0]+3614090360&4294967295;s=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=n+(s<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^o&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^i^o)+r[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(i^(n|~o))+r[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~o))+r[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~o))+r[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(t=n+((s=t+(i^(n|~o))+r[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=o+((s=i+(t^(o|~n))+r[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+o&4294967295}function o(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var o=0|e[i];r&&o==t||(n[i]=o,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,o=this.h,s=0;s<t;){if(0==o)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(i[o++]=e.charCodeAt(s++),o==this.blockSize){n(this,i),o=0;break}}else for(;s<t;)if(i[o++]=e[s++],o==this.blockSize){n(this,i),o=0;break}}this.h=o,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var a={};function l(e){return-128<=e&&128>e?function(e,t){var n=a;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new o([0|e],0>e?-1:0)})):new o([0|e],0>e?-1:0)}function c(e){if(isNaN(e)||!isFinite(e))return u;if(0>e)return m(c(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new o(t,0)}var u=l(0),d=l(1),h=l(16777216);function f(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return-1==e.h}function m(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new o(n,~e.h).add(d)}function g(e,t){return e.add(m(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function y(e,t){this.g=e,this.h=t}function b(e,t){if(f(t))throw Error("division by zero");if(f(e))return new y(u,u);if(p(e))return t=b(m(e),t),new y(m(t.g),m(t.h));if(p(t))return t=b(e,m(t)),new y(m(t.g),t.h);if(30<e.g.length){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var n=d,r=t;0>=r.l(e);)n=w(n),r=w(r);var i=S(n,1),o=S(r,1);for(r=S(r,2),n=S(n,2);!f(r);){var s=o.add(r);0>=s.l(e)&&(i=i.add(n),o=s),r=S(r,1),n=S(n,1)}return t=g(e,i.j(t)),new y(i,t)}for(i=u;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),s=(o=c(n)).j(t);p(s)||0<s.l(e);)s=(o=c(n-=r)).j(t);f(o)&&(o=d),i=i.add(o),e=g(e,s)}return new y(i,e)}function w(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new o(n,e.h)}function S(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new o(i,e.h)}(e=o.prototype).m=function(){if(p(this))return-m(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(p(this))return"-"+m(this).toString(e);for(var t=c(Math.pow(e,6)),n=this,r="";;){var i=b(n,t).g,o=((0<(n=g(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(f(n=i))return o+r;for(;6>o.length;)o="0"+o;r=o+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return p(e=g(this,e))?-1:f(e)?0:1},e.abs=function(){return p(this)?m(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.i(i))+(65535&e.i(i)),a=(s>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=a>>>16,s&=65535,a&=65535,n[i]=a<<16|s}return new o(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(f(this)||f(e))return u;if(p(this))return p(e)?m(this).j(m(e)):m(m(this).j(e));if(p(e))return m(this.j(m(e)));if(0>this.l(h)&&0>e.l(h))return c(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.i(r)>>>16,a=65535&this.i(r),l=e.i(i)>>>16,d=65535&e.i(i);n[2*r+2*i]+=a*d,v(n,2*r+2*i),n[2*r+2*i+1]+=s*d,v(n,2*r+2*i+1),n[2*r+2*i+1]+=a*l,v(n,2*r+2*i+1),n[2*r+2*i+2]+=s*l,v(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new o(n,0)},e.A=function(e){return b(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new o(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new o(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new o(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,i=s.Md5=t,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return m(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=c(Math.pow(n,8)),i=u,o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o),a=parseInt(t.substring(o,o+s),n);8>s?(s=c(Math.pow(n,s)),i=i.j(s).add(c(a))):i=(i=i.j(r)).add(c(a))}return i},r=s.Integer=o}).apply(void 0!==o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},1853:(e,t,n)=>{n.d(t,{Ao:()=>c,Bx:()=>o,Jh:()=>l,O4:()=>s,ZS:()=>r,fF:()=>u,iO:()=>i,ro:()=>a});var r,i,o,s,a,l,c,u,d="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},h={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof d&&d];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var s=e[o];if(!(s in i))break e;i=i[s]}(r=r(o=i[e=e[e.length-1]]))!=o&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var f=f||{},p=this||self;function m(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function g(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function v(e,t,n){return e.call.apply(e.bind,arguments)}function y(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function b(e,t,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?v:y).apply(null,arguments)}function w(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function S(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function E(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function k(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(m(n)){const t=e.length||0,r=n.length||0;e.length=t+r;for(let i=0;i<r;i++)e[t+i]=n[i]}else e.push(n)}}function _(e){return/^[\s\xa0]*$/.test(e)}function x(){var e=p.navigator;return e&&(e=e.userAgent)?e:""}function T(e){return T[" "](e),e}T[" "]=function(){};var I=!(-1==x().indexOf("Gecko")||-1!=x().toLowerCase().indexOf("webkit")&&-1==x().indexOf("Edge")||-1!=x().indexOf("Trident")||-1!=x().indexOf("MSIE")||-1!=x().indexOf("Edge"));function C(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function N(e){const t={};for(const n in e)t[n]=e[n];return t}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<A.length;t++)n=A[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function R(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function O(e){p.setTimeout((()=>{throw e}),0)}function L(){var e=z;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var P=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new M),(e=>e.reset()));class M{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let F,U=!1,z=new class{constructor(){this.h=this.g=null}add(e,t){const n=P.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},V=()=>{const e=p.Promise.resolve(void 0);F=()=>{e.then(j)}};var j=()=>{for(var e;e=L();){try{e.h.call(e.g)}catch(e){O(e)}var t=P;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}U=!1};function W(){this.s=this.s,this.C=this.C}function $(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},$.prototype.h=function(){this.defaultPrevented=!0};var B=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};p.addEventListener("test",e,t),p.removeEventListener("test",e,t)}catch(e){}return e}();function q(e,t){if($.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(I){e:{try{T(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:H[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&q.aa.h.call(this)}}S(q,$);var H={2:"touch",3:"pen",4:"mouse"};q.prototype.h=function(){q.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var K="closure_listenable_"+(1e6*Math.random()|0),G=0;function Q(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++G,this.da=this.fa=!1}function Y(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function J(e){this.src=e,this.g={},this.h=0}function X(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],o=Array.prototype.indexOf.call(i,t,void 0);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Y(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Z(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.da&&o.listener==t&&o.capture==!!n&&o.ha==r)return i}return-1}J.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);var s=Z(e,t,r,i);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new Q(t,this.src,o,!!r,i)).fa=n,e.push(t)),t};var ee="closure_lm_"+(1e6*Math.random()|0),te={};function ne(e,t,n,r,i){if(r&&r.once)return ie(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)ne(e,t[o],n,r,i);return null}return n=de(n),e&&e[K]?e.K(t,n,g(r)?!!r.capture:!!r,i):re(e,t,n,!1,r,i)}function re(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var s=g(i)?!!i.capture:!!i,a=ce(e);if(a||(e[ee]=a=new J(e)),(n=a.add(t,n,r,s,o)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=le;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)B||(i=s),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(ae(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ie(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)ie(e,t[o],n,r,i);return null}return n=de(n),e&&e[K]?e.L(t,n,g(r)?!!r.capture:!!r,i):re(e,t,n,!0,r,i)}function oe(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)oe(e,t[o],n,r,i);else r=g(r)?!!r.capture:!!r,n=de(n),e&&e[K]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Z(o=e.g[t],n,r,i))&&(Y(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[t],e.h--)))):e&&(e=ce(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Z(t,n,r,i)),(n=-1<e?t[e]:null)&&se(n))}function se(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[K])X(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ae(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ce(t))?(X(n,e),0==n.h&&(n.src=null,t[ee]=null)):Y(e)}}}function ae(e){return e in te?te[e]:te[e]="on"+e}function le(e,t){if(e.da)e=!0;else{t=new q(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&se(e),e=n.call(r,t)}return e}function ce(e){return(e=e[ee])instanceof J?e:null}var ue="__closure_events_fn_"+(1e9*Math.random()>>>0);function de(e){return"function"==typeof e?e:(e[ue]||(e[ue]=function(t){return e.handleEvent(t)}),e[ue])}function he(){W.call(this),this.i=new J(this),this.M=this,this.F=null}function fe(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"==typeof t)t=new $(t,e);else if(t instanceof $)t.target=t.target||e;else{var i=t;D(t=new $(r,e),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=t.g=n[o];i=pe(s,r,!0,t)&&i}if(i=pe(s=t.g=e,r,!0,t)&&i,i=pe(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)i=pe(s=t.g=n[o],r,!1,t)&&i}function pe(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.da&&s.capture==n){var a=s.listener,l=s.ha||s.src;s.fa&&X(e.i,s),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}function me(e,t,n){if("function"==typeof e)n&&(e=b(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=b(e.handleEvent,e)}return 2147483647<Number(t)?-1:p.setTimeout(e,t||0)}function ge(e){e.g=me((()=>{e.g=null,e.i&&(e.i=!1,ge(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}S(he,W),he.prototype[K]=!0,he.prototype.removeEventListener=function(e,t,n,r){oe(this,e,t,n,r)},he.prototype.N=function(){if(he.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Y(n[r]);delete t.g[e],t.h--}}this.F=null},he.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},he.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ve extends W{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ge(this)}N(){super.N(),this.g&&(p.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ye(e){W.call(this),this.h=e,this.g={}}S(ye,W);var be=[];function we(e){C(e.g,(function(e,t){this.g.hasOwnProperty(t)&&se(e)}),e),e.g={}}ye.prototype.N=function(){ye.aa.N.call(this),we(this)},ye.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Se=p.JSON.stringify,Ee=p.JSON.parse,ke=class{stringify(e){return p.JSON.stringify(e,void 0)}parse(e){return p.JSON.parse(e,void 0)}};function _e(){}function xe(e){return e.h||(e.h=e.i())}function Te(){}_e.prototype.h=null;var Ie={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ce(){$.call(this,"d")}function Ne(){$.call(this,"c")}S(Ce,$),S(Ne,$);var Ae={},De=null;function Re(){return De=De||new he}function Oe(e){$.call(this,Ae.La,e)}function Le(e){const t=Re();fe(t,new Oe(t))}function Pe(e,t){$.call(this,Ae.STAT_EVENT,e),this.stat=t}function Me(e){const t=Re();fe(t,new Pe(t,e))}function Fe(e,t){$.call(this,Ae.Ma,e),this.size=t}function Ue(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return p.setTimeout((function(){e()}),t)}function ze(){this.g=!0}function Ve(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Se(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Ae.La="serverreachability",S(Oe,$),Ae.STAT_EVENT="statevent",S(Pe,$),Ae.Ma="timingevent",S(Fe,$),ze.prototype.xa=function(){this.g=!1},ze.prototype.info=function(){};var je,We={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},$e={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Be(){}function qe(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new ye(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new He}function He(){this.i=null,this.g="",this.h=!1}S(Be,_e),Be.prototype.g=function(){return new XMLHttpRequest},Be.prototype.i=function(){return{}},je=new Be;var Ke={},Ge={};function Qe(e,t,n){e.L=1,e.v=St(gt(t)),e.m=n,e.P=!0,Ye(e,null)}function Ye(e,t){e.F=Date.now(),Ze(e),e.A=gt(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Pt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new He,e.g=kn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ve(b(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(be[0]=i.toString()),i=be);for(var o=0;o<i.length;o++){var s=ne(n,i[o],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?N(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Le(),function(e,t,n,r,i,o){e.info((function(){if(e.g)if(o)for(var s="",a=o.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");s=2<=d.length&&"type"==d[1]?s+(u+"=")+c+"&":s+(u+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Je(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Xe(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ge:(n=Number(t.substring(n,r)),isNaN(n)?Ke:(r+=1)+n>t.length?Ge:(t=t.slice(r,r+n),e.C=r+n,t))}function Ze(e){e.S=Date.now()+e.I,et(e,e.I)}function et(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ue(b(e.ba,e),t)}function tt(e){e.B&&(p.clearTimeout(e.B),e.B=null)}function nt(e){0==e.j.G||e.J||yn(e.j,e)}function rt(e){tt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,we(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function it(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||ct(n.h,e)))if(!e.K&&ct(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;vn(n),an(n)}pn(n),Me(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ue(b(n.Za,n),6e3));if(1>=lt(n.h)&&n.ca){try{n.ca()}catch(e){}n.ca=void 0}}else wn(n,11)}else if((e.K||n.g==e)&&vn(n),!_(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var o=r.h;o.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(ut(o,o.h),o.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,wt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((r=n).qa=En(r,r.J?r.ia:null,r.W),s.K){dt(r.h,s);var a=s,l=r.L;l&&(a.I=l),a.B&&(tt(a),Ze(a)),r.g=s}else fn(r);0<n.i.length&&cn(n)}else"stop"!=c[0]&&"close"!=c[0]||wn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?wn(n,7):sn(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Le()}catch(e){}}qe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==tn(e)?t.j():this.Y(e)},qe.prototype.Y=function(e){try{if(e==this.g)e:{const d=tn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||nn(this.g)))){this.J||4!=d||7==t||Le(),tt(this);var n=this.g.Z();this.X=n;t:if(Je(this)){var r=nn(this.g);e="";var i=r.length,o=4==tn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){rt(this),nt(this);var s="";break t}this.h.i=new p.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(o&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,o,s){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+s}))}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(a)){var c=a;break t}}c=null}if(!(n=c)){this.o=!1,this.s=3,Me(12),rt(this),nt(this);break e}Ve(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,it(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<s.length;){if(e=Xe(this,s),e==Ge){4==d&&(this.s=4,Me(14),n=!1),Ve(this.i,this.l,null,"[Incomplete Response]");break}if(e==Ke){this.s=4,Me(15),Ve(this.i,this.l,s,"[Invalid Chunk]"),n=!1;break}Ve(this.i,this.l,e,null),it(this,e)}if(Je(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=s.length||this.h.h||(this.s=1,Me(16),n=!1),this.o=this.o&&n,n){if(0<s.length&&!this.W){this.W=!0;var u=this.j;u.g==this&&u.ba&&!u.M&&(u.j.info("Great, no buffering proxy detected. Bytes received: "+s.length),mn(u),u.M=!0,Me(11))}}else Ve(this.i,this.l,s,"[Invalid Chunked Response]"),rt(this),nt(this)}else Ve(this.i,this.l,s,null),it(this,s);4==d&&rt(this),this.o&&!this.J&&(4==d?yn(this.j,this):(this.o=!1,Ze(this)))}else(function(e){const t={};e=(e.g&&2<=tn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(_(e[r]))continue;var n=R(e[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const o=t[i]||[];t[i]=o,o.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<s.indexOf("Unknown SID")?(this.s=3,Me(12)):(this.s=0,Me(13)),rt(this),nt(this)}}}catch(e){}},qe.prototype.cancel=function(){this.J=!0,rt(this)},qe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Le(),Me(17)),rt(this),this.s=2,nt(this)):et(this,this.S-e)};var ot=class{constructor(e,t){this.g=e,this.map=t}};function st(e){this.l=e||10,p.PerformanceNavigationTiming?e=0<(e=p.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(p.chrome&&p.chrome.loadTimes&&p.chrome.loadTimes()&&p.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function at(e){return!!e.h||!!e.g&&e.g.size>=e.j}function lt(e){return e.h?1:e.g?e.g.size:0}function ct(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ut(e,t){e.g?e.g.add(t):e.h=t}function dt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ht(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return E(e.i)}function ft(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(m(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(m(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(m(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}st.prototype.cancel=function(){if(this.i=ht(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var pt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof mt){this.h=e.h,vt(this,e.j),this.o=e.o,this.g=e.g,yt(this,e.s),this.l=e.l;var t=e.i,n=new Dt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),bt(this,n),this.m=e.m}else e&&(t=String(e).match(pt))?(this.h=!1,vt(this,t[1]||"",!0),this.o=Et(t[2]||""),this.g=Et(t[3]||"",!0),yt(this,t[4]),this.l=Et(t[5]||"",!0),bt(this,t[6]||"",!0),this.m=Et(t[7]||"")):(this.h=!1,this.i=new Dt(null,this.h))}function gt(e){return new mt(e)}function vt(e,t,n){e.j=n?Et(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function yt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function bt(e,t,n){t instanceof Dt?(e.i=t,function(e,t){t&&!e.j&&(Rt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Ot(this,t),Pt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=kt(t,Nt)),e.i=new Dt(t,e.h))}function wt(e,t,n){e.i.set(t,n)}function St(e){return wt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Et(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function kt(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,_t),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function _t(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}mt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(kt(t,Tt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(kt(t,Tt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(kt(n,"/"==n.charAt(0)?Ct:It,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",kt(n,At)),e.join("")};var xt,Tt=/[#\/\?@]/g,It=/[#\?:]/g,Ct=/[#\?]/g,Nt=/[#\?@]/g,At=/#/g;function Dt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Rt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Ot(e,t){Rt(e),t=Mt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Lt(e,t){return Rt(e),t=Mt(e,t),e.g.has(t)}function Pt(e,t,n){Ot(e,t),0<n.length&&(e.i=null,e.g.set(Mt(e,t),E(n)),e.h+=n.length)}function Mt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ft(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(e){}}function Ut(){this.g=new ke}function zt(e,t,n){const r=n||"";try{ft(e,(function(e,n){let i=e;g(e)&&(i=Se(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function Vt(e){this.l=e.Ub||null,this.j=e.eb||!1}function jt(e,t){he.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Wt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function $t(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Bt(e)}function Bt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function qt(e){let t="";return C(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Ht(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=qt(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):wt(e,t,n))}function Kt(e){he.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Dt.prototype).add=function(e,t){Rt(this),this.i=null,e=Mt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Rt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){Rt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){Rt(this);let t=[];if("string"==typeof e)Lt(this,e)&&(t=t.concat(this.g.get(Mt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Rt(this),this.i=null,Lt(this,e=Mt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const o=encodeURIComponent(String(r)),s=this.V(r);for(r=0;r<s.length;r++){var i=o;""!==s[r]&&(i+="="+encodeURIComponent(String(s[r]))),e.push(i)}}return this.i=e.join("&")},S(Vt,_e),Vt.prototype.g=function(){return new jt(this.l,this.j)},Vt.prototype.i=(xt={},function(){return xt}),S(jt,he),(e=jt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Bt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||p).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,$t(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Bt(this)),this.g&&(this.readyState=3,Bt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==p.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Wt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?$t(this):Bt(this),3==this.readyState&&Wt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,$t(this))},e.Qa=function(e){this.g&&(this.response=e,$t(this))},e.ga=function(){this.g&&$t(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(jt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),S(Kt,he);var Gt=/^https?$/i,Qt=["POST","PUT"];function Yt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Jt(e),Zt(e)}function Jt(e){e.A||(e.A=!0,fe(e,"complete"),fe(e,"error"))}function Xt(e){if(e.h&&void 0!==f&&(!e.v[1]||4!=tn(e)||2!=e.Z()))if(e.u&&4==tn(e))me(e.Ea,0,e);else if(fe(e,"readystatechange"),4==tn(e)){e.h=!1;try{const s=e.Z();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===s){var i=String(e.D).match(pt)[1]||null;!i&&p.self&&p.self.location&&(i=p.self.location.protocol.slice(0,-1)),r=!Gt.test(i?i.toLowerCase():"")}n=r}if(n)fe(e,"complete"),fe(e,"success");else{e.m=6;try{var o=2<tn(e)?e.g.statusText:""}catch(e){o=""}e.l=o+" ["+e.Z()+"]",Jt(e)}}finally{Zt(e)}}}function Zt(e,t){if(e.g){en(e);const n=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||fe(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function en(e){e.I&&(p.clearTimeout(e.I),e.I=null)}function tn(e){return e.g?e.g.readyState:0}function nn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function rn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function on(e){this.Aa=0,this.i=[],this.j=new ze,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rn("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rn("baseRetryDelayMs",5e3,e),this.cb=rn("retryDelaySeedMs",1e4,e),this.Wa=rn("forwardChannelMaxRetries",2,e),this.wa=rn("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new st(e&&e.concurrentRequestLimit),this.Da=new Ut,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function sn(e){if(ln(e),3==e.G){var t=e.U++,n=gt(e.I);if(wt(n,"SID",e.K),wt(n,"RID",t),wt(n,"TYPE","terminate"),dn(e,n),(t=new qe(e,e.j,t)).L=2,t.v=St(gt(n)),n=!1,p.navigator&&p.navigator.sendBeacon)try{n=p.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&p.Image&&((new Image).src=t.v,n=!0),n||(t.g=kn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Ze(t)}Sn(e)}function an(e){e.g&&(mn(e),e.g.cancel(),e.g=null)}function ln(e){an(e),e.u&&(p.clearTimeout(e.u),e.u=null),vn(e),e.h.cancel(),e.s&&("number"==typeof e.s&&p.clearTimeout(e.s),e.s=null)}function cn(e){if(!at(e.h)&&!e.s){e.s=!0;var t=e.Ga;F||V(),U||(F(),U=!0),z.add(t,e),e.B=0}}function un(e,t){var n;n=t?t.l:e.U++;const r=gt(e.I);wt(r,"SID",e.K),wt(r,"RID",n),wt(r,"AID",e.T),dn(e,r),e.m&&e.o&&Ht(r,e.m,e.o),n=new qe(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=hn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),ut(e.h,n),Qe(n,r,t)}function dn(e,t){e.H&&C(e.H,(function(e,n){wt(t,n,e)})),e.l&&ft({},(function(e,n){wt(t,n,e)}))}function hn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?b(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let s=0;s<n;s++){let n=i[s].g;const a=i[s].map;if(n-=t,0>n)t=Math.max(0,i[s].g-100),o=!1;else try{zt(a,e,"req"+n+"_")}catch(e){r&&r(a)}}if(o){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function fn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;F||V(),U||(F(),U=!0),z.add(t,e),e.v=0}}function pn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ue(b(e.Fa,e),bn(e,e.v)),e.v++,!0)}function mn(e){null!=e.A&&(p.clearTimeout(e.A),e.A=null)}function gn(e){e.g=new qe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=gt(e.qa);wt(t,"RID","rpc"),wt(t,"SID",e.K),wt(t,"AID",e.T),wt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&wt(t,"TO",e.ja),wt(t,"TYPE","xmlhttp"),dn(e,t),e.m&&e.o&&Ht(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=St(gt(t)),n.m=null,n.P=!0,Ye(n,e)}function vn(e){null!=e.C&&(p.clearTimeout(e.C),e.C=null)}function yn(e,t){var n=null;if(e.g==t){vn(e),mn(e),e.g=null;var r=2}else{if(!ct(e.h,t))return;n=t.D,dt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;fe(r=Re(),new Fe(r,n)),cn(e)}else fn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(lt(e.h)>=e.h.j-(e.s?1:0)||(e.s?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa)||(e.s=Ue(b(e.Ga,e,t),bn(e,e.B)),e.B++,0)))}(e,t)||2==r&&pn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:wn(e,5);break;case 4:wn(e,10);break;case 3:wn(e,6);break;default:wn(e,2)}}function bn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function wn(e,t){if(e.j.info("Error code "+t),2==t){var n=b(e.fb,e),r=e.Xa;const t=!r;r=new mt(r||"//www.google.com/images/cleardot.gif"),p.location&&"http"==p.location.protocol||vt(r,"https"),St(r),t?function(e,t){const n=new ze;if(p.Image){const r=new Image;r.onload=w(Ft,n,"TestLoadImage: loaded",!0,t,r),r.onerror=w(Ft,n,"TestLoadImage: error",!1,t,r),r.onabort=w(Ft,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=w(Ft,n,"TestLoadImage: timeout",!1,t,r),p.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new ze;const n=new AbortController,r=setTimeout((()=>{n.abort(),Ft(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?Ft(0,0,!0,t):Ft(0,0,!1,t)})).catch((()=>{clearTimeout(r),Ft(0,0,!1,t)}))}(r.toString(),n)}else Me(2);e.G=0,e.l&&e.l.sa(t),Sn(e),ln(e)}function Sn(e){if(e.G=0,e.ka=[],e.l){const t=ht(e.h);0==t.length&&0==e.i.length||(k(e.ka,t),k(e.ka,e.i),e.h.i.length=0,E(e.i),e.i.length=0),e.l.ra()}}function En(e,t,n){var r=n instanceof mt?gt(n):new mt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),yt(r,r.s);else{var i=p.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var o=new mt(null);r&&vt(o,r),t&&(o.g=t),i&&yt(o,i),n&&(o.l=n),r=o}return n=e.D,t=e.ya,n&&t&&wt(r,n,t),wt(r,"VER",e.la),dn(e,r),r}function kn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Kt(new Vt({eb:n})):new Kt(e.pa)).Ha(e.J),t}function _n(){}function xn(){}function Tn(e,t){he.call(this),this.g=new on(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!_(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!_(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Nn(this)}function In(e){Ce.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Cn(){Ne.call(this),this.status=1}function Nn(e){this.g=e}(e=Kt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():je.g(),this.v=this.o?xe(this.o):xe(je),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){return void Yt(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=p.FormData&&e instanceof p.FormData,!(0<=Array.prototype.indexOf.call(Qt,t,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{en(this),this.u=!0,this.g.send(e),this.u=!1}catch(e){Yt(this,e)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,fe(this,"complete"),fe(this,"abort"),Zt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zt(this,!0)),Kt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Xt(this):this.bb())},e.bb=function(){Xt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<tn(this)?this.g.status:-1}catch(e){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ee(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=on.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Me(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=En(this,null,this.W),cn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new qe(this,this.j,e);let o=this.o;if(this.S&&(o?(o=N(o),D(o,this.S)):o=this.S),null!==this.m||this.O||(i.H=o,o=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=hn(this,i,t),wt(n=gt(this.I),"RID",e),wt(n,"CVER",22),this.D&&wt(n,"X-HTTP-Session-Id",this.D),dn(this,n),o&&(this.O?t="headers="+encodeURIComponent(String(qt(o)))+"&"+t:this.m&&Ht(n,this.m,o)),ut(this.h,i),this.Ua&&wt(n,"TYPE","init"),this.P?(wt(n,"$req",t),wt(n,"SID","null"),i.T=!0,Qe(i,n,null)):Qe(i,n,t),this.G=2}}else 3==this.G&&(e?un(this,e):0==this.i.length||at(this.h)||un(this))},e.Fa=function(){if(this.u=null,gn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ue(b(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Me(10),an(this),gn(this))},e.Za=function(){null!=this.C&&(this.C=null,an(this),pn(this),Me(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Me(2)):(this.j.info("Failed to ping google.com"),Me(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=_n.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},xn.prototype.g=function(e,t){return new Tn(e,t)},S(Tn,he),Tn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){sn(this.g)},Tn.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=Se(e),e=n);t.i.push(new ot(t.Ya++,e)),3==t.G&&cn(t)},Tn.prototype.N=function(){this.g.l=null,delete this.j,sn(this.g),delete this.g,Tn.aa.N.call(this)},S(In,Ce),S(Cn,Ne),S(Nn,_n),Nn.prototype.ua=function(){fe(this.g,"a")},Nn.prototype.ta=function(e){fe(this.g,new In(e))},Nn.prototype.sa=function(e){fe(this.g,new Cn)},Nn.prototype.ra=function(){fe(this.g,"b")},xn.prototype.createWebChannel=xn.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,u=h.createWebChannelTransport=function(){return new xn},c=h.getStatEventTarget=function(){return Re()},l=h.Event=Ae,a=h.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},We.NO_ERROR=0,We.TIMEOUT=8,We.HTTP_ERROR=6,s=h.ErrorCode=We,$e.COMPLETE="complete",o=h.EventType=$e,Te.EventType=Ie,Ie.OPEN="a",Ie.CLOSE="b",Ie.ERROR="c",Ie.MESSAGE="d",he.prototype.listen=he.prototype.K,i=h.WebChannel=Te,h.FetchXmlHttpFactory=Vt,Kt.prototype.listenOnce=Kt.prototype.L,Kt.prototype.getLastError=Kt.prototype.Ka,Kt.prototype.getLastErrorCode=Kt.prototype.Ba,Kt.prototype.getStatus=Kt.prototype.Z,Kt.prototype.getResponseJson=Kt.prototype.Oa,Kt.prototype.getResponseText=Kt.prototype.oa,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Ha,r=h.XhrIo=Kt}).apply(void 0!==d?d:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},223:(e,t,n)=>{n.d(t,{Wp:()=>r.Wp});var r=n(8461);(0,r.KO)("firebase","11.5.0","app")},5908:(e,t,n)=>{n.d(t,{hg:()=>r.hg,xI:()=>r.xI});var r=n(2440)},2405:(e,t,n)=>{n.d(t,{BN:()=>r.BN,C3:()=>r.C3,CL:()=>r.CL,Dc:()=>r.Dc,Fs:()=>r.Fs,GG:()=>r.GG,GV:()=>r.GV,H9:()=>r.H9,My:()=>r.My,O5:()=>r.O5,P:()=>r.P,_M:()=>r._M,aQ:()=>r.aQ,aU:()=>r.aU,gS:()=>r.gS,hq:()=>r.hq,kd:()=>r.kd,mZ:()=>r.mZ,rJ:()=>r.rJ,wP:()=>r.wP,x7:()=>r.x7});var r=n(5790)},602:(e,t,n)=>{n.d(t,{P2:()=>i});var r=n(7500);function i(e,t,{blocked:n,upgrade:i,blocking:o,terminated:s}={}){const a=indexedDB.open(e,t),l=(0,r.w)(a);return i&&a.addEventListener("upgradeneeded",(e=>{i((0,r.w)(a.result),e.oldVersion,e.newVersion,(0,r.w)(a.transaction),e)})),n&&a.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),l.then((e=>{s&&e.addEventListener("close",(()=>s())),o&&e.addEventListener("versionchange",(e=>o(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),l}const o=["get","getKey","getAll","getAllKeys","count"],s=["put","add","delete","clear"],a=new Map;function l(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(a.get(t))return a.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=s.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!o.includes(n))return;const l=async function(e,...t){const o=this.transaction(e,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return a.set(t,l),l}(0,r.r)((e=>({...e,get:(t,n,r)=>l(t,n)||e.get(t,n,r),has:(t,n)=>!!l(t,n)||e.has(t,n)})))},7500:(e,t,n)=>{n.d(t,{r:()=>h,w:()=>m});const r=(e,t)=>t.some((t=>e instanceof t));let i,o;const s=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap;let d={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||l.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return m(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){d=e(d)}function f(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(g(this),t),m(s.get(this))}:function(...t){return m(e.apply(g(this),t))}:function(t,...n){const r=e.call(g(this),t,...n);return l.set(r,t.sort?t.sort():[t]),m(r)}}function p(e){return"function"==typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));a.set(e,t)}(e),r(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,d):e)}function m(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(m(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&s.set(t,e)})).catch((()=>{})),u.set(t,e),t}(e);if(c.has(e))return c.get(e);const t=p(e);return t!==e&&(c.set(e,t),u.set(t,e)),t}const g=e=>u.get(e)},1635:(e,t,n)=>{n.d(t,{Tt:()=>r});function r(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}i.m=n,i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+".js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="wordstream:",i.l=(n,r,o,s)=>{if(e[n])e[n].push(r);else{var a,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+o){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",t+o),a.src=n),e[n]=[r];var h=(t,r)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(r))),t)return t(r)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={854:0};i.f.j=(t,n)=>{var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=o);var s=i.p+i.u(t),a=new Error;i.l(s,(n=>{if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,r[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,[s,a,l]=n,c=0;if(s.some((t=>0!==e[t]))){for(r in a)i.o(a,r)&&(i.m[r]=a[r]);if(l)l(i)}for(t&&t(n);c<s.length;c++)o=s[c],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkwordstream=self.webpackChunkwordstream||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=i(6540),s=i(961),a=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function l(e){try{if(e instanceof Error)return e.message;if("string"==typeof e)return e;if(e&&"object"==typeof e)try{return JSON.stringify(e)}catch(e){return"Object error - cannot stringify"}return String(e)}catch(e){return"Unknown error - cannot format"}}class c{translate(e,t){return a(this,void 0,void 0,(function*(){try{if(!chrome||!chrome.runtime)return console.error("WordStream: Chrome runtime API not available"),{success:!1,error:"Chrome runtime not available"};console.log("WordStream: Translating word:",e,"to language:",t);const n={type:"TRANSLATE_WORD",payload:{text:e,targetLang:t}};try{const e=yield chrome.runtime.sendMessage(n);return e?e.success?(console.log("WordStream: Translation succeeded:",e.translation),{success:!0,translatedText:e.translation,detectedSourceLanguage:e.detectedSourceLanguage}):(console.error("WordStream: Translation failed:",e.error),{success:!1,error:e.error||"Translation failed"}):(console.error("WordStream: No translation response received"),{success:!1,error:"No response from background script"})}catch(e){return console.error("WordStream: Error sending translation message:",l(e)),{success:!1,error:`Error sending message: ${l(e)}`}}}catch(e){return console.error("WordStream: Translation provider error:",l(e)),{success:!1,error:`Translation error: ${l(e)}`}}}))}}const u={auto:"Auto Detect",af:"Afrikaans",sq:"Albanian",am:"Amharic",ar:"Arabic",hy:"Armenian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",bg:"Bulgarian",ca:"Catalan",ceb:"Cebuano",ny:"Chichewa","zh-CN":"Chinese (Simplified)","zh-TW":"Chinese (Traditional)",co:"Corsican",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",eo:"Esperanto",et:"Estonian",tl:"Filipino",fi:"Finnish",fr:"French",fy:"Frisian",gl:"Galician",ka:"Georgian",de:"German",el:"Greek",gu:"Gujarati",ht:"Haitian Creole",ha:"Hausa",haw:"Hawaiian",he:"Hebrew",hi:"Hindi",hmn:"Hmong",hu:"Hungarian",is:"Icelandic",ig:"Igbo",id:"Indonesian",ga:"Irish",it:"Italian",ja:"Japanese",jw:"Javanese",kn:"Kannada",kk:"Kazakh",km:"Khmer",ko:"Korean",ku:"Kurdish (Kurmanji)",ky:"Kyrgyz",lo:"Lao",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mn:"Mongolian",my:"Myanmar (Burmese)",ne:"Nepali",no:"Norwegian",ps:"Pashto",fa:"Persian",pl:"Polish",pt:"Portuguese",pa:"Punjabi",ro:"Romanian",ru:"Russian",sm:"Samoan",gd:"Scots Gaelic",sr:"Serbian",st:"Sesotho",sn:"Shona",sd:"Sindhi",si:"Sinhala",sk:"Slovak",sl:"Slovenian",so:"Somali",es:"Spanish",su:"Sundanese",sw:"Swahili",sv:"Swedish",tg:"Tajik",ta:"Tamil",te:"Telugu",th:"Thai",tr:"Turkish",uk:"Ukrainian",ur:"Urdu",uz:"Uzbek",vi:"Vietnamese",cy:"Welsh",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",zu:"Zulu"};var d=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class h{constructor(){this.provider=new c}static getInstance(){return h.instance||(h.instance=new h),h.instance}isUserAuthenticated(){return d(this,void 0,void 0,(function*(){var e,t,n;if("undefined"!=typeof window&&!0===(null===(t=null===(e=window.WordStream)||void 0===e?void 0:e.local)||void 0===t?void 0:t.isAuthenticated))return!0;if("undefined"!=typeof chrome&&(null===(n=chrome.storage)||void 0===n?void 0:n.local))try{if(!0===(yield chrome.storage.local.get("isAuthenticated")).isAuthenticated)return!0}catch(e){console.error("WordStream Translation: Error checking auth in storage:",e)}return!1}))}detectTextLanguage(e){if(!e)return"auto";if(/[\u0590-\u05FF]/.test(e))return"he";return/[a-zA-Z]/.test(e)?"en":"auto"}translateToHebrew(e){return d(this,void 0,void 0,(function*(){if(!e)return{success:!1,error:"No text provided"};if(!(yield this.isUserAuthenticated()))return console.log("WordStream: Translation blocked - user not authenticated"),{success:!1,error:"Authentication required"};try{return console.log("WordStream: Translating to Hebrew:",e),yield this.translate(e,"he")}catch(e){return this.handleTranslationError(e,"Error translating to Hebrew")}}))}translateToEnglish(e){return d(this,void 0,void 0,(function*(){if(!e)return{success:!1,error:"No text provided"};if(!(yield this.isUserAuthenticated()))return console.log("WordStream: Translation blocked - user not authenticated"),{success:!1,error:"Authentication required"};try{return console.log("WordStream: Translating to English:",e),yield this.translate(e,"en")}catch(e){return this.handleTranslationError(e,"Error translating to English")}}))}translate(e,t){return d(this,void 0,void 0,(function*(){if(!e)return{success:!1,error:"No text provided"};if(!(yield this.isUserAuthenticated()))return console.log("WordStream: Translation blocked - user not authenticated"),{success:!1,error:"Authentication required"};try{console.log(`WordStream: Translating to ${t}:`,e);let n="en";return t in u?n=t:console.warn(`WordStream: Language code ${t} not supported, defaulting to English`),yield this.provider.translate(e,n)}catch(e){return this.handleTranslationError(e,`Error translating to ${t}`)}}))}storeTranslation(e,t,n,r){return d(this,void 0,void 0,(function*(){console.log("WordStream: Storing translation for future use",{word:e,translation:t,sourceLanguage:n,targetLanguage:r})}))}translateAndStore(e){return d(this,arguments,void 0,(function*(e,t="auto"){try{let n="auto",r=t;"auto"===t&&(n=this.detectTextLanguage(e),r="en"===n?"he":"en");const i=yield this.translate(e,r);if(i.success&&i.translatedText)return yield this.storeTranslation(e,i.translatedText,i.detectedSourceLanguage||n,r),i.translatedText;throw new Error(i.error||"Unknown translation error")}catch(e){return console.error("WordStream: Error in translateAndStore:",this.safeStringifyError(e)),`Translation error: ${this.safeStringifyError(e)}`}}))}handleTranslationError(e,t){const n=this.safeStringifyError(e);return console.error(`WordStream: ${t}:`,n),{success:!1,error:`${t}: ${n}`}}safeStringifyError(e){if(!e)return"Unknown error";if(e instanceof Error)return e.message||e.toString();if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(e){return"Unserializable error"}}}function f(e){return"iw"===e||"he-IL"===e?"he":"in"===e?"id":"jw"===e?"jv":e||"auto"}var p=i(768),m=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function g(e){try{if(e instanceof Error)return e.message;if("string"==typeof e)return e;if(e&&"object"==typeof e)try{return JSON.stringify(e)}catch(e){return"Object error - cannot stringify"}return String(e)}catch(e){return"Unknown error - cannot format"}}class v{constructor(){this.source="youtube",this.observer=null,this.popup=null,this.processedNodes=new Set,this.checkInterval=null,this.isProcessing=!1,this.lastProcessedText=new WeakMap,this.processingDebouncer=null,this.DEBOUNCE_DELAY=10,this.animationFrameId=null,this.ghostLayer=null,this.controlsContainer=null,this.videoUpdateInterval=null,this.currentVideoTime=0,this.videoDuration=0,this.controlsRoot=null,this.handleDocumentClick=e=>{this.popup&&!this.popup.contains(e.target)&&(this.popup.remove(),document.removeEventListener("click",this.handleDocumentClick))},this.translationService=h.getInstance(),this.initializeObserver()}initializeObserver(){this.observer=new MutationObserver((e=>{this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.animationFrameId=requestAnimationFrame((()=>{const t=new Set;e.forEach((e=>{if("characterData"===e.type&&e.target instanceof Text){const n=e.target.parentElement;(null==n?void 0:n.classList.contains("ytp-caption-segment"))&&t.add(e.target)}else"childList"===e.type&&e.addedNodes.forEach((e=>{if(e instanceof Text){const n=e.parentElement;(null==n?void 0:n.classList.contains("ytp-caption-segment"))&&t.add(e)}else e instanceof HTMLElement&&e.classList.contains("ytp-caption-segment")&&e.childNodes.forEach((e=>{e instanceof Text&&t.add(e)}))}))})),t.forEach((e=>this.processTextNode(e))),this.animationFrameId=null}))}))}startObserving(e){if(this.observer)try{this.observer.observe(e,{childList:!0,characterData:!0,subtree:!0});Array.from(e.getElementsByClassName("ytp-caption-segment")).flatMap((e=>Array.from(e.childNodes))).filter((e=>e.nodeType===Node.TEXT_NODE)).forEach((e=>this.processTextNode(e)))}catch(e){console.error("WordStream: Error starting observation:",e)}else console.warn("WordStream: Observer not initialized")}stopObserving(){if(this.observer)try{this.observer.disconnect(),this.processingDebouncer&&(clearTimeout(this.processingDebouncer),this.processingDebouncer=null)}catch(e){console.error("WordStream: Error stopping observation:",e)}else console.warn("WordStream: Observer not initialized")}isCaptionSegment(e){return e instanceof HTMLElement&&e.classList.contains("ytp-caption-segment")}needsSpaceBetweenWords(e,t){const n=/^[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Thai}]/u;return!(n.test(e)||n.test(t))}waitForChromeAPI(){return m(this,arguments,void 0,(function*(e=5,t=1e3){var n,r;for(let i=0;i<e;i++){if("undefined"!=typeof chrome&&(null===(n=chrome.runtime)||void 0===n?void 0:n.id)&&(null===(r=chrome.storage)||void 0===r?void 0:r.sync))return console.log("WordStream: Chrome API initialized successfully"),!0;console.log(`WordStream: Waiting for Chrome API (attempt ${i+1}/${e})...`),yield new Promise((e=>setTimeout(e,t)))}return console.error("WordStream: Chrome API not available after retries"),!1}))}detectCaptionsLanguage(){return m(this,void 0,void 0,(function*(){return{language:"auto",languageName:"Auto Detect",isAuto:!0}}))}handleWordClick(e){return m(this,void 0,void 0,(function*(){var t,n;if("undefined"!=typeof window&&!0!==(null===(n=null===(t=window.WordStream)||void 0===t?void 0:t.local)||void 0===n?void 0:n.isAuthenticated))return void console.log("WordStream YouTube: Word click blocked - user not authenticated");if(!e.target)return;e.preventDefault(),e.stopPropagation();const r=e.target.textContent||"";if(r.trim()){console.log("WordStream: Handling click for word:",r);try{if(!(yield this.waitForChromeAPI(10,1500)))return console.error("WordStream: Chrome API initialization failed"),void this.showTranslationPopup("Extension not initialized. Please refresh the page.",e);let t;try{t=(yield new Promise(((e,t)=>{chrome.storage.sync.get(["settings"],(n=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(n)}))}))).settings}catch(t){return console.error("WordStream: Error getting storage settings:",g(t)),void this.showTranslationPopup(`Storage error: ${g(t)}`,e)}const n=(null==t?void 0:t.targetLanguage)||"en";let i,o;console.log("WordStream: Using target language:",n);try{if(i=yield this.translationService.translate(r,n),console.log("WordStream: Translation result:",i),!i.success)throw new Error(i.error||"Unknown translation error");if(!i.translatedText)throw new Error("Translation succeeded but no translated text returned")}catch(t){return console.error("WordStream: Translation error:",g(t)),void this.showTranslationPopup(`Translation error: ${g(t)}`,e)}this.showTranslationPopup(i.translatedText,e);try{o=yield function(){return m(this,void 0,void 0,(function*(){var e;try{const t=yield new Promise(((e,t)=>{chrome.storage.sync.get(["words_metadata","words_groups"],(n=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(n)}))}));if(!t.words_metadata){const t=yield new Promise(((e,t)=>{chrome.storage.sync.get(["words"],(n=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(n)}))}));return console.log("WordStream: Loaded words in old format:",(null===(e=t.words)||void 0===e?void 0:e.length)||0),t.words||[]}if(!t.words_groups||!Array.isArray(t.words_groups))return console.log("WordStream: No word groups found"),[];const n=yield new Promise(((e,n)=>{chrome.storage.sync.get(t.words_groups,(t=>{chrome.runtime.lastError?n(chrome.runtime.lastError):e(t)}))})),r=[];for(const e of t.words_groups)n[e]&&Array.isArray(n[e])&&r.push(...n[e]);return console.log("WordStream: Loaded words in new format:",r.length),r}catch(e){return console.error("WordStream: Error loading words:",g(e)),[]}}))}()}catch(e){console.error("WordStream: Error loading words:",g(e)),o=[]}const s={id:`${r}-${Date.now()}`,originalWord:r,targetWord:i.translatedText,sourceLanguage:i.detectedSourceLanguage||"auto",targetLanguage:n,timestamp:(new Date).toISOString(),context:{source:"youtube",videoTitle:document.title,url:window.location.href,captionsLanguage:i.detectedSourceLanguage||"auto"},stats:{successRate:0,totalReviews:0,lastReview:(new Date).toISOString()}};try{console.log(`Checking if word "${r}" already exists...`);const e=r.trim().toLowerCase(),t=o.some((t=>{var r;return(null===(r=t.originalWord)||void 0===r?void 0:r.trim().toLowerCase())===e&&t.sourceLanguage===s.sourceLanguage&&t.targetLanguage===n}));if(t)console.log("WordStream: Word already exists, not saving duplicate");else{console.log(`Adding new word: "${r}" (${s.sourceLanguage}  ${n})`);const e=100;let t=[...o,s];t.length>e&&(console.log(`WordStream: Too many saved words (${t.length}), removing oldest`),t.sort(((e,t)=>(0,p.u)(e.timestamp).getTime()-(0,p.u)(t.timestamp).getTime())),t=t.slice(-e));const i={},a=10;t.forEach(((e,t)=>{const n=`words_group_${Math.floor(t/a)}`;i[n]||(i[n]=[]),i[n].push(e)}));const l={totalGroups:Object.keys(i).length,totalWords:t.length,lastUpdated:(new Date).toISOString()};yield new Promise(((e,t)=>{chrome.storage.sync.set({words_metadata:l},(()=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e()}))}));for(const[e,t]of Object.entries(i))yield new Promise(((n,r)=>{chrome.storage.sync.set({[e]:t},(()=>{chrome.runtime.lastError?r(chrome.runtime.lastError):n()}))}));let c;try{c=yield new Promise(((e,t)=>{chrome.storage.sync.get(["stats"],(n=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(n.stats||{})}))}))}catch(e){console.error("WordStream: Error loading stats:",g(e)),c={}}const u=new Date,d=c.lastActive?new Date(c.lastActive):new Date(0),h=new Date(u.getFullYear(),u.getMonth(),u.getDate()),f=new Date(d.getFullYear(),d.getMonth(),d.getDate()),m=Math.abs(h.getTime()-f.getTime()),v=Math.ceil(m/864e5);let y=c.streak||0,b=c.todayWords||0;v>=1?b=1:b+=1,1===v?y+=1:v>1&&(y=1),yield new Promise(((e,n)=>{chrome.storage.sync.set({stats:{totalWords:t.length,lastSaved:u.toISOString(),todayWords:b,streak:y,lastActive:u.toISOString()}},(()=>{chrome.runtime.lastError?n(chrome.runtime.lastError):e()}))})),yield new Promise(((e,t)=>{chrome.storage.sync.set({words_groups:Object.keys(i)},(()=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e()}))})),console.log("WordStream: Word saved successfully")}}catch(e){console.error("WordStream: Error saving word:",g(e))}}catch(t){console.error("WordStream: Error handling word click:",g(t)),this.showTranslationPopup(`Error: ${g(t)}`,e)}}}))}getSubtitleContext(e){var t;const n=e.closest(".ytp-caption-segment");if(!n)return"";return((null===(t=n.textContent)||void 0===t?void 0:t.trim())||"").replace(/\s+/g," ").replace(/([.,!?;:])(?!\s)/g,"$1 ").replace(/\s+([.,!?;:])/g,"$1").replace(/\s+/g," ").replace(/\s*\n\s*/g," ").replace(/([A-Za-z])\s+([.,!?;:])/g,"$1$2").trim()}showTranslationPopup(e,t){this.popup&&(this.popup.remove(),document.removeEventListener("click",this.handleDocumentClick));const n=t.target.textContent||"";this.popup=document.createElement("div"),this.popup.className="wordstream-popup",Object.assign(this.popup.style,{position:"fixed",right:"24px",top:"50%",transform:"translateY(-50%)",background:"rgba(28, 28, 28, 0.95)",borderRadius:"8px",padding:"16px",minWidth:"200px",maxWidth:"300px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.2)",color:"#fff",fontFamily:"'Roboto', 'Segoe UI', sans-serif",fontSize:"14px",lineHeight:"1.5",zIndex:"9999999",display:"block",visibility:"visible",opacity:"1",transition:"opacity 0.2s ease-out"});const r=document.createElement("div");r.className="original-word",r.textContent=n,Object.assign(r.style,{color:"#64B5F6",fontWeight:"500",fontSize:"16px",marginBottom:"8px",display:"block",fontFamily:"'Roboto', 'Segoe UI', sans-serif"}),this.popup.appendChild(r);const i=document.createElement("div");i.className="translated-word",i.textContent=e,Object.assign(i.style,{fontWeight:"500",fontSize:"16px",display:"block",fontFamily:"'Roboto', 'Segoe UI', sans-serif"}),this.popup.appendChild(i),document.body.appendChild(this.popup),document.addEventListener("click",this.handleDocumentClick),setTimeout((()=>{this.popup&&(this.popup.style.opacity="0",setTimeout((()=>{this.popup&&(this.popup.remove(),document.removeEventListener("click",this.handleDocumentClick))}),200))}),5e3)}cleanup(){this.observer&&(this.observer.disconnect(),this.observer=null),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.popup&&(this.popup.remove(),this.popup=null),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.isProcessing=!1,this.processedNodes.clear();document.querySelectorAll(".wordstream-word").forEach((e=>{var t;const n=e.cloneNode(!0);null===(t=e.parentNode)||void 0===t||t.replaceChild(n,e)})),this.removeFloatingControls()}detect(){return m(this,void 0,void 0,(function*(){try{const e=document.querySelector(".ytp-caption-window-container");return e&&this.addFloatingControls(),e||null}catch(e){return console.error("Error detecting caption container:",e),null}}))}processCaption(e){var t,n;"undefined"!=typeof window&&!0!==(null===(n=null===(t=window.WordStream)||void 0===t?void 0:t.local)||void 0===n?void 0:n.isAuthenticated)||e&&this.startObserving(e)}processTextNode(e){var t,n;if("undefined"!=typeof window&&!0!==(null===(n=null===(t=window.WordStream)||void 0===t?void 0:t.local)||void 0===n?void 0:n.isAuthenticated))return;if(!e||!e.textContent)return;const r=e.textContent.trim();if(!r)return;const i=this.lastProcessedText.get(e);if(i===r)return;const o=e.parentNode;if(!o)return;const s=document.createElement("div");s.style.cssText="\n      position: absolute;\n      visibility: hidden;\n      pointer-events: none;\n      width: 100%;\n    ",s.textContent=i||"",o.appendChild(s);const a=r.split(/[\s\u200B-\u200D\uFEFF]+/).filter((e=>e.length>0)),l=document.createDocumentFragment();a.forEach(((e,t)=>{const n=document.createElement("span");if(n.className="wordstream-word",n.textContent=e,n.addEventListener("click",(e=>{e.stopPropagation(),this.handleWordClick(e)}),{passive:!1}),l.appendChild(n),t<a.length-1){const n=a[t+1];this.needsSpaceBetweenWords(e,n)&&l.appendChild(document.createTextNode(" "))}})),o.replaceChild(l,e),this.lastProcessedText.set(e,r),requestAnimationFrame((()=>{s.remove()}))}detectCaptionLanguage(e){var t;return f(e.getAttribute("lang")||(null===(t=e.closest("[lang]"))||void 0===t?void 0:t.getAttribute("lang"))||document.documentElement.lang||"auto")}addFloatingControls(){console.log("[WordStream] Adding floating controls to YouTube...");try{this.getPlayerApi()||console.warn("[WordStream] Player API not found, will attempt to add controls anyway");let e=document.querySelector("div.html5-video-player");e||(console.warn("[WordStream] Standard video player not found, trying alternatives"),e=document.querySelector(".ytd-player")),e||(console.warn("[WordStream] Using fallback container for controls"),e=document.querySelector(".watch-main-col")||document.body),this.removeFloatingControls();const t=document.getElementById("wordstream-floating-controls-container");t&&(console.log("[WordStream] Controls already exist, removing first"),t.remove())}catch(e){console.error("[WordStream] Error adding floating controls:",e)}}renderControls(e,t=!0,n=!1,r=!1){var o,s;console.log(`[WordStream] Rendering controls. Persist: ${t}, Show Gemini: ${n}, Show Notes: ${r}`);try{let a=window.React,l=window.ReactDOM;if(!a||!l||!l.createRoot){console.log("[WordStream] React or ReactDOM not found globally, importing directly...");try{a=i(6540),l=i(5338),console.log("[WordStream] Successfully imported React and ReactDOM")}catch(e){return void console.error("[WordStream] Failed to import React and ReactDOM:",e)}}console.log("[WordStream] React available:",!!a),console.log("[WordStream] ReactDOM available:",!!l),console.log("[WordStream] ReactDOM.createRoot available:",!(!l||!l.createRoot));const c=null===(s=null===(o=window.WordStream)||void 0===o?void 0:o.Components)||void 0===s?void 0:s.FloatingControls;if(!c)return void console.error("[WordStream] FloatingControls component not found");for(console.log("[WordStream] FloatingControls component found");e.firstChild;)e.removeChild(e.firstChild);const u=document.createElement("div");u.className="wordstream-root",e.appendChild(u);try{const i=l.createRoot(u),o=this.getPlayerApi(),s=o?o.getCurrentTime():0,d=o?o.getDuration():0;console.log(`[WordStream] Creating component with persistVisibility=${t}`),i.render(a.createElement(c,{onClose:()=>{console.log("[WordStream] Close button clicked"),e.style.display="none"},persistVisibility:t,initialShowGemini:n,initialShowNotes:r,currentTime:s,videoDuration:d})),console.log("[WordStream] Component rendered successfully")}catch(e){console.error("[WordStream] Error rendering with createRoot:",e)}}catch(e){console.error("[WordStream] Error rendering controls:",e)}}removeFloatingControls(){if(console.log("[WordStream] YouTube detector: Cleanly releasing controls resources"),this.videoUpdateInterval&&(clearInterval(this.videoUpdateInterval),this.videoUpdateInterval=null),this.controlsRoot){try{this.controlsRoot.unmount()}catch(e){console.warn("[WordStream] Error unmounting React root:",e)}this.controlsRoot=null}this.controlsContainer=null,console.log("[WordStream] YouTube detector: Controls resources released")}getVideoId(){return new URLSearchParams(window.location.search).get("v")||window.location.pathname}getPlayerApi(){try{if(document.querySelector(".html5-video-player")){const e=document.querySelector(".html5-video-player");if(e&&e.getPlayerState)return console.log("[WordStream] Found player API via player element"),e;if(window.hasOwnProperty("yt")&&window.yt&&window.yt.player&&window.yt.player.getPlayerByElement){const t=window.yt.player.getPlayerByElement(e);if(t)return console.log("[WordStream] Found player API via yt.player global object"),t}const t=document.querySelector("video");if(t)return console.log("[WordStream] Using video element as fallback for player API"),{getPlayerState:()=>t.paused?2:1,getCurrentTime:()=>t.currentTime,getDuration:()=>t.duration,getVideoUrl:()=>window.location.href,getVideoData:()=>({video_id:this.getVideoId(),title:document.title.replace(" - YouTube","")})}}return console.error("[WordStream] Player API not found"),null}catch(e){return console.error("[WordStream] Error getting player API:",e),null}}}var y=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class b{constructor(){this.source="netflix",this.observer=null,this.popup=null,this.lastProcessedText=new WeakMap,this.animationFrameId=null,this.controlsContainer=null,this.videoUpdateInterval=null,this.currentVideoTime=0,this.videoDuration=0,this.controlsRoot=null,this.translationService=h.getInstance(),this.initializeObserver()}initializeObserver(){this.observer=new MutationObserver((e=>{this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.animationFrameId=requestAnimationFrame((()=>{const t=new Set;e.forEach((e=>{if("characterData"===e.type&&e.target instanceof Text){const n=e.target.parentElement;(null==n?void 0:n.classList.contains("player-timedtext-text-container"))&&t.add(e.target)}else"childList"===e.type&&e.addedNodes.forEach((e=>{if(e instanceof Text){const n=e.parentElement;(null==n?void 0:n.classList.contains("player-timedtext-text-container"))&&t.add(e)}else e instanceof HTMLElement&&e.classList.contains("player-timedtext-text-container")&&e.childNodes.forEach((e=>{e instanceof Text&&t.add(e)}))}))})),t.forEach((e=>this.processTextNode(e))),this.animationFrameId=null}))}))}detect(){return y(this,void 0,void 0,(function*(){const e=document.querySelector(".player-timedtext");return e?(this.addFloatingControls(),e):new Promise((e=>{const t=new MutationObserver(((t,n)=>{const r=document.querySelector(".player-timedtext");r&&(n.disconnect(),this.addFloatingControls(),e(r))}));t.observe(document.body,{childList:!0,subtree:!0}),setTimeout((()=>{t.disconnect(),e(null)}),1e4)}))}))}processCaption(e){var t,n;"undefined"!=typeof window&&!0!==(null===(n=null===(t=window.WordStream)||void 0===t?void 0:t.local)||void 0===n?void 0:n.isAuthenticated)||e&&this.startObserving(e)}processTextNode(e){var t,n;if("undefined"!=typeof window&&!0!==(null===(n=null===(t=window.WordStream)||void 0===t?void 0:t.local)||void 0===n?void 0:n.isAuthenticated))return;if(!e||!e.textContent)return;const r=e.textContent.trim();if(!r)return;const i=this.lastProcessedText.get(e);if(i===r)return;const o=e.parentNode;if(!o)return;const s=document.createElement("div");s.style.cssText="\n      position: absolute;\n      visibility: hidden;\n      pointer-events: none;\n      width: 100%;\n    ",s.textContent=i||"",o.appendChild(s);const a=r.split(/[\s\u200B-\u200D\uFEFF]+/).filter((e=>e.length>0)),l=document.createDocumentFragment();a.forEach(((e,t)=>{const n=document.createElement("span");if(n.className="wordstream-word",n.textContent=e,n.addEventListener("click",(e=>{e.stopPropagation(),this.handleWordClick(e)}),{passive:!1}),l.appendChild(n),t<a.length-1){const n=a[t+1];this.needsSpaceBetweenWords(e,n)&&l.appendChild(document.createTextNode(" "))}})),o.replaceChild(l,e),this.lastProcessedText.set(e,r),requestAnimationFrame((()=>{s.remove()}))}needsSpaceBetweenWords(e,t){const n=/^[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Thai}]/u;return!(n.test(e)||n.test(t))}detectCaptionsLanguage(){try{const e=document.querySelector(".track-list-subtitles");if(e){const t=e.querySelector('[aria-selected="true"]');if(t){const e=t.textContent||"",n=e.toLowerCase().includes("auto-generated");return{language:t.getAttribute("data-lang")||t.getAttribute("lang")||"en",languageName:e,isAuto:n}}}const t=document.querySelector(".VideoContainer");if(t){const e=t.getAttribute("lang")||document.documentElement.lang;if(e)return{language:e,languageName:e,isAuto:!1}}return{language:"en",languageName:"English",isAuto:!1}}catch(e){return console.error("Error detecting Netflix captions language:",e),{language:"en",languageName:"English",isAuto:!1}}}handleWordClick(e){return y(this,void 0,void 0,(function*(){var t,n;if("undefined"!=typeof window&&!0!==(null===(n=null===(t=window.WordStream)||void 0===t?void 0:t.local)||void 0===n?void 0:n.isAuthenticated))return void console.log("WordStream Netflix: Word click blocked - user not authenticated");if(!e.target)return;e.preventDefault(),e.stopPropagation();const r=e.target.textContent||"";if(r.trim()){console.log("WordStream: Handling click for word:",r);try{const t=this.detectCaptionsLanguage();console.log("WordStream: Detected Netflix captions language:",t),chrome.storage.sync.get(["settings","words","stats"],(n=>y(this,void 0,void 0,(function*(){var i,o;if(chrome.runtime.lastError)return void console.error("Error accessing storage:",chrome.runtime.lastError);const s=(null===(i=n.settings)||void 0===i?void 0:i.targetLanguage)||"en";console.log("WordStream: Translating to:",s);const a=yield this.translationService.translate(r,s);if(console.log("WordStream: Translation result:",a),a.success&&a.translatedText){this.showTranslationPopup(a.translatedText,e);const n=(null===(o=document.querySelector(".video-title"))||void 0===o?void 0:o.textContent)||document.title,i={season:void 0,episode:void 0,episodeTitle:void 0},l=document.querySelector(".video-title h4");if(l){const e=l.textContent||"",t=e.match(/S(\d+):E(\d+)/);t&&(i.season=parseInt(t[1]),i.episode=parseInt(t[2]),i.episodeTitle=e.replace(/S\d+:E\d+\s*/,"").trim())}const c={id:`${r}-${Date.now()}`,originalWord:r,targetWord:a.translatedText,sourceLanguage:t.language,targetLanguage:s,timestamp:(new Date).toISOString(),context:{source:"netflix",videoTitle:n,captionsLanguage:t,url:window.location.href,episodeInfo:i},stats:{successRate:0,totalReviews:0,lastReview:(new Date).toISOString()}};chrome.storage.sync.get(["words_metadata","words_groups"],(e=>y(this,void 0,void 0,(function*(){if(chrome.runtime.lastError)return void console.error("Error accessing metadata:",chrome.runtime.lastError);if(!(!e.words_metadata||!e.words_groups)){console.log("WordStream: Using new word storage format");let n=[];Array.isArray(e.words_groups)?chrome.storage.sync.get(e.words_groups,(r=>{if(chrome.runtime.lastError)console.error("Error loading word groups:",chrome.runtime.lastError);else{for(const t of e.words_groups)r[t]&&Array.isArray(r[t])&&n.push(...r[t]);this.saveWordWithGroups(n,c,t,s)}})):this.saveWordWithGroups([],c,t,s)}else console.log("WordStream: Using old word storage format (legacy)"),chrome.storage.sync.get(["words","stats"],(e=>{if(chrome.runtime.lastError)return void console.error("Error accessing words:",chrome.runtime.lastError);const n=e.words||[],i=e.stats||{wordsLearned:0,dailyStreak:0,accuracy:0,lastActive:(new Date).toISOString()};console.log(`Checking if word "${r}" already exists...`);const o=r.trim().toLowerCase();if(n.some((e=>e.originalWord.trim().toLowerCase()===o&&e.sourceLanguage===t.language&&e.targetLanguage===s)))console.log(`Word "${r}" already exists, not adding duplicate`);else{console.log(`Adding new word: "${r}" (${t.language}  ${s})`),n.push(c);const e=new Date,o=new Date(i.lastActive);if(e.getDate()!==o.getDate()||e.getMonth()!==o.getMonth()||e.getFullYear()!==o.getFullYear()){const t=Math.floor((e.getTime()-o.getTime())/864e5);i.dailyStreak=1===t?i.dailyStreak+1:1}i.wordsLearned+=1,i.lastActive=e,chrome.storage.sync.set({words:n,stats:i},(()=>{chrome.runtime.lastError?console.error("Error saving data:",chrome.runtime.lastError):(console.log("WordStream: Word saved:",c),console.log("WordStream: Stats updated:",i))}))}}))}))))}else console.error("Translation failed:",a.error)}))))}catch(e){console.error("Error handling word click:",e)}}}))}getSubtitleContext(e){var t;const n=e.closest(".player-timedtext-text-container");if(!n)return"";return((null===(t=n.textContent)||void 0===t?void 0:t.trim())||"").replace(/\s+/g," ").replace(/([.,!?;:])(?!\s)/g,"$1 ").replace(/\s+([.,!?;:])/g,"$1").replace(/\s+/g," ").replace(/\s*\n\s*/g," ").replace(/([A-Za-z])\s+([.,!?;:])/g,"$1$2").trim()}showTranslationPopup(e,t){this.popup&&this.popup.remove(),this.popup=document.createElement("div"),this.popup.className="wordstream-popup";const n=t.target.textContent||"";Object.assign(this.popup.style,{position:"fixed",right:"24px",top:"50%",transform:"translateY(-50%)",background:"rgba(28, 28, 28, 0.95)",borderRadius:"8px",padding:"16px",minWidth:"200px",maxWidth:"300px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.2)",color:"#fff",fontFamily:"'Roboto', 'Segoe UI', sans-serif",fontSize:"14px",lineHeight:"1.5",zIndex:"9999999",display:"block",visibility:"visible",opacity:"1",transition:"opacity 0.2s ease-out"});const r=document.createElement("div");r.className="original-word",r.textContent=n,Object.assign(r.style,{color:"#64B5F6",fontWeight:"500",fontSize:"16px",marginBottom:"8px",display:"block",fontFamily:"'Roboto', 'Segoe UI', sans-serif"}),this.popup.appendChild(r);const i=document.createElement("div");i.className="translated-word",i.textContent=e,Object.assign(i.style,{fontWeight:"500",fontSize:"16px",display:"block",fontFamily:"'Roboto', 'Segoe UI', sans-serif"}),this.popup.appendChild(i),document.body.appendChild(this.popup),setTimeout((()=>{this.popup&&(this.popup.style.opacity="0",setTimeout((()=>{this.popup&&(this.popup.remove(),this.popup=null)}),200))}),4e3)}startObserving(e){if(this.observer)try{this.observer.observe(e,{childList:!0,characterData:!0,subtree:!0});Array.from(e.getElementsByClassName("player-timedtext-text-container")).flatMap((e=>Array.from(e.childNodes))).filter((e=>e.nodeType===Node.TEXT_NODE)).forEach((e=>this.processTextNode(e)))}catch(e){console.error("WordStream: Error starting observation:",e)}else console.warn("WordStream: Observer not initialized")}stopObserving(){if(this.observer)try{this.observer.disconnect(),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}catch(e){console.error("WordStream: Error stopping observation:",e)}else console.warn("WordStream: Observer not initialized")}cleanup(){this.observer&&(this.observer.disconnect(),this.observer=null),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.popup&&(this.popup.remove(),this.popup=null);document.querySelectorAll(".wordstream-word").forEach((e=>{var t;const n=e.cloneNode(!0);null===(t=e.parentNode)||void 0===t||t.replaceChild(n,e)})),this.removeFloatingControls()}addFloatingControls(){console.log("[WordStream] Adding floating controls to Netflix...");try{let e=document.querySelector(".watch-video");e||(console.warn("[WordStream] Standard Netflix player not found, trying alternatives"),e=document.querySelector(".VideoContainer")||document.querySelector(".nfp")),e||(console.warn("[WordStream] Using fallback container for controls"),e=document.body),this.removeFloatingControls();const t=document.getElementById("wordstream-floating-controls-container");t&&(console.log("[WordStream] Controls already exist, removing first"),t.remove())}catch(e){console.error("[WordStream] Error adding floating controls:",e)}}renderControls(e,t=!0,n=!1,r=!1){var o,s;console.log(`[WordStream] Rendering controls. Persist: ${t}, Show Gemini: ${n}, Show Notes: ${r}`);try{let a=window.React,l=window.ReactDOM;if(!a||!l||!l.createRoot){console.log("[WordStream] React or ReactDOM not found globally, importing directly...");try{a=i(6540),l=i(5338),console.log("[WordStream] Successfully imported React and ReactDOM for Netflix")}catch(e){return void console.error("[WordStream] Failed to import React and ReactDOM for Netflix:",e)}}console.log("[WordStream] React available for Netflix:",!!a),console.log("[WordStream] ReactDOM available for Netflix:",!!l),console.log("[WordStream] ReactDOM.createRoot available for Netflix:",!(!l||!l.createRoot));const c=null===(s=null===(o=window.WordStream)||void 0===o?void 0:o.Components)||void 0===s?void 0:s.FloatingControls;if(!c)return void console.error("[WordStream] FloatingControls component not found for Netflix");for(console.log("[WordStream] FloatingControls component found for Netflix");e.firstChild;)e.removeChild(e.firstChild);const u=document.createElement("div");u.className="wordstream-root",e.appendChild(u);try{const i=l.createRoot(u),o=document.querySelector("video"),s=o?o.currentTime:0,d=o?o.duration:0;console.log(`[WordStream] Creating component for Netflix with persistVisibility=${t}`),i.render(a.createElement(c,{onClose:()=>{console.log("[WordStream] Close button clicked in Netflix"),e.style.display="none"},persistVisibility:t,initialShowGemini:n,initialShowNotes:r,currentTime:s,videoDuration:d})),console.log("[WordStream] Component rendered successfully for Netflix")}catch(e){console.error("[WordStream] Error rendering with createRoot for Netflix:",e)}}catch(e){console.error("[WordStream] Error rendering controls for Netflix:",e)}}removeFloatingControls(){if(console.log("[WordStream] Netflix detector: Cleanly releasing controls resources"),this.videoUpdateInterval&&(clearInterval(this.videoUpdateInterval),this.videoUpdateInterval=null),this.controlsRoot){try{this.controlsRoot.unmount()}catch(e){console.warn("[WordStream] Error unmounting React root:",e)}this.controlsRoot=null}this.controlsContainer=null,console.log("[WordStream] Netflix detector: Controls resources released")}saveWordWithGroups(e,t,n,r){const i=t.originalWord,o=i.trim().toLowerCase(),s=e.some((e=>{var t;return(null===(t=e.originalWord)||void 0===t?void 0:t.trim().toLowerCase())===o&&e.sourceLanguage===n.language&&e.targetLanguage===r}));if(s)return void console.log(`Word "${i}" already exists, not adding duplicate`);console.log(`Adding new word: "${i}" (${n.language}  ${r})`);let a=[...e,t];a.length>100&&(console.log(`WordStream: Too many saved words (${a.length}), removing oldest`),a.sort(((e,t)=>(0,p.u)(e.timestamp).getTime()-(0,p.u)(t.timestamp).getTime())),a=a.slice(-100));const l={};a.forEach(((e,t)=>{const n=`words_group_${Math.floor(t/10)}`;l[n]||(l[n]=[]),l[n].push(e)}));const c={totalGroups:Object.keys(l).length,totalWords:a.length,lastUpdated:(new Date).toISOString()};chrome.storage.sync.set({words_metadata:c},(()=>{if(chrome.runtime.lastError)console.error("Error saving metadata:",chrome.runtime.lastError);else{for(const[e,t]of Object.entries(l))chrome.storage.sync.set({[e]:t},(()=>{chrome.runtime.lastError&&console.error(`Error saving group ${e}:`,chrome.runtime.lastError)}));chrome.storage.sync.get(["stats"],(e=>{if(chrome.runtime.lastError)return void console.error("Error loading stats:",chrome.runtime.lastError);const t=e.stats||{},n=new Date,r=t.lastActive?new Date(t.lastActive):new Date(0),i=new Date(n.getFullYear(),n.getMonth(),n.getDate()),o=new Date(r.getFullYear(),r.getMonth(),r.getDate()),s=Math.abs(i.getTime()-o.getTime()),c=Math.ceil(s/864e5);let u=t.streak||0,d=t.todayWords||0;c>=1?d=1:d+=1,1===c?u+=1:c>1&&(u=1),chrome.storage.sync.set({words_groups:Object.keys(l),stats:{totalWords:a.length,lastSaved:n.toISOString(),todayWords:d,streak:u,lastActive:n.toISOString()}},(()=>{chrome.runtime.lastError?console.error("Error saving groups list and stats:",chrome.runtime.lastError):(console.log("WordStream: Word saved successfully in grouped format"),console.log("WordStream: Stats updated - streak:",u,"today words:",d))}))}))}}))}}var w=i(5338),S=i(2405),E=i(5908);function k(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return e?`${e}-${t}`:t}var _=i(8542),x=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const T=new class{constructor(){this.firestore=null,this.auth=null,this.user=null,this.userData=null,this.isInitialized=!1,this.isOnline=navigator.onLine,this.enableLocalStorage=!0,this.enableBroadcastChannel=!0,this.debug=!1,this.eventListeners=new Map,this.broadcastChannel=null,this.notes=new Map,this.videosWithNotes=new Map,this.chats=new Map,this.savedWords=new Map,this.wordlists=new Map,this.activeSubscriptions=new Map,this.syncState={notes:{lastSynced:null,isSyncing:!1,error:null},chats:{lastSynced:null,isSyncing:!1,error:null},words:{lastSynced:null,isSyncing:!1,error:null},wordlists:{lastSynced:null,isSyncing:!1,error:null},user:{lastSynced:null,isSyncing:!1,error:null},settings:{lastSynced:null,isSyncing:!1,error:null},global:{lastSynced:null,isSyncing:!1,error:null}}}initialize(e){var t,n,r;this.firestore=e.firestore||null,this.auth=e.auth||null,this.enableLocalStorage=null===(t=e.enableLocalStorage)||void 0===t||t,this.enableBroadcastChannel=null===(n=e.enableBroadcastChannel)||void 0===n||n,this.debug=null!==(r=e.debug)&&void 0!==r&&r,this.setupListeners(),this.isInitialized=!0,this.emit("store:initialized",{timestamp:(new Date).toISOString()}),this.logDebug("Store initialized")}setupListeners(){if(window.addEventListener("online",(()=>{this.isOnline=!0,this.emit("store:connectionChanged",{isOnline:!0}),this.syncAll()})),window.addEventListener("offline",(()=>{this.isOnline=!1,this.emit("store:connectionChanged",{isOnline:!1})})),this.enableBroadcastChannel)try{this.broadcastChannel=new BroadcastChannel("wordStram-sync-channel"),this.broadcastChannel.onmessage=e=>this.handleBroadcastMessage(e.data)}catch(e){this.logDebug("BroadcastChannel not supported",e),this.enableBroadcastChannel=!1}this.auth&&(0,E.hg)(this.auth,(e=>{const t=!!this.user,n=!!e;this.user=e,!t&&n?(this.emit("user:login",this.getUserInfo()),this.fetchUserData()):t&&!n&&(this.emit("user:logout",{timestamp:(new Date).toISOString()}),this.clearUserData())}))}logDebug(e,...t){this.debug&&console.log(`[Store] ${e}`,...t)}getUserInfo(){return this.user?{id:this.user.uid,displayName:this.user.displayName,email:this.user.email,photoURL:this.user.photoURL}:null}clearUserData(){this.userData=null,this.notes.clear(),this.videosWithNotes.clear(),this.chats.clear(),this.savedWords.clear(),this.wordlists.clear(),this.activeSubscriptions.forEach((e=>{e()})),this.activeSubscriptions.clear()}handleBroadcastMessage(e){var t,n,r,i,o;if(e&&e.type){switch(this.logDebug("Received broadcast message",e),e.type){case"note:added":case"note:updated":if(null===(t=e.data)||void 0===t?void 0:t.note){const t=e.data.note;this.updateNoteLocally(t)}break;case"note:deleted":(null===(n=e.data)||void 0===n?void 0:n.noteId)&&this.removeNoteLocally(e.data.noteId,e.data.videoId);break;case"notes:synced":this.fetchNotes();break;case"chat:added":case"chat:updated":if(null===(r=e.data)||void 0===r?void 0:r.chat){const t=e.data.chat;this.updateChatLocally(t)}break;case"chat:deleted":(null===(i=e.data)||void 0===i?void 0:i.chatId)&&this.removeChatLocally(e.data.chatId);break;case"chats:synced":this.fetchChats();break;case"sync:started":case"sync:completed":case"sync:failed":this.syncState.global={lastSynced:e.timestamp,isSyncing:"sync:started"===e.type,error:"sync:failed"===e.type?(null===(o=e.data)||void 0===o?void 0:o.error)||"Unknown error":null}}this.emit(e.type,e.data)}}emit(e,t){const n=(new Date).toISOString(),r={type:e,data:t,timestamp:n};this.logDebug(`Emitting event: ${e}`,t);const i=this.eventListeners.get(e);if(i&&i.forEach((n=>{try{n(t)}catch(t){console.error(`Error in listener for ${e}:`,t)}})),this.enableBroadcastChannel&&this.broadcastChannel)try{this.broadcastChannel.postMessage(r)}catch(e){console.error("Error broadcasting message:",e)}}subscribe(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Map);const n=this.eventListeners.get(e),r=k("listener");return n.set(r,t),r}unsubscribe(e,t){const n=this.eventListeners.get(e);n&&n.delete(t)}fetchUserData(){return x(this,void 0,void 0,(function*(){if(!this.user||!this.firestore)return null;try{this.syncState.user.isSyncing=!0;const e=this.user.uid,t=(0,S.H9)(this.firestore,"users",e),n=yield(0,S.x7)(t);return n.exists()&&n.data().userData?this.userData=n.data().userData:(this.userData={stats:{totalChats:0,totalNotes:0,totalSavedWords:0,joinDate:(new Date).toISOString(),lastActiveDate:(new Date).toISOString()}},yield(0,S.mZ)(t,{userData:this.userData,updatedAt:(new Date).toISOString()})),this.syncState.user={lastSynced:(new Date).toISOString(),isSyncing:!1,error:null},this.fetchNotes(),this.fetchChats(),this.fetchSavedWords(),this.fetchWordlists(),this.userData}catch(e){const t=e instanceof Error?e.message:String(e);return console.error("Error fetching user data:",e),this.syncState.user={lastSynced:this.syncState.user.lastSynced,isSyncing:!1,error:t},null}}))}updateNoteLocally(e){if(e&&e.id&&(this.notes.set(e.id,e),e.videoId)){let t=this.videosWithNotes.get(e.videoId);t||(t={videoId:e.videoId,videoTitle:e.videoTitle||"Unknown Video",videoURL:`https://www.youtube.com/watch?v=${e.videoId}`,lastUpdated:(new Date).toISOString(),notes:[]},this.videosWithNotes.set(e.videoId,t));const n=t.notes.findIndex((t=>t.id===e.id));n>=0?t.notes[n]=e:t.notes.push(e),t.lastUpdated=(new Date).toISOString()}}removeNoteLocally(e,t){if(this.notes.delete(e),t){const n=this.videosWithNotes.get(t);n&&(n.notes=n.notes.filter((t=>t.id!==e)),n.lastUpdated=(new Date).toISOString(),0===n.notes.length&&this.videosWithNotes.delete(t))}else for(const[t,n]of this.videosWithNotes.entries()){if(n.notes.some((t=>t.id===e))){n.notes=n.notes.filter((t=>t.id!==e)),n.lastUpdated=(new Date).toISOString(),0===n.notes.length&&this.videosWithNotes.delete(t);break}}}updateChatLocally(e){e&&e.id&&this.chats.set(e.id,e)}removeChatLocally(e){this.chats.delete(e)}fetchNotes(){return x(this,void 0,void 0,(function*(){if(this.user&&this.firestore)try{this.syncState.notes.isSyncing=!0;const e=this.user.uid,t=(0,S.rJ)(this.firestore,"users",e,"notes"),n=yield(0,S.GG)(t);this.notes.clear(),this.videosWithNotes.clear(),n.forEach((e=>{const t=e.data();if(t&&t.id&&(this.notes.set(t.id,t),t.videoId)){let e=this.videosWithNotes.get(t.videoId);e||(e={videoId:t.videoId,videoTitle:t.videoTitle||"Unknown Video",videoURL:`https://www.youtube.com/watch?v=${t.videoId}`,lastUpdated:(new Date).toISOString(),notes:[]},this.videosWithNotes.set(t.videoId,e)),e.notes.push(t);const n=t.updatedAt||t.createdAt;n&&n>e.lastUpdated&&(e.lastUpdated=n)}})),this.syncState.notes={lastSynced:(new Date).toISOString(),isSyncing:!1,error:null},this.emit("notes:synced",{count:this.notes.size,videosCount:this.videosWithNotes.size,timestamp:(new Date).toISOString()})}catch(e){const t=e instanceof Error?e.message:String(e);console.error("Error fetching notes:",e),this.syncState.notes={lastSynced:this.syncState.notes.lastSynced,isSyncing:!1,error:t}}}))}syncAll(){return x(this,void 0,void 0,(function*(){if(!this.user||!this.firestore||!this.isOnline)return!1;try{this.syncState.global.isSyncing=!0,this.emit("sync:started",{timestamp:(new Date).toISOString()}),yield Promise.all([this.fetchUserData(),this.fetchNotes(),this.fetchChats(),this.fetchSavedWords(),this.fetchWordlists()]);const e=(new Date).toISOString();return this.syncState.global={lastSynced:e,isSyncing:!1,error:null},this.emit("sync:completed",{timestamp:e}),!0}catch(e){const t=e instanceof Error?e.message:String(e);return console.error("Error syncing all data:",e),this.syncState.global={lastSynced:this.syncState.global.lastSynced,isSyncing:!1,error:t},this.emit("sync:failed",{error:t,timestamp:(new Date).toISOString()}),!1}}))}fetchChats(){return x(this,void 0,void 0,(function*(){if(this.user&&this.firestore)try{this.syncState.chats.isSyncing=!0;const e=this.user.uid,t=(0,S.rJ)(this.firestore,"users",e,"chats"),n=yield(0,S.GG)(t);this.chats.clear(),n.forEach((e=>{const t=e.data();t&&t.id&&this.chats.set(t.id,t)})),this.syncState.chats={lastSynced:(new Date).toISOString(),isSyncing:!1,error:null},this.emit("chats:synced",{count:this.chats.size,timestamp:(new Date).toISOString()})}catch(e){const t=e instanceof Error?e.message:String(e);console.error("Error fetching chats:",e),this.syncState.chats={lastSynced:this.syncState.chats.lastSynced,isSyncing:!1,error:t}}}))}fetchSavedWords(){return x(this,void 0,void 0,(function*(){if(this.user&&this.firestore)try{this.syncState.words.isSyncing=!0;const e=this.user.uid,t=(0,S.rJ)(this.firestore,"users",e,"savedWords"),n=yield(0,S.GG)(t);this.savedWords.clear(),n.forEach((e=>{const t=e.data();t&&t.id&&this.savedWords.set(t.id,t)})),this.syncState.words={lastSynced:(new Date).toISOString(),isSyncing:!1,error:null},this.emit("words:synced",{count:this.savedWords.size,timestamp:(new Date).toISOString()})}catch(e){const t=e instanceof Error?e.message:String(e);console.error("Error fetching saved words:",e),this.syncState.words={lastSynced:this.syncState.words.lastSynced,isSyncing:!1,error:t}}}))}fetchWordlists(){return x(this,void 0,void 0,(function*(){if(this.user&&this.firestore)try{this.syncState.wordlists.isSyncing=!0;const e=this.user.uid,t=(0,S.rJ)(this.firestore,"users",e,"wordlists"),n=yield(0,S.GG)(t);this.wordlists.clear(),n.forEach((e=>{const t=e.data();t&&t.id&&this.wordlists.set(t.id,t)})),this.syncState.wordlists={lastSynced:(new Date).toISOString(),isSyncing:!1,error:null},this.emit("wordlists:synced",{count:this.wordlists.size,timestamp:(new Date).toISOString()})}catch(e){const t=e instanceof Error?e.message:String(e);console.error("Error fetching wordlists:",e),this.syncState.wordlists={lastSynced:this.syncState.wordlists.lastSynced,isSyncing:!1,error:t}}}))}getNotes(e){if(!e)return[];const t=this.videosWithNotes.get(e);return t?[...t.notes].sort(((e,t)=>{if(void 0!==e.videoTime&&void 0!==t.videoTime)return e.videoTime-t.videoTime;const n=e.createdAt||"",r=t.createdAt||"";return n.localeCompare(r)})):[]}getAllVideosWithNotes(){return Array.from(this.videosWithNotes.values()).sort(((e,t)=>(t.lastUpdated||"").localeCompare(e.lastUpdated||"")))}getAllChats(){return Array.from(this.chats.values()).sort(((e,t)=>(t.updatedAt||"").localeCompare(e.updatedAt||"")))}getAllSavedWords(){return Array.from(this.savedWords.values()).sort(((e,t)=>(t.updatedAt||"").localeCompare(e.updatedAt||"")))}getAllWordlists(){return Array.from(this.wordlists.values()).sort(((e,t)=>(t.updatedAt||"").localeCompare(e.updatedAt||"")))}saveNote(e){return x(this,void 0,void 0,(function*(){if(!this.user||!this.firestore)return null;try{const t=this.user.uid,n=e.id||k(),r=Object.assign(Object.assign({},e),{id:n,userId:t,createdAt:e.createdAt||(new Date).toISOString(),updatedAt:(new Date).toISOString()}),i=(0,S.H9)(this.firestore,"users",t,"notes",n);if(yield(0,S.BN)(i,r),this.notes.set(n,r),r.videoId){let e=this.videosWithNotes.get(r.videoId);e||(e={videoId:r.videoId,videoTitle:r.videoTitle||"Unknown Video",videoURL:`https://www.youtube.com/watch?v=${r.videoId}`,lastUpdated:(new Date).toISOString(),notes:[]},this.videosWithNotes.set(r.videoId,e));const i=e.notes.findIndex((e=>e.id===n));i>=0?e.notes[i]=r:e.notes.push(r),e.lastUpdated=(new Date).toISOString();try{const i=(0,S.H9)(this.firestore,"users",t,"videos",r.videoId);yield(0,S.BN)(i,{videoId:r.videoId,videoTitle:r.videoTitle||"Unknown Video",videoURL:e.videoURL,lastUpdated:(new Date).toISOString(),noteIds:{[n]:!0}},{merge:!0})}catch(e){console.warn("Error updating video document:",e)}}return this.emit("note:added",r),n}catch(e){e instanceof Error?e.message:String(e);return console.error("Error saving note:",e),null}}))}deleteNote(e){return x(this,void 0,void 0,(function*(){if(!this.user||!this.firestore)return!1;try{const t=this.user.uid,n=this.notes.get(e),r=(0,S.H9)(this.firestore,"users",t,"notes",e);if(yield(0,S.kd)(r),this.notes.delete(e),null==n?void 0:n.videoId){const r=this.videosWithNotes.get(n.videoId);if(r){r.notes=r.notes.filter((t=>t.id!==e)),r.lastUpdated=(new Date).toISOString();try{const r=(0,S.H9)(this.firestore,"users",t,"videos",n.videoId);yield(0,S.mZ)(r,{lastUpdated:(new Date).toISOString(),[`noteIds.${e}`]:(0,S.CL)()})}catch(e){console.warn("Error updating video document:",e)}0===r.notes.length&&this.videosWithNotes.delete(n.videoId)}}return this.emit("note:deleted",{id:e,videoId:null==n?void 0:n.videoId}),!0}catch(e){e instanceof Error?e.message:String(e);return console.error("Error deleting note:",e),!1}}))}saveChat(e){return x(this,void 0,void 0,(function*(){var t;if(!this.user||!this.firestore)return console.error("Cannot save chat: No user or Firestore connection"),null;try{const n=this.user.uid,r=(new Date).toISOString(),i=e.id||k("chat"),o=Object.assign(Object.assign(Object.assign({id:i,userId:n,title:e.title||" ",messages:e.messages||[],isSaved:null===(t=e.isSaved)||void 0===t||t,createdAt:e.createdAt||r,updatedAt:r},e.videoId&&{videoId:e.videoId}),e.videoTitle&&{videoTitle:e.videoTitle}),e.tags&&{tags:e.tags}),s=(0,S.H9)(this.firestore,"users",n,"chats",i);if(yield(0,S.BN)(s,o),this.userData&&(this.userData.savedChatIds||(this.userData.savedChatIds=[]),o.isSaved&&!this.userData.savedChatIds.includes(i))){this.userData.savedChatIds.push(i);const t=(0,S.H9)(this.firestore,"users",n);yield(0,S.mZ)(t,{savedChatIds:this.userData.savedChatIds,"stats.lastActiveDate":r}),e.id||(this.userData.stats||(this.userData.stats={totalChats:0,totalNotes:0,totalSavedWords:0,joinDate:r,lastActiveDate:r}),this.userData.stats.totalChats++,yield(0,S.mZ)(t,{"stats.totalChats":this.userData.stats.totalChats}))}this.updateChatLocally(o);const a=e.id?"chat:updated":"chat:added";return this.emit(a,{chat:o}),i}catch(e){e instanceof Error?e.message:String(e);return console.error("Error saving chat:",e),null}}))}deleteChat(e){return x(this,void 0,void 0,(function*(){if(!this.user||!this.firestore)return console.error("Cannot delete chat: No user or Firestore connection"),!1;try{const t=this.user.uid,n=(0,S.H9)(this.firestore,"users",t,"chats",e);if(yield(0,S.kd)(n),this.userData&&this.userData.savedChatIds){this.userData.savedChatIds=this.userData.savedChatIds.filter((t=>t!==e));const n=(new Date).toISOString(),r=(0,S.H9)(this.firestore,"users",t);yield(0,S.mZ)(r,{savedChatIds:this.userData.savedChatIds,"stats.lastActiveDate":n}),this.userData.stats&&this.userData.stats.totalChats>0&&(this.userData.stats.totalChats--,yield(0,S.mZ)(r,{"stats.totalChats":this.userData.stats.totalChats}))}return this.removeChatLocally(e),this.emit("chat:deleted",{chatId:e}),!0}catch(e){e instanceof Error?e.message:String(e);return console.error("Error deleting chat:",e),!1}}))}isConnected(){return!!this.firestore&&this.isOnline}isListening(){return this.activeSubscriptions.size>0}getSyncState(){return Object.assign({},this.syncState)}getLocalStorageKey(e){return`wordStram:${e}`}saveToLocalStorage(e,t){if(this.enableLocalStorage)try{const n=this.getLocalStorageKey(e),r=JSON.stringify(t);localStorage.setItem(n,r)}catch(t){console.error(`Error saving to localStorage [${e}]:`,t)}}getFromLocalStorage(e,t){if(!this.enableLocalStorage)return t;try{const n=this.getLocalStorageKey(e),r=localStorage.getItem(n);return null===r?t:JSON.parse(r)}catch(n){return console.error(`Error reading from localStorage [${e}]:`,n),t}}removeFromLocalStorage(e){if(this.enableLocalStorage)try{const t=this.getLocalStorageKey(e);localStorage.removeItem(t)}catch(t){console.error(`Error removing from localStorage [${e}]:`,t)}}saveStateToLocalStorage(){this.enableLocalStorage&&(this.logDebug("Saving state to localStorage"),this.saveToLocalStorage("videosWithNotes",Array.from(this.videosWithNotes.values())),this.saveToLocalStorage("chats",Array.from(this.chats.values())),this.saveToLocalStorage("savedWords",Array.from(this.savedWords.values())),this.saveToLocalStorage("wordlists",Array.from(this.wordlists.values())),this.saveToLocalStorage("syncState",this.syncState))}loadStateFromLocalStorage(){if(!this.enableLocalStorage)return;this.logDebug("Loading state from localStorage");const e=this.getFromLocalStorage("videosWithNotes",[]);this.videosWithNotes.clear(),e.forEach((e=>{this.videosWithNotes.set(e.videoId,e),e.notes.forEach((e=>{this.notes.set(e.id,e)}))}));const t=this.getFromLocalStorage("chats",[]);this.chats.clear(),t.forEach((e=>{this.chats.set(e.id,e)}));const n=this.getFromLocalStorage("savedWords",[]);this.savedWords.clear(),n.forEach((e=>{this.savedWords.set(e.id,e)}));const r=this.getFromLocalStorage("wordlists",[]);this.wordlists.clear(),r.forEach((e=>{this.wordlists.set(e.id,e)}));const i=this.getFromLocalStorage("syncState",this.syncState);this.syncState=i}};T.initialize({firestore:_.firestore,auth:_.auth,enableLocalStorage:!0,enableBroadcastChannel:!0,debug:!1});const I=T;var C=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function N(e){return{id:e.id,content:e.content,timestamp:e.updatedAt||e.createdAt,videoTime:e.videoTime,lastSynced:e.updatedAt,videoId:e.videoId,formattedTime:e.videoTime?R(e.videoTime):""}}function A(e){return{id:e.id,content:e.content,videoId:e.videoId||"",videoTime:e.videoTime,updatedAt:e.lastSynced||e.timestamp,createdAt:e.timestamp}}function D(e){return{videoId:e.videoId,videoTitle:e.videoTitle,videoURL:e.videoURL,lastUpdated:e.lastUpdated,notes:e.notes.map((e=>({id:e.id,content:e.content,timestamp:e.updatedAt||e.createdAt,videoTime:e.videoTime,lastSynced:e.updatedAt,videoId:e.videoId,formattedTime:e.videoTime?R(e.videoTime):""})))}}function R(e){if(void 0===e)return"";const t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function O(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=O(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function L(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=O(e))&&(r&&(r+=" "),r+=t);return r}const P=e=>{const t=z(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:e=>{const n=e.split("-");return""===n[0]&&1!==n.length&&n.shift(),M(n,t)||U(e)},getConflictingClassGroupIds:(e,t)=>{const i=n[e]||[];return t&&r[e]?[...i,...r[e]]:i}}},M=(e,t)=>{if(0===e.length)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),i=r?M(e.slice(1),r):void 0;if(i)return i;if(0===t.validators.length)return;const o=e.join("-");return t.validators.find((({validator:e})=>e(o)))?.classGroupId},F=/^\[(.+)\]$/,U=e=>{if(F.test(e)){const t=F.exec(e)[1],n=t?.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},z=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return $(Object.entries(e.classGroups),n).forEach((([e,n])=>{V(n,r,e,t)})),r},V=(e,t,n,r)=>{e.forEach((e=>{if("string"!=typeof e){if("function"==typeof e)return W(e)?void V(e(r),t,n,r):void t.validators.push({validator:e,classGroupId:n});Object.entries(e).forEach((([e,i])=>{V(i,j(t,e),n,r)}))}else{(""===e?t:j(t,e)).classGroupId=n}}))},j=(e,t)=>{let n=e;return t.split("-").forEach((e=>{n.nextPart.has(e)||n.nextPart.set(e,{nextPart:new Map,validators:[]}),n=n.nextPart.get(e)})),n},W=e=>e.isThemeGetter,$=(e,t)=>t?e.map((([e,n])=>[e,n.map((e=>"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map((([e,n])=>[t+e,n]))):e))])):e,B=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const i=(i,o)=>{n.set(i,o),t++,t>e&&(t=0,r=n,n=new Map)};return{get(e){let t=n.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(i(e,t),t):void 0},set(e,t){n.has(e)?n.set(e,t):i(e,t)}}},q=e=>{const{separator:t,experimentalParseClassName:n}=e,r=1===t.length,i=t[0],o=t.length,s=e=>{const n=[];let s,a=0,l=0;for(let c=0;c<e.length;c++){let u=e[c];if(0===a){if(u===i&&(r||e.slice(c,c+o)===t)){n.push(e.slice(l,c)),l=c+o;continue}if("/"===u){s=c;continue}}"["===u?a++:"]"===u&&a--}const c=0===n.length?e:e.substring(l),u=c.startsWith("!");return{modifiers:n,hasImportantModifier:u,baseClassName:u?c.substring(1):c,maybePostfixModifierPosition:s&&s>l?s-l:void 0}};return n?e=>n({className:e,parseClassName:s}):s},H=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach((e=>{"["===e[0]?(t.push(...n.sort(),e),n=[]):n.push(e)})),t.push(...n.sort()),t},K=/\s+/;function G(){let e,t,n=0,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=Q(e))&&(r&&(r+=" "),r+=t);return r}const Q=e=>{if("string"==typeof e)return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=Q(e[r]))&&(n&&(n+=" "),n+=t);return n};function Y(e,...t){let n,r,i,o=function(a){const l=t.reduce(((e,t)=>t(e)),e());return n=(e=>({cache:B(e.cacheSize),parseClassName:q(e),...P(e)}))(l),r=n.cache.get,i=n.cache.set,o=s,s(a)};function s(e){const t=r(e);if(t)return t;const o=((e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i}=t,o=[],s=e.trim().split(K);let a="";for(let e=s.length-1;e>=0;e-=1){const t=s[e],{modifiers:l,hasImportantModifier:c,baseClassName:u,maybePostfixModifierPosition:d}=n(t);let h=Boolean(d),f=r(h?u.substring(0,d):u);if(!f){if(!h){a=t+(a.length>0?" "+a:a);continue}if(f=r(u),!f){a=t+(a.length>0?" "+a:a);continue}h=!1}const p=H(l).join(":"),m=c?p+"!":p,g=m+f;if(o.includes(g))continue;o.push(g);const v=i(f,h);for(let e=0;e<v.length;++e){const t=v[e];o.push(m+t)}a=t+(a.length>0?" "+a:a)}return a})(e,n);return i(e,o),o}return function(){return o(G.apply(null,arguments))}}const J=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},X=/^\[(?:([a-z-]+):)?(.+)\]$/i,Z=/^\d+\/\d+$/,ee=new Set(["px","full","screen"]),te=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ne=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,re=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ie=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,oe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,se=e=>le(e)||ee.has(e)||Z.test(e),ae=e=>Se(e,"length",Ee),le=e=>Boolean(e)&&!Number.isNaN(Number(e)),ce=e=>Se(e,"number",le),ue=e=>Boolean(e)&&Number.isInteger(Number(e)),de=e=>e.endsWith("%")&&le(e.slice(0,-1)),he=e=>X.test(e),fe=e=>te.test(e),pe=new Set(["length","size","percentage"]),me=e=>Se(e,pe,ke),ge=e=>Se(e,"position",ke),ve=new Set(["image","url"]),ye=e=>Se(e,ve,xe),be=e=>Se(e,"",_e),we=()=>!0,Se=(e,t,n)=>{const r=X.exec(e);return!!r&&(r[1]?"string"==typeof t?r[1]===t:t.has(r[1]):n(r[2]))},Ee=e=>ne.test(e)&&!re.test(e),ke=()=>!1,_e=e=>ie.test(e),xe=e=>oe.test(e),Te=(Symbol.toStringTag,()=>{const e=J("colors"),t=J("spacing"),n=J("blur"),r=J("brightness"),i=J("borderColor"),o=J("borderRadius"),s=J("borderSpacing"),a=J("borderWidth"),l=J("contrast"),c=J("grayscale"),u=J("hueRotate"),d=J("invert"),h=J("gap"),f=J("gradientColorStops"),p=J("gradientColorStopPositions"),m=J("inset"),g=J("margin"),v=J("opacity"),y=J("padding"),b=J("saturate"),w=J("scale"),S=J("sepia"),E=J("skew"),k=J("space"),_=J("translate"),x=()=>["auto",he,t],T=()=>[he,t],I=()=>["",se,ae],C=()=>["auto",le,he],N=()=>["","0",he],A=()=>[le,he];return{cacheSize:500,separator:":",theme:{colors:[we],spacing:[se,ae],blur:["none","",fe,he],brightness:A(),borderColor:[e],borderRadius:["none","","full",fe,he],borderSpacing:T(),borderWidth:I(),contrast:A(),grayscale:N(),hueRotate:A(),invert:N(),gap:T(),gradientColorStops:[e],gradientColorStopPositions:[de,ae],inset:x(),margin:x(),opacity:A(),padding:T(),saturate:A(),scale:A(),sepia:N(),skew:A(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",he]}],container:["container"],columns:[{columns:[fe]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",he]}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ue,he]}],basis:[{basis:x()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",he]}],grow:[{grow:N()}],shrink:[{shrink:N()}],order:[{order:["first","last","none",ue,he]}],"grid-cols":[{"grid-cols":[we]}],"col-start-end":[{col:["auto",{span:["full",ue,he]},he]}],"col-start":[{"col-start":C()}],"col-end":[{"col-end":C()}],"grid-rows":[{"grid-rows":[we]}],"row-start-end":[{row:["auto",{span:[ue,he]},he]}],"row-start":[{"row-start":C()}],"row-end":[{"row-end":C()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",he]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",he]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal","start","end","center","between","around","evenly","stretch"]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",he,t]}],"min-w":[{"min-w":[he,t,"min","max","fit"]}],"max-w":[{"max-w":[he,t,"none","full","min","max","fit","prose",{screen:[fe]},fe]}],h:[{h:[he,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[he,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[he,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[he,t,"auto","min","max","fit"]}],"font-size":[{text:["base",fe,ae]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ce]}],"font-family":[{font:[we]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",he]}],"line-clamp":[{"line-clamp":["none",le,ce]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",se,he]}],"list-image":[{"list-image":["none",he]}],"list-style-type":[{list:["none","disc","decimal",he]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","none","wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",se,ae]}],"underline-offset":[{"underline-offset":["auto",se,he]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",he]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",he]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",ge]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",me]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ye]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:["solid","dashed","dotted","double","none","hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["","solid","dashed","dotted","double","none"]}],"outline-offset":[{"outline-offset":[se,he]}],"outline-w":[{outline:[se,ae]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[se,ae]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",fe,be]}],"shadow-color":[{shadow:[we]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",fe,he]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[b]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",he]}],duration:[{duration:A()}],ease:[{ease:["linear","in","out","in-out",he]}],delay:[{delay:A()}],animate:[{animate:["none","spin","ping","pulse","bounce",he]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[ue,he]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",he]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",he]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",he]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[se,ae,ce]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}),Ie=Y(Te);function Ce(...e){return Ie(L(e))}var Ne=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Ae=o.forwardRef(((e,t)=>{var{className:n,variant:r="default",size:i="default"}=e,s=Ne(e,["className","variant","size"]);return o.createElement("button",Object.assign({className:Ce("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-primary text-primary-foreground hover:bg-primary/90":"default"===r,"border border-input bg-background hover:bg-accent hover:text-accent-foreground":"outline"===r,"hover:bg-accent hover:text-accent-foreground":"ghost"===r,"h-10 px-4 py-2":"default"===i,"h-9 rounded-md px-3":"sm"===i,"h-11 rounded-md px-8":"lg"===i},n),ref:t},s))}));function De({className:e}){return o.createElement("svg",{className:Ce("animate-spin",e),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},o.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"}))}function Re({videoId:e,videoTitle:t,currentTime:n,isVisible:r,onClose:i}){const{notes:s,videosWithNotes:a,isSyncing:l,error:c,syncAll:u,saveNote:d,deleteNote:h}=function(e={}){const[t,n]=(0,o.useState)([]),[r,i]=(0,o.useState)([]),[s,a]=(0,o.useState)([]),[l,c]=(0,o.useState)([]),[u,d]=(0,o.useState)(null),[h,f]=(0,o.useState)(!1),[p,m]=(0,o.useState)(null),[g,v]=(0,o.useState)(null),y=(e.events,e.videoId),b=((0,o.useMemo)((()=>new Map),[]),(0,o.useCallback)((e=>{y&&e.note.videoId===y&&n((t=>{const n=N(e.note),r=t.findIndex((t=>t.id===e.note.id));if(r>=0){const e=[...t];return e[r]=n,e}return[...t,n]})),i((e=>I.getAllVideosWithNotes().map((e=>D(e)))))}),[y])),w=(0,o.useCallback)((e=>{y&&e.videoId===y&&n((t=>t.filter((t=>t.id!==e.noteId)))),i((t=>t.map((t=>e.videoId&&t.videoId===e.videoId?Object.assign(Object.assign({},t),{notes:t.notes.filter((t=>t.id!==e.noteId)),lastUpdated:(new Date).toISOString()}):t)).filter((e=>e.notes.length>0))))}),[y]),S=(0,o.useCallback)((e=>{m(e.timestamp||(new Date).toISOString());const t=I.getAllVideosWithNotes().map((e=>D(e)));if(i(t),y){const e=I.getNotes(y).map((e=>N(e)));n(e)}f(!1),v(null)}),[y]),E=(0,o.useCallback)((()=>{f(!0)}),[]),k=(0,o.useCallback)((e=>{f(!1),m(e.timestamp),v(null)}),[]),_=(0,o.useCallback)((e=>{f(!1),v(e.error instanceof Error?e.error.message:String(e.error))}),[]),x=((0,o.useCallback)((()=>{if(!y)return;const e=I.getNotes(y).map((e=>N(e)));n(e)}),[y]),(0,o.useCallback)((()=>C(this,void 0,void 0,(function*(){f(!0),v(null);try{(yield I.syncAll())||v("Synchronization failed")}catch(e){v(e instanceof Error?e.message:String(e)),f(!1)}}))),[])),T=(0,o.useCallback)((e=>C(this,void 0,void 0,(function*(){try{const t=A(e);return yield I.saveNote(t)}catch(e){return v(e instanceof Error?e.message:String(e)),null}}))),[]),R=(0,o.useCallback)((e=>C(this,void 0,void 0,(function*(){try{return yield I.deleteNote(e),!0}catch(e){return v(e instanceof Error?e.message:String(e)),!1}}))),[]);return(0,o.useEffect)((()=>{const e={"note:added":b,"note:deleted":w,"notes:synced":S,"sync:started":E,"sync:completed":k,"sync:failed":_},t=[];Object.entries(e).forEach((([e,n])=>{const r=I.subscribe(e,n);t.push((()=>I.unsubscribe(e,r)))}));const r=I.getAllVideosWithNotes();if(i(r.map((e=>D(e)))),y){const e=I.getNotes(y);n(e.map((e=>N(e))))}return()=>{t.forEach((e=>e()))}}),[y,b,w,S,E,k,_]),{notes:t,videosWithNotes:r,chats:s,words:l,stats:u,isSyncing:h,isOnline:navigator.onLine,lastSyncTime:p,error:g,syncAll:x,saveNote:T,deleteNote:R,addNote:T,convertStoreNoteToFeatureNote:N,convertFeatureNoteToStoreNote:A,convertStoreVideoToFeatureVideo:D}}({videoId:e}),[f,p]=(0,o.useState)(null),[m,g]=(0,o.useState)(""),[v,y]=(0,o.useState)(!1);(0,o.useEffect)((()=>{if(void 0!==n){const e=s.filter((e=>void 0!==e.videoTime&&Math.abs(e.videoTime-n)<.5));e.length>0?p(e[0].id):p(null)}}),[n,s]),(0,o.useEffect)((()=>{y(!0),(s.length>0||a.length>0)&&y(!1)}),[s.length,a.length]);const b=(0,o.useCallback)((()=>{u()}),[u]),w=(0,o.useCallback)((()=>{m.trim()&&e&&(d({content:m,videoId:e,videoTime:n}),g(""))}),[m,e,n,d]),S=(0,o.useCallback)((e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w())}),[w]);return r?o.createElement("div",{className:"fixed top-0 right-0 h-screen w-80 bg-white shadow-lg flex flex-col z-50"},o.createElement("div",{className:"flex justify-between items-center p-2 border-b"},o.createElement("h3",{className:"font-bold"},t||""),o.createElement("div",{className:"flex items-center gap-2"},l?o.createElement("div",{className:"flex items-center text-xs"},o.createElement(De,{className:"mr-1 h-4 w-4"}),o.createElement("span",null,"...")):o.createElement(Ae,{size:"sm",variant:"outline",onClick:b,className:"text-xs py-0.5 px-2"},""),o.createElement("button",{onClick:i,className:"p-1 rounded-full hover:bg-gray-100","aria-label":""},o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))))),o.createElement("div",{className:"flex-1 overflow-auto p-2"},v?o.createElement("div",{className:"flex justify-center items-center h-full"},o.createElement(De,null)):c?o.createElement("div",{className:"flex justify-center items-center h-full"},o.createElement("div",{className:"text-center p-4"},o.createElement("p",{className:"text-red-500"},"  "),o.createElement(Ae,{size:"sm",variant:"outline",onClick:u,className:"mt-2"}," "))):0===s.length?o.createElement("div",{className:"flex justify-center items-center h-full text-gray-500"},"   "):o.createElement("ul",{className:"space-y-2"},s.map((e=>o.createElement("li",{key:e.id,className:Ce("p-3 rounded-lg relative transition-colors border",f===e.id?"bg-blue-50 border-blue-200":"border-gray-200")},o.createElement("div",{className:"flex justify-between items-start mb-1"},o.createElement("div",{className:"flex items-center"},void 0!==e.videoTime&&o.createElement("button",{onClick:()=>{const t=new CustomEvent("jump-to-time",{detail:{time:e.videoTime}});window.dispatchEvent(t)},className:"flex items-center bg-transparent border-none rounded text-xs font-medium px-1.5 py-0.5 bg-gray-100 hover:bg-gray-200 mr-2"},o.createElement("svg",{className:"w-3.5 h-3.5 mr-1",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o.createElement("polygon",{points:"5 3 19 12 5 21 5 3"})),e.formattedTime),o.createElement("span",{className:"text-xs text-gray-500"},function(e){const t="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("he-IL",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(t)}(e.timestamp))),o.createElement("button",{onClick:()=>{return t=e.id,void(window.confirm("   ?")&&h(t));var t},className:"p-1 rounded-full bg-transparent border-none opacity-50 hover:opacity-100 hover:bg-gray-100",title:" "},o.createElement("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o.createElement("path",{d:"M3 6h18"}),o.createElement("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})))),o.createElement("div",{className:"mt-1 text-sm"},e.content)))))),o.createElement("div",{className:"border-t p-2"},o.createElement("div",{className:"flex gap-2"},o.createElement("textarea",{value:m,onChange:e=>g(e.target.value),onKeyDown:S,placeholder:" ...",className:"flex-1 p-2 border rounded resize-none min-h-[60px]"}),o.createElement(Ae,{onClick:w,disabled:!m.trim(),className:"self-end"},o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),o.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"})))))):null}Ae.displayName="Button";var Oe,Le,Pe,Me=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};if("undefined"==typeof performance&&(window.performance={now:()=>Date.now()}),void 0===window.WordStream&&(window.WordStream={Components:{},local:{}}),window.WordStream&&"object"==typeof window.WordStream&&(window.WordStream.local||(window.WordStream.local={}),window.WordStream.local.isAuthenticated=!1),"undefined"!=typeof chrome&&(null===(Oe=chrome.runtime)||void 0===Oe?void 0:Oe.id)){console.log("WordStream Content: Applying Firebase CORS overrides");const e=[];if(null===(Le=chrome.runtime)||void 0===Le?void 0:Le.id){const t=`chrome-extension://${chrome.runtime.id}`;e.push(t)}const t=document.createElement;document.createElement=function(e,n){const r=t.call(document,e,n);if("script"===e.toLowerCase()){const e=r;e.addEventListener("beforeload",(function(t){const n=e.src||"";(n.includes("firebaseio.com")||n.includes("firebaseapp.com")||n.includes("googleapis.com"))&&(console.log("WordStream Content: Detected Firebase script load, applying CORS headers"),e.setAttribute("crossorigin","anonymous"))}))}return r}}const Fe="undefined"!=typeof chrome&&(null===(Pe=chrome.runtime)||void 0===Pe?void 0:Pe.id);let Ue=!1;function ze(){var e;console.log("WordStream: Updating UI for auth state:",Ue),Ue?(console.log("WordStream: User authenticated, enabling features..."),qe()):(console.log("WordStream: User not authenticated, disabling features..."),He()),"undefined"!=typeof window&&(null===(e=window.WordStream)||void 0===e?void 0:e.local)&&(window.WordStream.local.isAuthenticated=Ue)}"undefined"!=typeof window&&(window.WordStream=window.WordStream||{},window.WordStream.local=window.WordStream.local||{},window.WordStream.local.isAuthenticated=!1),chrome.runtime.onMessage.addListener(((e,t,n)=>("AUTH_STATE_CHANGED"===e.action&&(console.log("WordStream: Auth state message received:",e.isAuthenticated),Ue=!!e.isAuthenticated,ze(),n({received:!0})),!0))),function(){Me(this,void 0,void 0,(function*(){var e;try{const t=yield chrome.storage.local.get("isAuthenticated");t.hasOwnProperty("isAuthenticated")&&(Ue=!!t.isAuthenticated),Fe&&(null===(e=chrome.runtime)||void 0===e?void 0:e.id)&&chrome.runtime.sendMessage({action:"GET_CURRENT_AUTH_STATE"},(e=>{chrome.runtime.lastError?console.error("WordStream: Error checking auth state:",chrome.runtime.lastError):e&&e.hasOwnProperty("isAuthenticated")&&(Ue=!!e.isAuthenticated,console.log("WordStream: Initial auth state received:",Ue),ze())})),ze()}catch(e){console.error("WordStream: Error checking initial auth state:",e)}}))}(),window.React=o,window.ReactDOM=Object.assign(Object.assign({},s),{createRoot:w.createRoot}),window.React=o,window.ReactDOM=Object.assign(Object.assign({},s),{createRoot:w.createRoot}),window.WordStream||(window.WordStream={local:{}}),window.WordStream.Components||(window.WordStream.Components={}),window.WordStream.local||(window.WordStream.local={}),window.WordStream.Components.FloatingControls=function({videoId:e,videoTitle:t,currentTime:n,videoDuration:r,initialShowNotes:i=!1,persistVisibility:s=!1,onClose:a}){const[l,c]=(0,o.useState)(i),u=(0,o.useRef)(null);(0,o.useEffect)((()=>(console.log("WordStream: FloatingControls mounted",{videoId:e,initialShowNotes:i,persistVisibility:s}),()=>{console.log("WordStream: FloatingControls unmounting")})),[e,i,s]),(0,o.useEffect)((()=>{i!==l&&(console.log("WordStream: Updating Notes visibility from prop",i),c(i))}),[i]),(0,o.useEffect)((()=>{if(s){console.log("WordStream: Forcing panel to stay open with persistVisibility=true");const e=setInterval((()=>{i&&!l&&(console.log("WordStream: Re-opening Notes panel that was closed unexpectedly"),c(!0))}),300);return()=>clearInterval(e)}}),[s,i,l]);const d=(0,o.useCallback)((()=>{console.log("WordStream: NotesPanel visibility changed to hidden"),s||c(!1),a&&a()}),[s,a]);return(0,o.useEffect)((()=>{console.log("WordStream: After render check for element",{notesVisible:l})}),[l]),o.createElement("div",{ref:u,className:"wordstream-floating-controls"},o.createElement(Re,{videoId:e,videoTitle:t,isVisible:l,onClose:d,currentTime:n}))},console.log("[WordStream] Registered FloatingControls component on global window.WordStream.Components");let Ve=null,je=null,We=null;function $e(){const e=window.location.href;return e.includes("youtube.com")?new v:e.includes("netflix.com")?new b:null}function Be(){return Me(this,void 0,void 0,(function*(){var e;if(Ve)try{const t=yield Ve.detect();!t||(e=t,!je&&!e||je&&e&&je===e)||(console.log("WordStream: Caption container changed, updating..."),je&&Ve.stopObserving(),je=t,Ve.processCaption(t),console.log("WordStream: Now observing new caption container"))}catch(e){console.error("WordStream: Error monitoring captions:",e)}}))}function qe(){return Me(this,void 0,void 0,(function*(){if(He(),Ve=$e(),Ve){console.log("WordStream: Starting caption detection...");try{yield Be(),We=window.setInterval(Be,1e3);const e=document.querySelector(".html5-video-player");if(e){new MutationObserver((e=>{e.forEach((e=>{e.target instanceof HTMLElement&&("attributes"!==e.type||"class"!==e.attributeName&&"data-state"!==e.attributeName||Be())}))})).observe(e,{attributes:!0,attributeFilter:["class","data-state"]})}}catch(e){console.error("WordStream: Error detecting captions:",e)}}}))}function He(){Ve&&(Ve.stopObserving(),Ve=null),We&&(clearInterval(We),We=null),je=null}function Ke(){var e,t;try{if("undefined"!=typeof window&&!0!==(null===(t=null===(e=window.WordStream)||void 0===e?void 0:e.local)||void 0===t?void 0:t.isAuthenticated))return void console.log("WordStream: User not authenticated, not adding floating controls");console.log("WordStream: Adding floating controls for authenticated user"),function(){const e=document.createElement("style");e.textContent="\n    .wordstream-panel {\n      position: fixed;\n      top: 80px;\n      right: 20px;\n      width: 320px;\n      max-width: 90vw;\n      height: auto;\n      max-height: 80vh;\n      background-color: white;\n      border-radius: 12px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n      z-index: 9999;\n      display: flex;\n      flex-direction: column;\n      overflow: hidden;\n      font-family: Arial, sans-serif;\n      border: 1px solid #e0e0e0;\n    }\n    \n    .panel-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 12px 16px;\n      border-bottom: 1px solid #eaeaea;\n      background-color: #f9f9f9;\n    }\n    \n    .panel-header h3 {\n      margin: 0;\n      font-size: 16px;\n      font-weight: 600;\n      color: #333;\n    }\n    \n    .close-button {\n      background: none;\n      border: none;\n      font-size: 20px;\n      color: #666;\n      cursor: pointer;\n      padding: 0 8px;\n    }\n    \n    .panel-content {\n      flex: 1;\n      overflow-y: auto;\n      padding: 16px;\n      max-height: 350px;\n    }\n    \n    .helper-text {\n      color: #666;\n      font-size: 14px;\n      margin: 0 0 16px 0;\n      text-align: center;\n    }\n    \n    .conversation-container {\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n    }\n    \n    .message {\n      display: flex;\n      flex-direction: column;\n      max-width: 100%;\n    }\n    \n    .message-sender {\n      font-weight: bold;\n      margin-bottom: 4px;\n    }\n    \n    .user-message .message-sender {\n      color: #3b82f6;\n    }\n    \n    .gemini-message .message-sender {\n      color: #10b981;\n    }\n    \n    .message-content {\n      padding: 8px 12px;\n      border-radius: 8px;\n      word-break: break-word;\n    }\n    \n    .user-message .message-content {\n      background-color: #f0f7ff;\n    }\n    \n    .gemini-message .message-content {\n      background-color: #f0fdf4;\n    }\n    \n    .panel-footer {\n      padding: 12px 16px;\n      border-top: 1px solid #eaeaea;\n      background-color: #f9f9f9;\n    }\n    \n    .input-container {\n      display: flex;\n      gap: 8px;\n    }\n    \n    .user-input {\n      flex: 1;\n      padding: 8px 12px;\n      border: 1px solid #ddd;\n      border-radius: 20px;\n      font-size: 14px;\n      resize: none;\n      outline: none;\n      min-height: 24px;\n      max-height: 120px;\n    }\n    \n    .send-button {\n      background-color: #2563eb;\n      color: white;\n      border: none;\n      border-radius: 50%;\n      width: 36px;\n      height: 36px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      cursor: pointer;\n      transition: background-color 0.2s;\n    }\n    \n    .send-button:hover {\n      background-color: #1d4ed8;\n    }\n    \n    .send-button:disabled {\n      background-color: #9ca3af;\n      cursor: not-allowed;\n    }\n    \n    .loading-spinner {\n      display: inline-block;\n      width: 16px;\n      height: 16px;\n      border: 2px solid rgba(255, 255, 255, 0.3);\n      border-radius: 50%;\n      border-top-color: white;\n      animation: spin 1s linear infinite;\n    }\n    \n    /*    ' */\n    .wordstream-floating-button {\n      width: 50px !important;\n      height: 50px !important;\n      border-radius: 50% !important;\n      background-color: rgba(235, 245, 255, 0.95) !important;\n      border: 2px solid rgba(59, 130, 246, 0.3) !important;\n      box-shadow: 0 4px 10px rgba(0,0,0,0.12), 0 0 0 3px rgba(59, 130, 246, 0.05) !important;\n      cursor: pointer !important;\n      display: flex !important;\n      align-items: center !important;\n      justify-content: center !important;\n      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;\n    }\n    \n    .wordstream-floating-button:hover {\n      transform: scale(1.12) translateY(-2px) !important;\n      box-shadow: 0 6px 16px rgba(0,0,0,0.15), 0 0 0 4px rgba(59, 130, 246, 0.15) !important;\n      background-color: rgba(224, 242, 254, 0.98) !important;\n      border: 2px solid rgba(59, 130, 246, 0.5) !important;\n    }\n    \n    .wordstream-floating-button:active {\n      transform: scale(0.95) !important;\n      box-shadow: 0 2px 8px rgba(0,0,0,0.1), 0 0 0 2px rgba(59, 130, 246, 0.2) !important;\n    }\n    \n    .wordstream-floating-button img {\n      width: 26px !important;\n      height: 26px !important;\n    }\n    \n    @keyframes spin {\n      to {\n        transform: rotate(360deg);\n      }\n    }\n  ",document.head.appendChild(e)}();const n=document.createElement("div");n.style.position="fixed",n.style.top="50%",n.style.left="20px",n.style.transform="translateY(-50%)",n.style.display="flex",n.style.flexDirection="column",n.style.gap="20px",n.style.zIndex="9999",n.id="wordstream-controls-container";const r=document.createElement("div");r.id="wordstream-panel-container",r.style.position="fixed",r.style.display="none",r.style.zIndex="9998",document.body.appendChild(r);let i=0;const o=document.createElement("button");o.id="wordstream-gemini-button",o.className="wordstream-floating-button",o.style.width="80px",o.style.height="80px",o.style.borderRadius="16px",o.style.backgroundColor="transparent",o.style.border="none",o.style.boxShadow="none",o.style.cursor="pointer",o.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",o.style.position="relative",o.style.transform="perspective(800px) rotateY(0deg)",o.setAttribute("title","AI Assistant - Get help with video content"),o.innerHTML='\n      <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 16px; background: #1e293b; transform: translateZ(-5px); box-shadow: 0 10px 30px rgba(15, 23, 42, 0.8); transition: all 0.3s ease;"></div>\n      <div style="position: absolute; top: 4px; left: 4px; right: 4px; bottom: 4px; border-radius: 12px; background: linear-gradient(135deg, #0ea5e9 0%, #3b82f6 50%, #6366f1 100%); transform: translateZ(0); transition: all 0.3s ease; overflow: hidden;">\n        <div style="position: absolute; inset: 0; background-image: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.3) 0%, transparent 50%); background-size: 150% 150%;"></div>\n        <div style="position: absolute; bottom: 0; left: 0; width: 100%; height: 40%; background: linear-gradient(to top, rgba(0,0,0,0.4), transparent);"></div>\n      </div>\n      <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; transform: translateZ(10px);">\n        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="filter: drop-shadow(0 2px 3px rgba(0,0,0,0.3)); margin-top: -2px;">\n          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>\n          <circle cx="12" cy="10" r="3"></circle>\n        </svg>\n        <div style="font-size: 10px; font-weight: 700; margin-top: 4px; letter-spacing: 0.5px; text-shadow: 0 1px 2px rgba(0,0,0,0.5);">AI CHAT</div>\n      </div>\n    ';let s=0;const a=document.createElement("button");a.id="wordstream-notes-button",a.className="wordstream-floating-button",a.style.width="80px",a.style.height="80px",a.style.borderRadius="16px",a.style.backgroundColor="transparent",a.style.border="none",a.style.boxShadow="none",a.style.cursor="pointer",a.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",a.style.position="relative",a.style.transform="perspective(800px) rotateY(0deg)",a.setAttribute("title","Video Notes - Take notes while watching"),a.innerHTML='\n      <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 16px; background: #1e293b; transform: translateZ(-5px); box-shadow: 0 10px 30px rgba(15, 23, 42, 0.8); transition: all 0.3s ease;"></div>\n      <div style="position: absolute; top: 4px; left: 4px; right: 4px; bottom: 4px; border-radius: 12px; background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%); transform: translateZ(0); transition: all 0.3s ease; overflow: hidden;">\n        <div style="position: absolute; inset: 0; background-image: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.3) 0%, transparent 50%); background-size: 150% 150%;"></div>\n        <div style="position: absolute; bottom: 0; left: 0; width: 100%; height: 40%; background: linear-gradient(to top, rgba(0,0,0,0.4), transparent);"></div>\n      </div>\n      <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; transform: translateZ(10px);">\n        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="filter: drop-shadow(0 2px 3px rgba(0,0,0,0.3));">\n          <path d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>\n          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>\n        </svg>\n        <div style="font-size: 11px; font-weight: 700; margin-top: 5px; letter-spacing: 0.5px; text-shadow: 0 1px 2px rgba(0,0,0,0.5);">NOTES</div>\n      </div>\n    ',o.addEventListener("mouseover",(()=>{o.style.transform="perspective(800px) rotateY(15deg) translateY(-5px)";const e=o.querySelector("div:first-child"),t=o.querySelector("div:nth-child(2)");e&&(e.style.boxShadow="0 15px 40px rgba(15, 23, 42, 0.8)"),t&&(t.style.filter="brightness(1.2)")})),o.addEventListener("mouseout",(()=>{o.style.transform="perspective(800px) rotateY(0deg) translateY(0)";const e=o.querySelector("div:first-child"),t=o.querySelector("div:nth-child(2)");e&&(e.style.boxShadow="0 10px 30px rgba(15, 23, 42, 0.8)"),t&&(t.style.filter="brightness(1)")})),o.addEventListener("mousedown",(()=>{o.style.transform="perspective(800px) rotateY(5deg) translateY(-2px)";const e=o.querySelector("div:first-child"),t=o.querySelector("div:nth-child(2)");e&&(e.style.boxShadow="0 5px 15px rgba(15, 23, 42, 0.7)"),t&&(t.style.filter="brightness(0.9)")})),a.addEventListener("mouseover",(()=>{a.style.transform="perspective(800px) rotateY(15deg) translateY(-5px)";const e=a.querySelector("div:first-child"),t=a.querySelector("div:nth-child(2)");e&&(e.style.boxShadow="0 15px 40px rgba(15, 23, 42, 0.8)"),t&&(t.style.filter="brightness(1.2)")})),a.addEventListener("mouseout",(()=>{a.style.transform="perspective(800px) rotateY(0deg) translateY(0)";const e=a.querySelector("div:first-child"),t=a.querySelector("div:nth-child(2)");e&&(e.style.boxShadow="0 10px 30px rgba(15, 23, 42, 0.8)"),t&&(t.style.filter="brightness(1)")})),a.addEventListener("mousedown",(()=>{a.style.transform="perspective(800px) rotateY(5deg) translateY(-2px)";const e=a.querySelector("div:first-child"),t=a.querySelector("div:nth-child(2)");e&&(e.style.boxShadow="0 5px 15px rgba(15, 23, 42, 0.7)"),t&&(t.style.filter="brightness(0.9)")})),n.appendChild(o),n.appendChild(a),document.body.appendChild(n);const l=function(){const e={small:{width:350,height:500},medium:{width:480,height:550},large:{width:640,height:600}};let t="medium",n=window.matchMedia("(prefers-color-scheme: dark)").matches;const r=document.createElement("div");r.className="wordstream-panel gemini-panel "+(n?"dark":"light"),r.id="wordstream-gemini-panel",r.style.width=`${e[t].width}px`,r.style.height=`${e[t].height}px`,r.style.position="fixed",r.style.top="80px",r.style.right="20px",r.style.zIndex="9999999",r.style.boxShadow="0 10px 25px rgba(0, 0, 0, 0.2)",r.style.borderRadius="12px",r.style.overflow="hidden",r.style.display="flex",r.style.flexDirection="column",r.style.backgroundColor=n?"#121212":"#F7F9FC",r.style.border="1px solid "+(n?"#333333":"#E0E0E0"),r.style.fontFamily='Inter, Roboto, "Segoe UI", -apple-system, BlinkMacSystemFont, Arial, sans-serif',r.style.fontSize="small"===t?"13px":"medium"===t?"14px":"16px",r.style.fontWeight="400",r.style.transition="all 0.3s ease-in-out",r.innerHTML=`\n    <div class="panel-header">\n      <h3>AI Assistant</h3>\n      <div class="header-controls">\n        <div class="size-controls">\n          <button class="size-button size-small" title="Small size">S</button>\n          <button class="size-button size-medium active" title="Medium size">M</button>\n          <button class="size-button size-large" title="Large size">L</button>\n        </div>\n        <button class="toggle-theme" title="Toggle dark/light mode">\n          ${n?'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>':'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>'}\n        </button>\n        <button class="close-button" title="Close">&times;</button>\n      </div>\n    </div>\n    <div class="panel-content">\n      <div class="messages-container" id="messages-container">\n        <div class="welcome-message">\n          <div class="welcome-icon">\n            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">\n              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>\n              <circle cx="12" cy="10" r="3"></circle>\n            </svg>\n          </div>\n          <h3>Ask about the video content</h3>\n          <p>Example: "What does this expression mean?" or "Explain the historical context"</p>\n        </div>\n      </div>\n    </div>\n    <div class="panel-footer">\n      <textarea id="user-input" placeholder="Type your question..."></textarea>\n      <button id="send-button" disabled>\n        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"></path>\n        </svg>\n      </button>\n    </div>\n  `;const i=document.createElement("style");i.textContent=`\n    .panel-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 10px 16px;\n      border-bottom: 1px solid ${n?"#333333":"#E0E0E0"};\n      background-color: ${n?"#121212":"#F7F9FC"};\n      cursor: move;\n      transition: all 0.3s ease;\n    }\n    \n    .panel-header h3 {\n      margin: 0;\n      font-size: 16px;\n      font-weight: 600;\n      color: ${n?"#FFFFFF":"#222222"};\n    }\n    \n    .header-controls {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    }\n    \n    .size-controls {\n      display: flex;\n      border: 1px solid ${n?"#444":"#ddd"};\n      border-radius: 4px;\n      overflow: hidden;\n    }\n    \n    .size-button {\n      background: ${n?"#333":"#eee"};\n      border: none;\n      color: ${n?"#B0B0B0":"#555555"};\n      width: 24px;\n      height: 24px;\n      font-size: 12px;\n      cursor: pointer;\n      padding: 0;\n      transition: all 0.2s ease;\n    }\n    \n    .size-button.active {\n      background: ${n?"#3B82F6":"#2563EB"};\n      color: white;\n    }\n    \n    .size-button:hover:not(.active) {\n      background: ${n?"#444":"#ddd"};\n    }\n    \n    .toggle-theme, .close-button {\n      background: transparent;\n      border: none;\n      color: ${n?"#B0B0B0":"#555555"};\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 24px;\n      height: 24px;\n      transition: all 0.2s ease;\n    }\n    \n    .toggle-theme:hover, .close-button:hover {\n      color: ${n?"#FFFFFF":"#222222"};\n      transform: scale(1.1);\n    }\n    \n    .close-button {\n      font-size: 20px;\n      font-weight: bold;\n    }\n    \n    .panel-content {\n      flex: 1;\n      overflow-y: auto;\n      padding: 12px;\n      position: relative;\n      padding-bottom: 120px; /*       */\n      background-color: var(--bg-color-dark);\n      display: flex;\n      flex-direction: column;\n    }\n    \n    .messages-container {\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n      padding-bottom: 30px; /*    */\n    }\n    \n    .welcome-message {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      text-align: center;\n      padding: 24px 16px;\n      color: ${n?"#CCCCCC":"#555555"};\n    }\n    \n    .welcome-icon {\n      margin-bottom: 16px;\n      color: ${n?"#B0B0B0":"#555555"};\n    }\n    \n    .welcome-message h3 {\n      margin: 0 0 8px 0;\n      color: ${n?"#FFFFFF":"#222222"};\n      font-weight: 500;\n    }\n    \n    .welcome-message p {\n      margin: 0;\n      font-size: 14px;\n    }\n    \n    .message {\n      padding: 8px 12px;\n      border-radius: 12px;\n      max-width: 80%;\n      line-height: 1.5;\n      white-space: pre-line;\n    }\n    \n    .message.user {\n      align-self: flex-end;\n      background-color: ${n?"#3B82F6":"#E0F2FE"};\n      color: ${n?"#FFFFFF":"#222222"};\n      margin-left: auto;\n    }\n    \n    .message.ai {\n      align-self: flex-start;\n      background-color: ${n?"#1E1E1E":"#FFFFFF"};\n      color: ${n?"#FFFFFF":"#222222"};\n      margin-right: auto;\n    }\n    \n    .panel-footer {\n      padding: 10px 12px;\n      border-top: 1px solid ${n?"#333333":"#E0E0E0"};\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      background-color: ${n?"#1E1E1E":"#F7F9FC"};\n      z-index: 2;\n      box-sizing: border-box;\n      transition: all 0.3s ease;\n      height: auto; /* Ensure height is calculated based on content */\n      min-height: 60px; /* Minimum height for the footer */\n    }\n    \n    #user-input {\n      flex-grow: 1;\n      padding: 8px 12px;\n      border-radius: 10px;\n      border: 1px solid ${n?"#444":"#ddd"};\n      background-color: ${n?"#2C2C2C":"#FFFFFF"};\n      color: ${n?"#FFFFFF":"#222222"};\n      resize: none;\n      font-family: inherit;\n      font-size: 14px;\n      min-height: 20px;\n      max-height: 120px;\n      transition: all 0.2s ease;\n    }\n    \n    #user-input:focus {\n      outline: none;\n      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);\n      border-color: ${n?"#3B82F6":"#2563EB"};\n    }\n    \n    #user-input::placeholder {\n      color: ${n?"#888888":"#999999"};\n    }\n    \n    #send-button {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 36px;\n      height: 36px;\n      border-radius: 10px;\n      border: none;\n      background-color: ${n?"#3B82F6":"#2563EB"};\n      color: white;\n      cursor: pointer;\n      transition: all 0.2s ease;\n    }\n    \n    #send-button:hover:not(:disabled) {\n      transform: scale(1.05);\n      background-color: ${n?"#2563EB":"#1D4ED8"};\n    }\n    \n    #send-button:disabled {\n      background-color: ${n?"#444":"#ddd"};\n      color: ${n?"#888":"#aaa"};\n      cursor: not-allowed;\n    }\n    \n    .loading-indicator {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 8px 12px;\n      border-radius: 12px;\n      background-color: ${n?"#1E1E1E":"#FFFFFF"};\n      color: ${n?"#FFFFFF":"#222222"};\n      align-self: flex-start;\n      max-width: 80%;\n    }\n    \n    .spinner {\n      width: 16px;\n      height: 16px;\n      border: 2px solid rgba(${n?"255,255,255,0.1":"0,0,0,0.1"});\n      border-top-color: ${n?"#3B82F6":"#2563EB"};\n      border-radius: 50%;\n      animation: spin 0.8s linear infinite;\n    }\n    \n    @keyframes spin {\n      to { transform: rotate(360deg); }\n    }\n  `,r.appendChild(i);let o=!1,s=0,a=0;const l=r.querySelector(".panel-header");l&&l.addEventListener("mousedown",(e=>{e.target.closest("button")||(o=!0,s=e.clientX-r.getBoundingClientRect().left,a=e.clientY-r.getBoundingClientRect().top)}));document.addEventListener("mousemove",(e=>{o&&(r.style.left=e.clientX-s+"px",r.style.top=e.clientY-a+"px")})),document.addEventListener("mouseup",(()=>{o=!1,b()}));const c=r.querySelector(".toggle-theme");c&&c.addEventListener("click",(()=>{n=!n,r.className="wordstream-panel gemini-panel "+(n?"dark":"light"),v()}));const u=r.querySelectorAll(".size-button");u.forEach((e=>{e.addEventListener("click",(()=>{e.classList.contains("size-small")?g("small"):e.classList.contains("size-medium")?g("medium"):e.classList.contains("size-large")&&g("large"),u.forEach((e=>e.classList.remove("active"))),e.classList.add("active")}))}));const d=r.querySelector(".close-button");d&&d.addEventListener("click",(()=>{r.style.display="none";const e=new CustomEvent("geminiPanelClosed");document.dispatchEvent(e)}));const h=r.querySelector("#user-input"),f=r.querySelector("#send-button");if(h&&f){function w(e){e.style.height="auto",e.style.height=Math.min(e.scrollHeight,120)+"px"}h.addEventListener("input",(()=>{f.disabled=""===h.value.trim(),w(h)})),f.addEventListener("click",p),h.addEventListener("keydown",(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),p())}))}function p(){return Me(this,void 0,void 0,(function*(){var e,t;if(!h||""===h.value.trim())return;if("undefined"!=typeof window&&!0!==(null===(t=null===(e=window.WordStream)||void 0===e?void 0:e.local)||void 0===t?void 0:t.isAuthenticated))return console.log("WordStream Gemini: Chat blocked - user not authenticated"),void m("Authentication required to use WordStream Gemini Chat. Please sign in to continue.","ai");const n=h.value.trim();h.value="",h.style.height="auto",f.disabled=!0,m(n,"user");const i=document.createElement("div");i.className="loading-indicator",i.innerHTML='\n      <div class="spinner"></div>\n      <div>Processing...</div>\n    ';const o=r.querySelector(".messages-container");o&&(o.appendChild(i),o.scrollTop=o.scrollHeight);try{const e=y(),t=document.title,r=yield chrome.runtime.sendMessage({action:"gemini",message:n,videoId:e,videoTitle:t});if(o&&i.parentNode===o&&o.removeChild(i),!r||!r.success)throw new Error((null==r?void 0:r.error)||"Failed to get response");m(r.answer,"ai")}catch(e){console.error("Error sending message to Gemini:",e),o&&i.parentNode===o&&o.removeChild(i),m("Sorry, there was an error processing your request. Please try again.","ai")}}))}function m(e,t){const n=document.createElement("div");n.className=`message ${t}`,n.textContent=e;const i=r.querySelector(".welcome-message"),o=r.querySelector(".messages-container");if(o){i&&i.parentNode===o&&o.removeChild(i),o.appendChild(n);const e=50;setTimeout((()=>{o.scrollTop=o.scrollHeight+e;const t=r.querySelector(".panel-content");t&&(t.scrollTop=t.scrollHeight+e),setTimeout((()=>{o.scrollTop=o.scrollHeight+e,t&&(t.scrollTop=t.scrollHeight+e),setTimeout((()=>{o.scrollTop=o.scrollHeight+e,t&&(t.scrollTop=t.scrollHeight+e),setTimeout((()=>{o.scrollTop=o.scrollHeight+e,t&&(t.scrollTop=t.scrollHeight+e)}),300)}),300)}),200)}),50)}}function g(n){t=n,r.style.width=`${e[n].width}px`,r.style.height=`${e[n].height}px`,b()}function v(){const e=r.querySelector(".panel-header"),t=r.querySelector(".panel-content"),i=r.querySelector(".panel-footer"),o=r.querySelector("#user-input");if(e&&t&&i&&o){r.style.backgroundColor=n?"#121212":"#FFFFFF",r.style.border="1px solid "+(n?"#333333":"#E0E0E0"),e.style.borderBottom="1px solid "+(n?"#333333":"#E0E0E0"),e.style.backgroundColor=n?"#1E1E1E":"#F0F2F5";const s=e.querySelector("h3");s&&(s.style.color=n?"#FFFFFF":"#050505"),t.style.backgroundColor=n?"#121212":"#FFFFFF",t.style.color=n?"#FFFFFF":"#050505",i.style.borderTop="1px solid "+(n?"#333333":"#E0E0E0"),i.style.backgroundColor=n?"#1E1E1E":"#F0F2F5",o.style.borderColor=n?"#444":"#ddd",o.style.backgroundColor=n?"#2D2D2D":"#FFFFFF",o.style.color=n?"#FFFFFF":"#050505";r.querySelectorAll(".message.ai").forEach((e=>{e.style.backgroundColor=n?"#2a2a30":"#eff1f5",e.style.color=n?"#e8e8e8":"#333333",e.style.border="1px solid "+(n?"#444444":"#e0e0e0")}));r.querySelectorAll(".message.user").forEach((e=>{e.style.backgroundColor=n?"#4c6ef5":"#4b8df8",e.style.color="#FFFFFF",e.style.border="none"}));r.querySelectorAll(".size-button:not(.active)").forEach((e=>{e.style.backgroundColor=n?"#333":"#e8e8e8",e.style.color=n?"#ccc":"#555"}));const a=r.querySelector(".toggle-theme");a&&(a.style.background="transparent",a.style.border="none",a.style.borderRadius="50%",a.style.padding="6px",a.style.color=n?"#ffd700":"#7c3aed",a.style.boxShadow="none",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.gap="0",a.style.width="32px",a.style.height="32px",a.title=n?"Switch to Light Mode":"Switch to Dark Mode",a.innerHTML=n?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>':'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>')}}function y(){const e=window.location.href;return new URLSearchParams(new URL(e).search).get("v")||""}function b(){const e=window.innerWidth,t=window.innerHeight,n=r.getBoundingClientRect();n.right>e&&(r.style.left=e-n.width+"px"),n.bottom>t&&(r.style.top=t-n.height+"px"),n.left<0&&(r.style.left="0px"),n.top<0&&(r.style.top="0px")}return window.addEventListener("resize",b),r}(),c=function(){var e;const t=document.createElement("div");t.className="wordstream-panel notes-panel medium",t.id="wordstream-notes-panel";const n={small:{width:"350px",height:"500px"},medium:{width:"480px",height:"400px"},large:{width:"640px",height:"600px"}},r=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;r?t.classList.add("dark-mode"):t.classList.add("light-mode");t.style.position="fixed",t.style.width="480px",t.style.height="550px",t.style.top="80px",t.style.left="20px",t.style.zIndex="9999999",t.style.backgroundColor=r?"#121212":"#F7F8FA",t.style.color=r?"#ffffff":"#333333",t.style.border="1px solid "+(r?"#333333":"#e0e0e0"),t.style.borderRadius="12px",t.style.overflow="hidden",t.style.display="flex",t.style.flexDirection="column",t.style.boxShadow="0 4px 12px rgba(0,0,0,0.2)",t.style.fontFamily="Inter, Roboto, Arial, sans-serif",t.style.transition="width 0.3s, height 0.3s",t.style.resize="both",t.style.maxWidth="90vw",t.style.maxHeight="90vh",t.style.minWidth="250px",t.style.minHeight="200px";const i=()=>{setTimeout((()=>{const e=t.querySelector(".panel-footer");e&&!r&&(e.style.backgroundColor="#F0F2F7")}),100)};t.innerHTML=`\n    <style>\n      :root {\n        --bg-color-light: #F7F8FA;\n        --text-color-light: #222222;\n        --border-color-light: #D9D9D9;\n        --header-bg-light: #F0F2F7;\n        --footer-bg-light: #F0F2F7;\n        --button-primary-light: #2563eb;\n        --button-hover-light: #1d4ed8;\n        --button-text-light: #ffffff;\n        --input-border-light: #D9D9D9;\n        --secondary-bg-light: #F0F2F7;\n        --note-bg-light: #FFFFFF;\n        --text-dark-light: #222222;\n        --text-muted-light: #444444;\n        --font-family: 'Roboto', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;\n        --font-size-normal: 15px;\n        --font-weight-normal: 400;\n        \n        --bg-color-dark: #121212;\n        --text-color-dark: #ffffff;\n        --border-color-dark: #333333;\n        --header-bg-dark: #1e1e1e;\n        --footer-bg-dark: #1e1e1e;\n        --button-primary-dark: #3b82f6;\n        --button-hover-dark: #2563eb;\n        --button-text-dark: #ffffff;\n        --input-border-dark: #444;\n        --secondary-bg-dark: #1e1e1e;\n      }\n      \n      .notes-panel.dark-mode {\n        background-color: var(--bg-color-dark);\n        color: var(--text-color-dark);\n        border-color: var(--border-color-dark);\n      }\n      \n      .notes-panel.light-mode {\n        background-color: var(--bg-color-light);\n        color: var(--text-color-light);\n        border-color: var(--border-color-light);\n      }\n      \n      .notes-panel * {\n        font-family: var(--font-family);\n        font-size: var(--font-size-normal);\n        font-weight: var(--font-weight-normal);\n      }\n      \n      .panel-header {\n        padding: 12px 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        border-bottom: 1px solid var(--border-color-light);\n        cursor: move;\n        user-select: none;\n        font-weight: 600;\n        font-size: 16px;\n      }\n      \n      .dark-mode .panel-header {\n        background-color: var(--header-bg-dark);\n        border-bottom-color: var(--border-color-dark);\n        color: var(--text-color-dark);\n      }\n      \n      .light-mode .panel-header {\n        background-color: var(--header-bg-light);\n        border-bottom-color: var(--border-color-light);\n        color: var(--text-dark-light);\n      }\n      \n      .size-controls {\n        display: flex;\n        border: 1px solid var(--input-border-light);\n        border-radius: 4px;\n        overflow: hidden;\n      }\n      \n      .dark-mode .size-controls {\n        border-color: var(--input-border-dark);\n      }\n      \n      .size-button {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 24px;\n        height: 24px;\n        font-size: 12px;\n        border: none;\n        background-color: transparent;\n        cursor: pointer;\n      }\n      \n      .size-button.active {\n        background-color: var(--button-primary-light);\n        color: var(--button-text-light);\n        font-weight: bold;\n        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.4);\n      }\n      \n      .dark-mode .size-button {\n        color: #ccc;\n        background-color: #333;\n      }\n      \n      .dark-mode .size-button.active {\n        background-color: var(--button-primary-dark);\n        color: var(--button-text-dark);\n      }\n      \n      .light-mode .size-button {\n        color: #666;\n        background-color: #f0f0f0;\n      }\n      \n      .light-mode .size-button.active {\n        background-color: var(--button-primary-light);\n        color: var(--button-text-light);\n      }\n      \n      .close-button {\n        background: transparent;\n        border: none;\n        font-size: 20px;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 24px;\n        height: 24px;\n        color: inherit;\n      }\n      \n      .header-controls {\n        display: flex;\n        gap: 8px;\n        align-items: center;\n      }\n      \n      .theme-button {\n        background: transparent;\n        border: none;\n        cursor: pointer;\n        padding: 6px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 32px;\n        height: 32px;\n        transition: all 0.2s ease;\n      }\n      \n      .panel-content {\n        flex: 1;\n        overflow-y: auto;\n        padding: 16px;\n        position: relative;\n        padding-bottom: 120px; /*       */\n        background-color: var(--bg-color-dark);\n        display: flex;\n        flex-direction: column;\n      }\n      \n      .light-mode .panel-content {\n        background-color: var(--bg-color-light);\n      }\n      \n      .panel-content::-webkit-scrollbar {\n        width: 6px;\n      }\n      \n      .panel-content::-webkit-scrollbar-thumb {\n        background-color: rgba(128, 128, 128, 0.5);\n        border-radius: 4px;\n      }\n      \n      .dark-mode .panel-content::-webkit-scrollbar-thumb {\n        background-color: rgba(200, 200, 200, 0.3);\n      }\n      \n      .panel-footer {\n        padding: 12px 16px;\n        border-top: 1px solid var(--border-color-dark);\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n        position: absolute;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        background-color: var(--footer-bg-dark);\n        z-index: 10; /* Ensure it's above content */\n        height: auto; /* Ensure height is calculated based on content */\n        min-height: 70px; /* Minimum height for the footer */\n      }\n      \n      .light-mode .panel-footer {\n        background-color: var(--footer-bg-light);\n        border-top-color: var(--border-color-light);\n      }\n      \n      .current-timestamp {\n        font-size: 12px;\n        display: flex;\n        align-items: center;\n        gap: 4px;\n      }\n      \n      .dark-mode .current-timestamp {\n        color: #aaaaaa;\n      }\n      \n      .light-mode .current-timestamp {\n        color: #666666;\n      }\n      \n      #note-input {\n        resize: none;\n        height: 60px;\n        padding: 12px 16px;\n        width: 100%;\n        box-sizing: border-box;\n        border-radius: 12px;\n        border: 1px solid var(--input-border-dark);\n        font-family: inherit;\n        font-size: 14px;\n        transition: border-color 0.2s;\n      }\n      \n      #note-input:focus {\n        outline: none;\n        border-color: var(--button-primary-dark);\n        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);\n      }\n      \n      .dark-mode #note-input:focus {\n        border-color: var(--button-primary-dark);\n        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);\n      }\n      \n      .dark-mode #note-input {\n        background-color: #2d2d2d;\n        color: #ffffff;\n        border-color: var(--input-border-dark);\n      }\n      \n      .light-mode #note-input {\n        background-color: #ffffff;\n        color: #333333;\n        border-color: var(--input-border-light);\n        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n      }\n      \n      #add-timestamp-button {\n        display: flex;\n        align-items: center;\n        gap: 4px;\n        padding: 6px 8px;\n        border-radius: 4px;\n        border: none;\n        cursor: pointer;\n        font-size: 12px;\n        margin-left: auto;\n        transition: background-color 0.2s, transform 0.1s;\n      }\n      \n      .dark-mode #add-timestamp-button {\n        background-color: #2d2d2d;\n        color: #aaaaaa;\n      }\n      \n      .light-mode #add-timestamp-button {\n        background-color: #f0f0f0;\n        color: #666666;\n      }\n      \n      #add-timestamp-button:hover {\n        background-color: var(--button-primary-light);\n        color: white;\n        transform: translateY(-1px);\n      }\n      \n      .dark-mode #add-timestamp-button:hover {\n        background-color: var(--button-primary-dark);\n      }\n      \n      #save-note-button {\n        padding: 8px 16px;\n        background-color: var(--button-primary-dark);\n        color: var(--button-text-dark);\n        border: none;\n        border-radius: 8px;\n        cursor: pointer;\n        font-weight: 500;\n        font-size: 14px;\n        align-self: flex-end;\n        transition: background-color 0.2s, transform 0.1s;\n      }\n      \n      #save-note-button:hover {\n        background-color: var(--button-hover-dark);\n        transform: translateY(-1px);\n      }\n      \n      .dark-mode #save-note-button {\n        background-color: var(--button-primary-dark);\n      }\n      \n      .light-mode #save-note-button {\n        background-color: var(--button-primary-light);\n        color: var(--button-text-light);\n      }\n      \n      .dark-mode #save-note-button:hover {\n        background-color: var(--button-hover-dark);\n      }\n      \n      .light-mode #save-note-button:hover {\n        background-color: var(--button-hover-light);\n      }\n      \n      /*     */\n      .notes-container {\n        overflow-y: auto;\n        max-height: calc(100% - 120px);\n        padding-bottom: 120px; /*    "   */\n      }\n      \n      /*     */\n      .note-item {\n        padding: 10px;\n        overflow-wrap: break-word; \n        white-space: pre-wrap;\n        word-wrap: break-word; \n      }\n      \n      .note-item .note-content {\n        white-space: normal;\n        word-break: break-word;\n        overflow-wrap: break-word;\n        max-width: 100%;\n      }\n      \n      /* Adjusted container heights for different sizes */\n      .notes-panel.small .notes-container {\n        max-height: calc(100% - 150px); /* Adjust based on header/footer heights */\n      }\n      \n      .notes-panel.medium .notes-container {\n        max-height: calc(100% - 150px);\n      }\n      \n      .notes-panel.large .notes-container {\n        max-height: calc(100% - 150px);\n      }\n      \n      .light-mode .notes-container {\n        color: var(--text-dark-light);\n        background-color: transparent; /* Explicitly transparent to adopt parent bg */\n      }\n\n      .dark-mode .notes-container {\n        background-color: transparent;\n      }\n      \n      .no-notes {\n        text-align: center;\n        padding: 40px 0;\n        color: #888;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n      }\n      \n      .dark-mode .no-notes {\n        color: #aaa;\n      }\n      \n      .light-mode .no-notes {\n        color: #888;\n      }\n      \n      .note-item {\n        border: 1px solid var(--border-color-dark);\n        border-radius: 8px;\n        overflow: hidden;\n      }\n      \n      .dark-mode .note-item {\n        border-color: var(--border-color-dark);\n        background-color: var(--bg-color-dark);\n      }\n      \n      .light-mode .note-item {\n        border-color: var(--border-color-light);\n        background-color: var(--note-bg-light);\n        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n        color: var(--text-dark-light);\n      }\n      \n      .note-header {\n        padding: 8px 12px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        background-color: var(--header-bg-dark);\n        border-bottom: 1px solid var(--border-color-dark);\n        font-size: 12px;\n      }\n      \n      .dark-mode .note-header {\n        background-color: var(--header-bg-dark);\n        border-bottom-color: var(--border-color-dark);\n      }\n      \n      .light-mode .note-header {\n        background-color: var(--secondary-bg-light);\n        border-bottom-color: var(--border-color-light);\n        color: var(--text-dark-light);\n      }\n      \n      .timestamp {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n      }\n      \n      .dark-mode .timestamp {\n        color: #aaaaaa;\n      }\n      \n      .light-mode .timestamp {\n        color: var(--text-muted-light);\n      }\n      \n      .timestamp-icon {\n        width: 14px;\n        height: 14px;\n      }\n      \n      .note-actions {\n        display: flex;\n        gap: 8px;\n      }\n      \n      .jump-button, .delete-button {\n        background: transparent;\n        border: none;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        padding: 4px;\n        font-size: 12px;\n        transition: color 0.2s, transform 0.1s;\n      }\n      \n      .dark-mode .jump-button {\n        color: #aaaaaa;\n      }\n      \n      .light-mode .jump-button {\n        color: var(--text-muted-light);\n      }\n      \n      .jump-button:hover {\n        transform: translateY(-1px);\n      }\n      \n      .dark-mode .jump-button:hover {\n        color: #ffffff;\n      }\n      \n      .light-mode .jump-button:hover {\n        color: var(--button-primary-light);\n      }\n      \n      .delete-button {\n        color: #ef4444;\n      }\n      \n      .note-content {\n        padding: 12px;\n        white-space: pre-line;\n      }\n      \n      .dark-mode .note-content {\n        background-color: var(--bg-color-dark);\n      }\n      \n      .light-mode .note-content {\n        background-color: var(--note-bg-light);\n        color: var(--text-dark-light);\n      }\n      \n      .empty-notes-icon {\n        margin-bottom: 16px;\n      }\n      \n      .dark-mode .empty-notes-icon svg {\n        stroke: #aaaaaa;\n      }\n      \n      .light-mode .empty-notes-icon svg {\n        stroke: #888888;\n      }\n      \n      /*    SMALL */\n      .notes-panel.small .panel-header {\n        padding: 8px 12px;\n        font-size: 14px;\n      }\n      \n      .notes-panel.small .panel-content {\n        padding: 10px;\n        padding-bottom: 110px;\n      }\n      \n      .notes-panel.small .panel-footer {\n        padding: 8px 12px;\n      }\n      \n      .notes-panel.small #note-input {\n        padding: 8px 12px;\n        height: 50px;\n        font-size: 13px;\n      }\n      \n      .notes-panel.small .size-button {\n        width: 20px;\n        height: 20px;\n      }\n      \n      .notes-panel.small .note-item {\n        font-size: 13px;\n      }\n      \n      .notes-panel.small .note-content {\n        padding: 8px;\n      }\n      \n      .notes-panel.small .note-header {\n        padding: 6px 10px;\n        font-size: 11px;\n      }\n      \n      .notes-panel.small #save-note-button {\n        padding: 6px 12px;\n        font-size: 13px;\n      }\n\n      /*   */\n      .notes-panel.medium .panel-content {\n        padding-bottom: 130px;\n      }\n      \n      .notes-panel.large .panel-content {\n        padding-bottom: 140px;\n      }\n      \n      .notes-panel.large .panel-header {\n        padding: 14px 20px;\n        font-size: 18px;\n      }\n      \n      .notes-panel.large #note-input {\n        padding: 14px 20px;\n        height: 70px;\n        font-size: 15px;\n      }\n      \n      /* Ensure smooth transition between dark and light */\n      .notes-panel * {\n        transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;\n      }\n      \n      /* Additional explicit background colors for all internal containers */\n      .light-mode .timestamp, \n      .light-mode .note-actions,\n      .light-mode .jump-button {\n        background-color: transparent;\n      }\n      \n      .light-mode .note-header {\n        background-color: var(--secondary-bg-light);\n      }\n      \n      .light-mode .current-timestamp,\n      .light-mode #add-timestamp-button {\n        background-color: transparent;\n      }\n\n      /*        */\n      .light-mode .no-notes,\n      .light-mode .empty-notes-icon,\n      .light-mode #notes-container {\n        background-color: var(--bg-color-light);\n      }\n\n      /*       ,      */\n      .light-mode.notes-panel *:not(.size-button, .size-button.active, #save-note-button, button.theme-button, .panel-header, .panel-footer, .note-header) {\n        background-color: var(--bg-color-light);\n      }\n\n      /*       -  panel-footer   */\n      .light-mode.notes-panel *:not(.size-button, .size-button.active, #save-note-button, button.theme-button, .panel-header, .note-header) {\n        background-color: var(--bg-color-light);\n      }\n      \n      /*         */\n      .light-mode.notes-panel .panel-footer {\n        background-color: var(--footer-bg-light) !important;\n        border-top-color: var(--border-color-light) !important;\n        color: var(--text-dark-light) !important;\n      }\n      \n      /*   -HTML   panel-footer     */\n      .light-mode.notes-panel div.panel-footer {\n        background-color: var(--footer-bg-light) !important;\n      }\n      \n      /*         */\n      .light-mode.notes-panel .panel-footer .current-timestamp {\n        background-color: transparent !important;\n        color: var(--text-muted-light) !important;\n      }\n      \n      /*       */\n      .light-mode.notes-panel .panel-footer #note-input {\n        background-color: #FFFFFF !important;\n        color: var(--text-dark-light) !important;\n        border: 1px solid var(--border-color-light) !important;\n      }\n    </style>\n    \n    <div class="panel-header">\n      <div>Notes & Summary</div>\n      <div class="header-controls">\n        <div class="size-controls">\n          <button class="size-button" data-size="small">S</button>\n          <button class="size-button active" data-size="medium">M</button>\n          <button class="size-button" data-size="large">L</button>\n        </div>\n        <button class="theme-button">\n          ${r?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n              <path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />\n            </svg>':'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n              <path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />\n            </svg>'}\n        </button>\n        <button class="close-button"></button>\n      </div>\n    </div>\n    \n    <div class="panel-content">\n      <div class="notes-container" id="notes-container">\n        <div class="no-notes">\n          <div class="empty-notes-icon">\n            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">\n              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>\n              <polyline points="14 2 14 8 20 8"></polyline>\n              <line x1="16" y1="13" x2="8" y2="13"></line>\n              <line x1="16" y1="17" x2="8" y2="17"></line>\n              <polyline points="10 9 9 9 8 9"></polyline>\n            </svg>\n          </div>\n          <h3 style="margin-bottom: 8px; color: ${r?"#ffffff":"#222222"}; font-family: var(--font-family); font-size: 16px; font-weight: 500;">Take notes while watching</h3>\n          <p style="max-width: 280px; margin-bottom: 24px; font-size: 15px; color: ${r?"#aaaaaa":"#555555"}; font-family: var(--font-family);">\n            Add your notes below to capture important moments\n          </p>\n        </div>\n      </div>\n    </div>\n    \n    <div class="panel-footer">\n      <div class="current-timestamp" id="current-timestamp">\n        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <circle cx="12" cy="12" r="10"></circle>\n          <polyline points="12 6 12 12 16 14"></polyline>\n        </svg>\n        Current time: <span id="timestamp-value">--:--</span>\n        <button id="add-timestamp-button" style="\n          display: flex;\n          align-items: center;\n          gap: 4px;\n          padding: 6px 8px;\n          border-radius: 4px;\n          border: none;\n          background-color: ${r?"#2d2d2d":"#F0F2F7"};\n          color: ${r?"#aaaaaa":"#444444"};\n          cursor: pointer;\n          font-size: 12px;\n          margin-left: auto;\n          transition: background-color 0.2s, color 0.2s, transform 0.1s;\n        ">\n          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M12 2v10l5 5"></path>\n            <circle cx="12" cy="12" r="10"></circle>\n          </svg>\n          Add timestamp\n        </button>\n      </div>\n      \n      <textarea id="note-input" placeholder="Write your note about this video..."></textarea>\n      <button id="save-note-button">Save Note</button>\n    </div>\n  `,document.body.appendChild(t),i();let o=!1,s=0,a=0,l=0,c=0;const u=()=>{const e=t.querySelectorAll(".size-button"),n=t.classList.contains("dark-mode");e.forEach((e=>{e.classList.contains("active")?(e.style.backgroundColor="#3b82f6",e.style.color="white"):(e.style.backgroundColor=n?"#333":"#f0f0f0",e.style.color=n?"#ccc":"#666")}))},d=(document.title,window.location.href);let h="";if(d.includes("youtube.com")){const e=new URLSearchParams(new URL(d).search);h=e.get("v")||""}else if(d.includes("netflix.com")){const e=new URL(d).pathname.split("/");h=e[e.length-1]||"unknown"}function f(e){const n=t.querySelector("#notes-container");if(!n)return;n.querySelector(".no-notes");if(0===e.length)return void(n.innerHTML=`\n        <div class="no-notes">\n          <div class="empty-notes-icon">\n            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">\n              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>\n              <polyline points="14 2 14 8 20 8"></polyline>\n              <line x1="16" y1="13" x2="8" y2="13"></line>\n              <line x1="16" y1="17" x2="8" y2="17"></line>\n              <polyline points="10 9 9 9 8 9"></polyline>\n            </svg>\n          </div>\n          <h3 style="margin-bottom: 8px; color: ${r?"#ffffff":"#222222"}; font-family: var(--font-family); font-size: 16px; font-weight: 500;">Take notes while watching</h3>\n          <p style="max-width: 280px; margin-bottom: 24px; font-size: 15px; color: ${r?"#aaaaaa":"#555555"}; font-family: var(--font-family);">\n            Add your notes below to capture important moments\n          </p>\n        </div>\n      `);let i="";e.forEach(((e,t)=>{i+=`\n        <div class="note-item">\n          <div class="note-header">\n            <div class="timestamp">\n              <svg class="timestamp-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                <circle cx="12" cy="12" r="10"></circle>\n                <polyline points="12 6 12 12 16 14"></polyline>\n              </svg>\n              <span>${e.videoTime?g(e.videoTime):"No timestamp"}</span>\n            </div>\n            <div class="note-actions">\n              ${e.videoTime?`\n                <button class="jump-button" data-time="${e.videoTime}">\n                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                    <polygon points="5 3 19 12 5 21 5 3"></polygon>\n                  </svg>\n                  Jump\n                </button>\n              `:""}\n              <button class="delete-button" data-index="${t}">\n                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                  <path d="M3 6h18"></path>\n                  <path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"></path>\n                </svg>\n              </button>\n            </div>\n          </div>\n          <div class="note-content">${e.content}</div>\n        </div>\n      `})),n.innerHTML=i;n.querySelectorAll(".jump-button").forEach((e=>{e.addEventListener("click",(function(){y(parseFloat(this.getAttribute("data-time")||"0"))}))}));n.querySelectorAll(".delete-button").forEach((e=>{e.addEventListener("click",(function(){v(parseInt(this.getAttribute("data-index")||"0"))}))})),setTimeout((()=>{n.scrollTop=n.scrollHeight}),50)}function p(){chrome.storage.local.get([`notes-${h}`],(e=>{const n=e[`notes-${h}`]||[];f(n);const r=t.querySelector("#notes-container");r&&(r.scrollTop=r.scrollHeight),n.length>0&&m(n)}))}function m(e){chrome.storage.local.get(["notes_storage"],(t=>{const n=t.notes_storage||{};if(!n[h]||!n[h].notes){const t=document.title.replace(" - YouTube","").trim(),r=window.location.href;n[h]={videoId:h,videoTitle:t,videoURL:r,lastUpdated:(new Date).toISOString(),notes:e.map((e=>(!e.formattedTime&&e.videoTime&&(e.formattedTime=g(e.videoTime)),e)))},chrome.storage.local.set({notes_storage:n},(()=>{console.log("[WordStream] Notes migrated to unified storage")}))}}))}function g(e){const t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function v(e){chrome.storage.local.get([`notes-${h}`],(t=>{const n=t[`notes-${h}`]||[];n.splice(e,1),chrome.storage.local.set({[`notes-${h}`]:n},(()=>{f(n)}))}))}function y(e){const t=document.querySelector("video");t&&(t.currentTime=e,t.play().catch((()=>{console.log("WordStream: Could not play video automatically")})))}let b=null;function w(){const e=document.querySelector("video"),n=t.querySelector("#timestamp-value");if(e&&n){const t=e.currentTime;n.textContent=g(t)}}b=setInterval(w,1e3);const S=t.querySelector(".panel-header");S&&(S.addEventListener("mousedown",(e=>{e.target.closest("button")||(o=!0,s=e.clientX,a=e.clientY,l=parseInt(t.style.top)||0,c=parseInt(t.style.left)||0,e.preventDefault())})),document.addEventListener("mousemove",(e=>{if(o){const n=e.clientX-s,r=e.clientY-a;t.style.top=`${l+r}px`,t.style.left=`${c+n}px`}})),document.addEventListener("mouseup",(()=>{o=!1})));const E=t.querySelectorAll(".size-button");E.forEach((e=>{e.addEventListener("click",(function(){const e=this.getAttribute("data-size");e&&n[e]&&(E.forEach((e=>e.classList.remove("active"))),this.classList.add("active"),t.style.width=n[e].width,t.style.height=n[e].height,t.classList.remove("small","medium","large"),t.classList.add(e),u())}))}));const k=t.querySelector(".theme-button");k&&(k.style.background="transparent",k.style.border="none",k.style.borderRadius="50%",k.style.padding="6px",k.style.color=r?"#ffd700":"#7c3aed",k.style.boxShadow="none",k.style.display="flex",k.style.alignItems="center",k.style.justifyContent="center",k.style.gap="0",k.style.width="32px",k.style.height="32px",k.title=r?"Switch to Light Mode":"Switch to Dark Mode",k.innerHTML=r?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>':'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>',k.addEventListener("click",(function(){t.classList.contains("dark-mode")?(t.classList.remove("dark-mode"),t.classList.add("light-mode"),t.style.backgroundColor="#F7F8FA",t.style.color="#333333",t.style.border="1px solid #e0e0e0",i(),k.style.background="transparent",k.style.border="none",k.style.color="#000000",k.style.padding="6px",k.style.width="32px",k.style.height="32px",k.title="Switch to Dark Mode",k.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>'):(t.classList.remove("light-mode"),t.classList.add("dark-mode"),t.style.backgroundColor="#121212",t.style.color="#ffffff",t.style.border="1px solid #333333",i(),k.style.background="transparent",k.style.border="none",k.style.color="#ffffff",k.style.padding="6px",k.style.width="32px",k.style.height="32px",k.title="Switch to Light Mode",k.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>'),u()})));null===(e=t.querySelector(".close-button"))||void 0===e||e.addEventListener("click",(()=>{t.style.display="none",b&&(clearInterval(b),b=null)}));const _=t.querySelector("#add-timestamp-button"),x=t.querySelector("#note-input");_&&x&&_.addEventListener("click",(()=>{const e=document.querySelector("video");if(e){const t=g(e.currentTime);x.value+=(x.value?"\n":"")+`[${t}] `,x.focus()}}));const T=t.querySelector("#save-note-button");T&&x&&T.addEventListener("click",(()=>{const e=x.value.trim();if(!e)return;const n=document.querySelector("video"),r=n?n.currentTime:void 0,i=r?g(r):void 0,o={id:Date.now().toString(),content:e,timestamp:(new Date).toISOString(),videoTime:r,formattedTime:i};chrome.storage.local.get([`notes-${h}`],(e=>{const n=e[`notes-${h}`]||[];n.push(o),chrome.storage.local.set({[`notes-${h}`]:n},(()=>{x.value="",f(n);const e=t.querySelector("#notes-container");e&&(e.scrollTop=e.scrollHeight),I(o)}))}))}));function I(e){const t=document.title.replace(" - YouTube","").trim(),n=window.location.href;chrome.storage.local.get(["notes_storage"],(r=>{const i=r.notes_storage||{};i[h]||(i[h]={videoId:h,videoTitle:t,videoURL:n,lastUpdated:(new Date).toISOString(),notes:[]}),i[h].lastUpdated=(new Date).toISOString(),i[h].notes.push(e),chrome.storage.local.set({notes_storage:i},(()=>{console.log("[WordStream] Note saved to unified storage")}))}))}return p(),t}();let u=null;function d(){const e=document.getElementById("current-timestamp");if(e){const t=document.querySelector("video");if(t){const n=Math.floor(t.currentTime);e.textContent=`Current position: ${p(n)}`}}}function h(){const e=f();if(e)try{if("undefined"!=typeof chrome&&chrome.storage&&chrome.storage.local)chrome.storage.local.get(["videoNotes"],(t=>{m((t.videoNotes||{})[e]||[])}));else{const t=localStorage.getItem("wordstream_notes");m((t?JSON.parse(t):{})[e]||[])}}catch(e){console.error("[WordStream] Error loading notes:",e)}}function f(){const e=window.location.href;if(e.includes("youtube.com/watch")){return new URLSearchParams(window.location.search).get("v")||"unknown"}if(e.includes("netflix.com/watch")){const t=e.match(/watch\/(\d+)/);return t?t[1]:"unknown"}return"unknown"}function p(e){const t=e%60;return`${Math.floor(e/60)}:${t<10?"0":""}${t}`}function m(e){const t=document.getElementById("notes-container");t&&(0!==e.length?(t.innerHTML="",e.forEach(((e,n)=>{const r=document.createElement("div");r.className="note-item",r.innerHTML=`\n          <div class="note-timestamp">${e.timestamp||"Unknown time"} - ${e.date||"Unknown date"}</div>\n          <div class="note-content">${e.text}</div>\n          <button class="note-delete" data-index="${n}">&times;</button>\n        `,t.appendChild(r);const i=r.querySelector(".note-delete");i&&i.addEventListener("click",(()=>{g(n)}))}))):t.innerHTML='<div class="no-notes">No saved notes for this video</div>')}function g(e){const t=f();if(t)try{if("undefined"!=typeof chrome&&chrome.storage&&chrome.storage.local)chrome.storage.local.get(["videoNotes"],(n=>{const r=n.videoNotes||{},i=r[t]||[];e>=0&&e<i.length&&(i.splice(e,1),r[t]=i,chrome.storage.local.set({videoNotes:r},(()=>{m(i)})))}));else{const n=localStorage.getItem("wordstream_notes"),r=n?JSON.parse(n):{},i=r[t]||[];e>=0&&e<i.length&&(i.splice(e,1),r[t]=i,localStorage.setItem("wordstream_notes",JSON.stringify(r)),m(i))}}catch(e){console.error("[WordStream] Error deleting note:",e)}}r.appendChild(l),r.appendChild(c);const v=()=>{"block"===l.style.display||"block"===c.style.display?n.style.display="none":n.style.display="flex"};o.addEventListener("click",(()=>{i++,console.log("[WordStream] Gemini button clicked"),i%2==1?(r.appendChild(l),l.style.display="block",c.style.display="none",r.style.display="block",v()):(l.style.display="none",r.style.display="none",v())})),a.addEventListener("click",(()=>{s++,console.log("[WordStream] Notes button clicked"),s%2==1?(r.appendChild(c),c.style.display="block",l.style.display="none",r.style.display="block",d(),u||(u=setInterval(d,1e3)),h(),v()):(c.style.display="none",r.style.display="none",v())}));const y=(e,t)=>{const o=e.querySelector(".close-button");o&&o.addEventListener("click",(()=>{console.log("[WordStream] Panel close button clicked"),e.style.display="none",r.style.display="none",t%2==1&&(e===l?i++:e===c&&s++),n.style.display="flex"}))};setTimeout((()=>{y(l,i),y(c,s)}),500),console.log("[WordStream] Direct floating controls added successfully")}catch(b){console.error("[WordStream] Error adding direct floating controls:",b)}}document.addEventListener("DOMContentLoaded",(()=>{console.log("[WordStream] DOM loaded, initializing extension"),qe(),setTimeout(Ke,1e3);const e=location.href;new MutationObserver((()=>{location.href!==e&&(console.log("[WordStream] URL changed, initializing for new page"),qe(),setTimeout(Ke,1e3))})).observe(document,{subtree:!0,childList:!0})})),window.addEventListener("load",(()=>{console.log("[WordStream] Window loaded, initializing extension"),qe(),setTimeout(Ke,2e3)}))})();